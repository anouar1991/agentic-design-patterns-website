import{r as v,j as r,h as tl,k as nl,l as sl,R as ol,b as rl,m as il,u as al,L as qe}from"./vendor-react-DN_ejfqU.js";import{S as ke,o as pt,p as Go,b as Ko,j as Uo}from"./vendor-syntax-CTqyvmNs.js";import{a2 as Jo,a3 as er,a4 as tr,q as nr,N as en,Q as fn,T as as,r as sr,a5 as ll,a6 as cl,a7 as dl,C as ul,a8 as bt,x as or,_ as Xn,K as wt,a9 as $n,aa as hn,O as fl,ab as hl,ac as Yn,Z as ml,B as pl,ad as gl,W as xl,D as De,ae as yl,af as bl,ag as wl,J as Re,X as rr,y as mn,ah as vl,ai as Nl,aj as kl,ak as Cl,al as jl,am as _l,an as Sl,ao as El,ap as Ml,aq as Il,p as ir,ar as $l,as as Tl,R as Al,s as Pl,u as Tn,at as Dl,a1 as zs}from"./vendor-icons-Bk2E3XEa.js";import{A as Ce,m as Y,R as zl,a as Ll,b as Rl}from"./vendor-motion-DGNCB2r1.js";import{e as ar,s as Rt,f as lr,i as Hl,b as cr,u as Ol,g as Bl,h as Vl,p as An,a as Fl,j as ql}from"./index-BZxwaQkP.js";import{c as Xl}from"./data-chapters-BbORdiqp.js";import{c as Yl}from"./data-misc-BXUciVTh.js";import{c as Zl}from"./data-codeterms-Bj5uvpbk.js";import"./vendor-i18n-Dd5EwQCs.js";import"./app-i18n-C5tc3coy.js";ke.registerLanguage("python",Go);ke.registerLanguage("bash",Ko);ke.registerLanguage("json",Uo);const Wl={...pt,'pre[class*="language-"]':{...pt['pre[class*="language-"]'],background:"transparent",margin:0,padding:"1.5rem",fontSize:"0.875rem"},'code[class*="language-"]':{...pt['code[class*="language-"]'],background:"transparent"}},Ls=v.memo(function({code:t,language:n="python",title:s,chapterColor:o="#0d96e6",highlightedLines:i,showLineNumbers:a=!0,explanation:l,refCallback:u,className:c=""}){const[f,d]=v.useState(!1),h=v.useCallback(async()=>{try{await navigator.clipboard.writeText(t),d(!0),setTimeout(()=>d(!1),2e3)}catch{const x=document.createElement("textarea");x.value=t,x.style.position="fixed",x.style.opacity="0",document.body.appendChild(x),x.select(),document.execCommand("copy"),document.body.removeChild(x),d(!0),setTimeout(()=>d(!1),2e3)}},[t]),p=i!=null&&i.length>=2,g=i?i[0]:0,b=i?i[1]:0,w=v.useCallback(x=>{const N=p&&x>=g&&x<=b;return{style:{display:"block",backgroundColor:N?`${o}15`:"transparent",borderLeft:N?`3px solid ${o}`:"3px solid transparent",paddingLeft:"0.5rem",marginLeft:"-0.5rem",transition:"all 0.3s ease"}}},[p,g,b,o]);return r.jsxs("div",{ref:u,className:`glass glass-code rounded-2xl overflow-hidden transition-all duration-300 ${p?"ring-2 ring-offset-2 ring-offset-[#1e293b]":""} ${c}`,style:{"--tw-ring-color":p?o:"transparent"},children:[r.jsxs("div",{className:"px-4 py-3 border-b border-dark-700/60 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s&&r.jsxs("h3",{className:"font-semibold text-dark-50 flex items-center gap-2 truncate",children:[r.jsx(Jo,{className:"w-4 h-4 flex-shrink-0",style:{color:o}}),r.jsx("span",{className:"truncate",children:s})]}),r.jsx("span",{className:"px-2.5 py-1 rounded-md text-xs font-semibold uppercase tracking-wider flex-shrink-0",style:{backgroundColor:`${o}15`,color:o,border:`1px solid ${o}25`},children:n})]}),r.jsx("button",{onClick:h,className:"relative flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-all duration-200 hover:bg-dark-700/80 flex-shrink-0",style:{color:f?"#4ade80":"#8c9bb5"},"aria-label":f?"Copied to clipboard":"Copy code",children:r.jsx(Ce,{mode:"wait",children:f?r.jsxs(Y.span,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:500,damping:25},className:"flex items-center gap-1.5",children:[r.jsx(er,{className:"w-3.5 h-3.5"}),"Copied!"]},"check"):r.jsxs(Y.span,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:500,damping:25},className:"flex items-center gap-1.5",children:[r.jsx(tr,{className:"w-3.5 h-3.5"}),"Copy"]},"copy")})})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsx(ke,{language:n,style:Wl,showLineNumbers:a,wrapLines:!0,lineNumberStyle:{minWidth:"2.5rem",paddingRight:"1rem",color:"#455268",fontSize:"0.8rem",userSelect:"none"},lineProps:w,children:t})}),l&&r.jsx("div",{className:"px-4 py-3 bg-dark-800/50 border-t border-dark-700/60",children:r.jsxs("p",{className:"text-sm text-dark-300 leading-relaxed",children:[r.jsx("span",{className:"font-medium text-dark-50",children:"Explanation: "}),l]})})]})}),ls=v.createContext(null);function Ql({children:e}){const[t,n]=v.useState(null),[s,o]=v.useState(null),[i,a]=v.useState(!1),[l,u]=v.useState(!1),[c,f]=v.useState(null),[d,h]=v.useState(null),[p,g]=v.useState(null),b=v.useCallback(E=>{E?(n(E.id),o(E),a(!0),E.data.codeHighlightLines&&f(E.data.codeHighlightLines)):(n(null),o(null),a(!1),f(null))},[]),w=v.useCallback(()=>{n(null),o(null),a(!1),f(null)},[]),x=v.useCallback(()=>a(!0),[]),N=v.useCallback(()=>a(!1),[]),m=v.useCallback(()=>u(E=>!E),[]),y=v.useCallback(E=>{f(E)},[]),S=v.useCallback(E=>{d&&d(E)},[d]),k=v.useCallback(E=>{h(()=>E)},[]),j={selectedNodeId:t,selectedNode:s,selectNode:b,clearSelection:w,isDetailPanelOpen:i,openDetailPanel:x,closeDetailPanel:N,isFullScreen:l,toggleFullScreen:m,highlightedCodeLines:c,highlightCodeLines:y,scrollToCodeExample:S,setScrollToCodeCallback:k,hoveredNodeId:p,setHoveredNodeId:g};return r.jsx(ls.Provider,{value:j,children:e})}function cs(){const e=v.useContext(ls);if(!e)throw new Error("useDiagram must be used within a DiagramProvider");return e}function Gl(){return v.useContext(ls)}const Kl=v.memo(function({objectives:t,chapterColor:n}){return!t||t.length===0?null:r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"glass rounded-xl p-6",children:[r.jsxs("h3",{className:"flex items-center gap-2 text-lg font-semibold text-dark-50 mb-4",children:[r.jsx(nr,{className:"w-5 h-5 text-primary-400"}),"Learning Objectives"]}),r.jsx("p",{className:"text-sm text-dark-400 mb-4",children:"After completing this chapter, you will be able to:"}),r.jsx("ul",{className:"space-y-3",children:t.map((s,o)=>r.jsxs(Y.li,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+o*.05},className:"flex items-start gap-3",children:[r.jsx(en,{className:"w-5 h-5 mt-0.5 flex-shrink-0",style:{color:n}}),r.jsx("span",{className:"text-dark-200",children:s.text})]},s.id))})]})}),ct=lr("QuizAttempts");function Ul(e){const{user:t}=ar(),[n,s]=v.useState([]),[o,i]=v.useState(null),[a,l]=v.useState(!1),[u,c]=v.useState(!1),[f,d]=v.useState(null),h=Hl(),p=v.useCallback(async w=>{if(!h||!t){s([]);return}l(!0),d(null);try{const{data:x,error:N}=await Rt.from("quiz_attempts").select("*").eq("user_id",t.id).eq("chapter_id",w).order("created_at",{ascending:!1});if(N)throw N;s(x||[])}catch(x){const N=JSON.stringify(x);N.includes("Failed to fetch")||N.includes("NetworkError")||ct.error("Error fetching quiz attempts:",x),d(x instanceof Error?x.message:"Failed to fetch quiz attempts")}finally{l(!1)}},[h,t]),g=v.useCallback(async w=>{if(!h||!t){i(null);return}try{const{data:x,error:N}=await Rt.from("user_best_quiz_scores").select("*").eq("user_id",t.id).eq("chapter_id",w).single();if(N&&N.code!=="PGRST116")throw N;x&&x.user_id?i({user_id:x.user_id,chapter_id:x.chapter_id,score:x.score,total_questions:x.total_questions,passed:x.passed,attempt_number:x.attempt_number,created_at:x.created_at}):i(null)}catch(x){const N=JSON.stringify(x);N.includes("Failed to fetch")||N.includes("NetworkError")||ct.error("Error fetching best quiz score:",x)}},[h,t]),b=v.useCallback(async w=>{if(!h||!t)return ct.debug("Quiz attempt not saved: user not logged in or Supabase not configured"),null;c(!0),d(null);try{const{data:x,error:N}=await Rt.rpc("get_next_attempt_number",{p_user_id:t.id,p_chapter_id:w.chapterId});N&&ct.warn("Could not get attempt number, using 1:",N);const m=x||1,{data:y,error:S}=await Rt.from("quiz_attempts").insert({user_id:t.id,chapter_id:w.chapterId,score:w.score,total_questions:w.totalQuestions,passed:w.passed,duration_seconds:w.durationSeconds,attempt_number:m}).select().single();if(S)throw S;return s(k=>[y,...k]),await g(w.chapterId),y}catch(x){const N=JSON.stringify(x);return N.includes("Failed to fetch")||N.includes("NetworkError")||ct.error("Error saving quiz attempt:",x),d(x instanceof Error?x.message:"Failed to save quiz attempt"),null}finally{c(!1)}},[h,t,g]);return v.useEffect(()=>{e&&t&&(p(e),g(e))},[e,t,p,g]),{attempts:n,bestScore:o,attemptCount:n.length,loading:a,saving:u,error:f,saveAttempt:b,fetchAttempts:p,fetchBestScore:g,isConfigured:h}}function dr(e,t){const n=Math.round(e/t*100);return`${e}/${t} (${n}%)`}function Jl(e){const t=new Date(e),s=new Date().getTime()-t.getTime(),o=Math.floor(s/6e4),i=Math.floor(s/36e5),a=Math.floor(s/864e5);return o<1?"Just now":o<60?`${o}m ago`:i<24?`${i}h ago`:a<7?`${a}d ago`:t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}function ec(e){if(!e)return null;if(e<60)return`${e}s`;const t=Math.floor(e/60),n=e%60;return n>0?`${t}m ${n}s`:`${t}m`}function tc(e,t){if(!t)return null;const n=e.score/e.total_questions*100,s=t.score/t.total_questions*100,o=n-s;return o>0?{direction:"up",amount:Math.round(o)}:o<0?{direction:"down",amount:Math.round(Math.abs(o))}:{direction:"same",amount:0}}const Rs=3,Hs=v.memo(function({attempts:t,bestScore:n,loading:s,chapterColor:o}){const[i,a]=v.useState(!1);if(s)return r.jsx("div",{className:"mt-4 glass rounded-xl p-4",children:r.jsxs("div",{className:"flex items-center gap-2 text-dark-400 text-sm",children:[r.jsx("div",{className:"w-4 h-4 border-2 border-dark-500 border-t-transparent rounded-full animate-spin"}),"Loading history..."]})});if(t.length===0)return null;const l=i?t:t.slice(0,Rs),u=t.length>Rs;return r.jsxs(Y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"mt-6",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsxs("h4",{className:"text-sm font-semibold text-dark-200 dark:text-dark-200 flex items-center gap-2",children:[r.jsx(fn,{className:"w-4 h-4 text-dark-400"}),"Quiz History",r.jsxs("span",{className:"text-dark-500 font-normal",children:["(",t.length," attempt",t.length!==1?"s":"",")"]})]})}),r.jsx("div",{className:"space-y-2",children:r.jsx(Ce,{initial:!1,children:l.map(c=>{const f=n&&c.id===nc(t,n),d=Math.round(c.score/c.total_questions*100),h=t[t.indexOf(c)+1],p=tc(c,h),g=ec(c.duration_seconds);return r.jsx(Y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:`rounded-xl border p-3 transition-colors ${f?"border-amber-500/40 bg-amber-500/5 dark:border-amber-500/40 dark:bg-amber-500/5":"border-dark-700 bg-dark-800/30 dark:border-dark-700 dark:bg-dark-800/30"}`,children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("span",{className:"flex items-center justify-center w-7 h-7 rounded-lg text-xs font-bold shrink-0",style:{backgroundColor:f?"rgba(245, 158, 11, 0.2)":`${o}20`,color:f?"#f59e0b":o},children:["#",c.attempt_number]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:`text-sm font-semibold ${c.passed?"text-emerald-400":"text-dark-300"}`,children:dr(c.score,c.total_questions)}),f&&r.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider bg-amber-500/20 text-amber-400",children:[r.jsx(as,{className:"w-3 h-3"}),"Best"]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-dark-500",children:[r.jsx("span",{children:Jl(c.created_at)}),g&&r.jsxs(r.Fragment,{children:[r.jsx("span",{children:"·"}),r.jsx("span",{children:g})]})]})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[p&&r.jsxs("span",{className:`flex items-center gap-0.5 text-xs ${p.direction==="up"?"text-emerald-400":p.direction==="down"?"text-red-400":"text-dark-500"}`,children:[p.direction==="up"&&r.jsx(sr,{className:"w-3 h-3"}),p.direction==="down"&&r.jsx(ll,{className:"w-3 h-3"}),p.direction==="same"&&r.jsx(cl,{className:"w-3 h-3"}),p.amount>0&&`${p.amount}%`]}),r.jsx("div",{className:"w-16 h-1.5 rounded-full bg-dark-700 overflow-hidden",children:r.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${d}%`,backgroundColor:c.passed?"#10b981":o}})})]})]})},c.id)})})}),u&&r.jsx("button",{onClick:()=>a(c=>!c),className:"mt-2 w-full flex items-center justify-center gap-1 py-2 text-xs text-dark-400 hover:text-dark-300 transition-colors",children:i?r.jsxs(r.Fragment,{children:["Show less ",r.jsx(dl,{className:"w-3 h-3"})]}):r.jsxs(r.Fragment,{children:["Show all ",t.length," attempts ",r.jsx(ul,{className:"w-3 h-3"})]})})]})});function nc(e,t){return e.find(s=>s.attempt_number===t.attempt_number&&s.chapter_id===t.chapter_id)?.id??null}const Ht=e=>`quiz-session-${e}`;function gt(e){return e.type||"multiple-choice"}function sc(e,t){return e.length!==t.length?!1:e.every((n,s)=>n===t[s])}const Os=v.memo(function({color:t}){const n=v.useMemo(()=>Array.from({length:24},(s,o)=>({id:o,x:(Math.random()-.5)*300,y:-(Math.random()*200+50),rotate:Math.random()*720-360,scale:Math.random()*.5+.5,delay:Math.random()*.3,hue:Math.random()*60-30})),[]);return r.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:n.map(s=>r.jsx(Y.div,{className:"absolute left-1/2 top-1/2 w-2 h-2 rounded-sm",style:{backgroundColor:t,opacity:.9},initial:{x:0,y:0,scale:0,rotate:0},animate:{x:s.x,y:s.y,scale:[0,s.scale,0],rotate:s.rotate,opacity:[0,1,0]},transition:{duration:1.2,delay:s.delay,ease:"easeOut"}},s.id))})}),oc=v.memo(function({shake:t,children:n}){return r.jsx(Y.div,{animate:t?{x:[0,-8,8,-6,6,-3,3,0]}:{},transition:{duration:.5},children:n})}),rc=v.memo(function({question:t,orderedItems:n,onReorder:s,chapterColor:o}){const i=v.useMemo(()=>new Map(t.options.map(l=>[l.id,l.text])),[t.options]),a=v.useCallback((l,u)=>{if(l.key==="ArrowUp"&&u>0){l.preventDefault();const c=[...n];[c[u-1],c[u]]=[c[u],c[u-1]],s(c),setTimeout(()=>{l.currentTarget.parentElement?.querySelectorAll("[data-reorder-item]")?.[u-1]?.focus()},50)}else if(l.key==="ArrowDown"&&u<n.length-1){l.preventDefault();const c=[...n];[c[u],c[u+1]]=[c[u+1],c[u]],s(c),setTimeout(()=>{l.currentTarget.parentElement?.querySelectorAll("[data-reorder-item]")?.[u+1]?.focus()},50)}},[n,s]);return r.jsxs("div",{children:[r.jsxs("p",{className:"text-sm text-dark-400 mb-3 flex items-center gap-2",children:[r.jsx(Yn,{className:"w-4 h-4"}),"Drag to reorder or use arrow keys"]}),r.jsx(zl,{axis:"y",values:n,onReorder:s,className:"space-y-2",role:"listbox","aria-label":"Reorder items",children:n.map((l,u)=>r.jsxs(Ll,{value:l,"data-reorder-item":!0,tabIndex:0,role:"option","aria-label":`Position ${u+1}: ${i.get(l)}. Use arrow keys to reorder.`,onKeyDown:c=>a(c,u),className:"flex items-center gap-3 p-4 rounded-xl border-2 border-dark-600 bg-dark-800/50 cursor-grab active:cursor-grabbing select-none",whileDrag:{scale:1.02,boxShadow:`0 0 20px ${o}40`,borderColor:o},children:[r.jsx("span",{className:"flex items-center justify-center w-7 h-7 rounded-lg text-xs font-bold text-dark-50 shrink-0",style:{backgroundColor:`${o}60`},children:u+1}),r.jsx(Yn,{className:"w-4 h-4 text-dark-500 shrink-0"}),r.jsx("span",{className:"text-dark-200",children:i.get(l)})]},l))})]})}),ic=v.memo(function({question:t,selectedOption:n,onSelect:s}){const i=gt(t)==="true-false";return r.jsx("div",{className:`space-y-3 ${i?"flex gap-4 space-y-0":""}`,children:t.options.map(a=>r.jsx("button",{onClick:()=>s(a.id),className:`${i?"flex-1":"w-full"} text-left p-4 rounded-xl border-2 transition-all ${n===a.id?"border-primary-500 bg-primary-500/10 scale-[1.01]":"border-dark-600 hover:border-dark-500 bg-dark-800/50"}`,children:r.jsxs("span",{className:"text-dark-200",children:[i&&r.jsx("span",{className:"mr-2 text-lg",children:a.text.toLowerCase()==="true"?"✓":"✗"}),a.text]})},a.id))})}),ac=v.memo(function({code:t}){return r.jsx("pre",{className:"mb-4 p-4 rounded-xl bg-dark-900 border border-dark-700 overflow-x-auto text-sm",children:r.jsx("code",{className:"text-dark-200 font-mono",children:t})})}),Bs=v.memo(function({type:t}){const s={"multiple-choice":{text:"Multiple Choice",icon:r.jsx(bt,{className:"w-3 h-3"})},"true-false":{text:"True / False",icon:r.jsx(ml,{className:"w-3 h-3"})},ordering:{text:"Put in Order",icon:r.jsx(Yn,{className:"w-3 h-3"})}}[t];return r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs text-dark-300 bg-dark-800 border border-dark-700 mb-4",children:[s.icon,s.text]})});function lc({quiz:e,chapterColor:t,chapterId:n,onPass:s}){const o=v.useMemo(()=>{try{const B=sessionStorage.getItem(Ht(n));if(B)return JSON.parse(B)}catch{}return null},[n]),[i,a]=v.useState(o?"question":"intro"),[l,u]=v.useState(o?.currentQuestionIndex??0),[c,f]=v.useState(null),[d,h]=v.useState(o?.answers??[]),[p,g]=v.useState(!1),[b,w]=v.useState(!1),[x,N]=v.useState(!1),[m,y]=v.useState(!1),[S,k]=v.useState([]),j=v.useRef(o?.startTime??0),{user:E}=ar(),{attempts:A,bestScore:H,attemptCount:T,loading:D,saveAttempt:L,saving:C}=Ul(n),{saveQuizScore:M}=cr(),_=e.questions[l],I=e.questions.length,$=_?gt(_):"multiple-choice";v.useEffect(()=>{if(_&&gt(_)==="ordering"){const B=_.options.map(X=>X.id);k(cc(B))}},[_]),v.useEffect(()=>{if(i==="question"||i==="feedback"){const B={currentQuestionIndex:l,answers:d,startTime:j.current};sessionStorage.setItem(Ht(n),JSON.stringify(B))}else(i==="results"||i==="intro")&&sessionStorage.removeItem(Ht(n))},[i,l,d,n]);const P=v.useCallback(()=>{a("intro"),u(0),f(null),h([]),g(!1),w(!1),N(!1),y(!1),j.current=0,sessionStorage.removeItem(Ht(n))},[n]),z=v.useCallback(()=>{j.current=Date.now(),a("question")},[]),O=v.useCallback(()=>{if(!_)return;const B=gt(_);let X=!1,J="";if(B==="ordering")X=sc(S,_.correctOrder??[]),J=S.join(",");else{if(!c)return;X=c===_.correctOptionId,J=c}const G={questionId:_.id,selectedOptionId:J,isCorrect:X};h(K=>[...K,G]),g(!0),a("feedback"),X?(N(!0),setTimeout(()=>N(!1),1500)):(y(!0),setTimeout(()=>y(!1),600))},[c,_,S]),R=v.useCallback(()=>{l<I-1?(u(B=>B+1),f(null),g(!1),a("question")):a("results")},[l,I]),F=d.filter(B=>B.isCorrect).length,q=Math.round(F/I*100),Z=q>=e.passingScore,U=v.useCallback(()=>{if(j.current)return Math.round((Date.now()-j.current)/1e3)},[]);v.useEffect(()=>{i==="results"&&!b&&(w(!0),M(n,F,I,Z),E&&L({chapterId:n,score:F,totalQuestions:I,passed:Z,durationSeconds:U()}),Z&&s&&s())},[i,b,E,L,M,n,F,I,Z,U,s]);const Q=H?F>H.score:E&&F>0,V=$==="ordering"?S.length>0:!!c;return r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"glass rounded-2xl overflow-hidden relative",children:[x&&r.jsx(Os,{color:t}),r.jsxs("div",{className:"p-4 border-b border-dark-700 flex items-center justify-between",children:[r.jsxs("h3",{className:"font-semibold text-dark-50 flex items-center gap-2",children:[r.jsx(bt,{className:"w-5 h-5 text-primary-400"}),e.title]}),i!=="intro"&&i!=="results"&&r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("span",{className:"text-sm font-medium",style:{color:t},children:[d.filter(B=>B.isCorrect).length,"/",d.length]}),r.jsxs("span",{className:"text-sm text-dark-400",children:["Q",l+1,"/",I]})]})]}),r.jsx("div",{className:"p-6",children:r.jsxs(Ce,{mode:"wait",children:[i==="intro"&&r.jsxs(Y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center py-8",children:[r.jsx("div",{className:"w-16 h-16 rounded-2xl mx-auto mb-6 flex items-center justify-center",style:{backgroundColor:`${t}20`},children:r.jsx(bt,{className:"w-8 h-8",style:{color:t}})}),r.jsx("h4",{className:"text-xl font-semibold text-dark-50 mb-2",children:"Ready to Test Your Knowledge?"}),r.jsx("p",{className:"text-dark-400 mb-6 max-w-md mx-auto",children:e.description}),r.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[r.jsxs("div",{className:"glass rounded-lg px-4 py-2",children:[r.jsx("span",{className:"text-2xl font-bold text-dark-50",children:I}),r.jsx("span",{className:"text-dark-400 text-sm ml-1",children:"questions"})]}),r.jsxs("div",{className:"glass rounded-lg px-4 py-2",children:[r.jsxs("span",{className:"text-2xl font-bold text-dark-50",children:[e.passingScore,"%"]}),r.jsx("span",{className:"text-dark-400 text-sm ml-1",children:"to pass"})]})]}),e.questions.some(B=>B.type&&B.type!=="multiple-choice")&&r.jsx("div",{className:"flex justify-center gap-2 mb-6 flex-wrap",children:dc(e.questions).map(B=>r.jsx(Bs,{type:B},B))}),E&&H&&r.jsxs("div",{className:"glass rounded-xl p-4 mb-6 max-w-sm mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 text-dark-400",children:[r.jsx(as,{className:"w-4 h-4 text-amber-400"}),r.jsx("span",{children:"Best Score"})]}),r.jsx("span",{className:"text-dark-50 font-medium",children:dr(H.score,H.total_questions)})]}),T>0&&r.jsxs("div",{className:"flex items-center justify-between text-sm mt-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-dark-400",children:[r.jsx(fn,{className:"w-4 h-4"}),r.jsx("span",{children:"Attempts"})]}),r.jsx("span",{className:"text-dark-50 font-medium",children:T})]})]}),r.jsxs("button",{onClick:z,className:"inline-flex items-center gap-2 px-6 py-3 rounded-xl text-dark-50 font-medium transition-all hover:opacity-90 hover:scale-105 active:scale-95",style:{backgroundColor:t},children:[T>0?"Retake Quiz":"Start Quiz",r.jsx(or,{className:"w-5 h-5"})]}),E&&A.length>0&&r.jsx("div",{className:"max-w-sm mx-auto w-full",children:r.jsx(Hs,{attempts:A,bestScore:H,loading:D,chapterColor:t})})]},"intro"),i==="question"&&_&&r.jsxs(Y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"flex gap-1 h-2",children:e.questions.map((B,X)=>r.jsx("div",{className:"flex-1 rounded-full overflow-hidden bg-dark-700",children:r.jsx(Y.div,{className:"h-full rounded-full origin-left",style:{backgroundColor:X<d.length?d[X]?.isCorrect?"#10b981":"#ef4444":X===l?t:"transparent"},initial:X===l?{scaleX:0}:void 0,animate:{scaleX:X<=l?1:0},transition:{duration:.3}})},X))})}),r.jsx(Bs,{type:$}),r.jsx("h4",{className:"text-lg font-semibold text-dark-50 mb-4",children:_.question}),_.codeSnippet&&r.jsx(ac,{code:_.codeSnippet}),r.jsx("div",{className:"mb-6",children:$==="ordering"?r.jsx(rc,{question:_,orderedItems:S,onReorder:k,chapterColor:t}):r.jsx(ic,{question:_,selectedOption:c,onSelect:f})}),r.jsx("button",{onClick:O,disabled:!V,className:"w-full py-3 rounded-xl font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed hover:opacity-90 active:scale-[0.98]",style:{backgroundColor:V?t:void 0,color:V?"white":void 0},children:"Submit Answer"})]},`question-${l}`),i==="feedback"&&_&&r.jsxs(Y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0},children:[r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"flex gap-1 h-2",children:e.questions.map((B,X)=>r.jsx("div",{className:"flex-1 rounded-full overflow-hidden bg-dark-700",children:r.jsx(Y.div,{className:"h-full rounded-full origin-left",style:{backgroundColor:X<d.length?d[X]?.isCorrect?"#10b981":"#ef4444":"transparent"},animate:{scaleX:X<d.length?1:0}})},X))})}),r.jsx(oc,{shake:m,children:r.jsxs("div",{className:`p-4 rounded-xl mb-6 ${d[d.length-1]?.isCorrect?"bg-emerald-500/10 border border-emerald-500/30":"bg-red-500/10 border border-red-500/30"}`,children:[r.jsx("div",{className:"flex items-center gap-3 mb-2",children:d[d.length-1]?.isCorrect?r.jsxs(r.Fragment,{children:[r.jsx(Y.div,{initial:{scale:0,rotate:-45},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:300,damping:15},children:r.jsx(Xn,{className:"w-6 h-6 text-emerald-500"})}),r.jsxs("span",{className:"font-semibold text-emerald-400 flex items-center gap-2",children:["Correct!",r.jsx(wt,{className:"w-4 h-4"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx(Y.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:300},children:r.jsx($n,{className:"w-6 h-6 text-red-500"})}),r.jsx("span",{className:"font-semibold text-red-400",children:"Not quite"})]})}),!d[d.length-1]?.isCorrect&&$!=="ordering"&&r.jsxs("p",{className:"text-sm text-dark-300 mt-1",children:["Correct answer:"," ",r.jsx("span",{className:"text-emerald-400 font-medium",children:_.options.find(B=>B.id===_.correctOptionId)?.text})]}),!d[d.length-1]?.isCorrect&&$==="ordering"&&_.correctOrder&&r.jsxs("div",{className:"mt-2 text-sm text-dark-300",children:[r.jsx("p",{className:"mb-1",children:"Correct order:"}),r.jsx("ol",{className:"list-decimal list-inside space-y-0.5",children:_.correctOrder.map(B=>r.jsx("li",{className:"text-emerald-400",children:_.options.find(X=>X.id===B)?.text},B))})]})]})}),p&&r.jsx(Y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"glass rounded-xl p-4 mb-6",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(hn,{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5"}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-dark-50",children:"Explanation:"}),r.jsx("p",{className:"text-dark-300 mt-1",children:_.explanation})]})]})}),r.jsx("button",{onClick:R,className:"w-full py-3 rounded-xl font-medium text-dark-50 transition-all hover:opacity-90 active:scale-[0.98]",style:{backgroundColor:t},children:l<I-1?"Next Question":"See Results"})]},"feedback"),i==="results"&&r.jsxs(Y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0},className:"text-center py-8 relative",children:[Z&&r.jsx(Os,{color:t}),r.jsx(Y.div,{className:`w-20 h-20 rounded-full mx-auto mb-6 flex items-center justify-center ${Z?"bg-emerald-500/20":"bg-red-500/20"}`,initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:12,delay:.1},children:Z?r.jsx(fl,{className:"w-10 h-10 text-emerald-500"}):r.jsx($n,{className:"w-10 h-10 text-red-500"})}),r.jsx("h4",{className:"text-2xl font-bold text-dark-50 mb-2",children:Z?"Congratulations!":"Keep Learning!"}),r.jsx("p",{className:"text-dark-400 mb-4",children:Z?"You've passed this quiz and mastered the key concepts.":`You need ${e.passingScore}% to pass. Review the material and try again.`}),Q&&E&&r.jsxs(Y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-amber-500/20 border border-amber-500/30 mb-4",children:[r.jsx(sr,{className:"w-4 h-4 text-amber-400"}),r.jsx("span",{className:"text-amber-400 font-medium text-sm",children:"New Best Score!"})]}),r.jsxs("div",{className:"glass rounded-xl p-6 mb-6 max-w-sm mx-auto",children:[r.jsxs(Y.div,{className:"text-4xl font-bold text-dark-50 mb-1",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[q,"%"]}),r.jsxs("div",{className:"text-dark-400",children:[F," of ",I," correct"]}),r.jsx("div",{className:"mt-4 flex gap-1 h-3",children:d.map((B,X)=>r.jsx(Y.div,{className:`flex-1 rounded-full ${B.isCorrect?"bg-emerald-500":"bg-red-500"}`,initial:{scaleX:0},animate:{scaleX:1},transition:{delay:.4+X*.1,duration:.3}},X))}),r.jsx("div",{className:"mt-3 flex justify-center gap-2 flex-wrap",children:d.map((B,X)=>r.jsx(Y.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.5+X*.08},title:`Q${X+1}: ${B.isCorrect?"Correct":"Wrong"}`,children:B.isCorrect?r.jsx(Xn,{className:"w-5 h-5 text-emerald-500"}):r.jsx($n,{className:"w-5 h-5 text-red-500"})},X))}),C&&r.jsxs("div",{className:"mt-3 text-xs text-dark-400 flex items-center justify-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 border-2 border-primary-400 border-t-transparent rounded-full animate-spin"}),"Saving result..."]}),E&&T>0&&!C&&r.jsxs("div",{className:"mt-3 text-xs text-dark-400",children:["Attempt #",T+1," saved"]})]}),r.jsxs("button",{onClick:P,className:"inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-dark-700 text-dark-50 font-medium hover:bg-dark-600 transition-all hover:scale-105 active:scale-95",children:[r.jsx(hl,{className:"w-5 h-5"}),Z?"Retake Quiz":"Try Again"]}),E&&A.length>0&&r.jsx(Hs,{attempts:A,bestScore:H,loading:D,chapterColor:t})]},"results")]})})]})}function cc(e){const t=[...e];for(let n=t.length-1;n>0;n--){const s=Math.floor(Math.random()*(n+1));[t[n],t[s]]=[t[s],t[n]]}return t}function dc(e){const t=new Set(e.map(n=>gt(n)));return Array.from(t)}function ie(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,s;n<e.length;n++)(s=ie(e[n]))!==""&&(t+=(t&&" ")+s);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var uc={value:()=>{}};function pn(){for(var e=0,t=arguments.length,n={},s;e<t;++e){if(!(s=arguments[e]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new Qt(n)}function Qt(e){this._=e}function fc(e,t){return e.trim().split(/^|\s+/).map(function(n){var s="",o=n.indexOf(".");if(o>=0&&(s=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}Qt.prototype=pn.prototype={constructor:Qt,on:function(e,t){var n=this._,s=fc(e+"",n),o,i=-1,a=s.length;if(arguments.length<2){for(;++i<a;)if((o=(e=s[i]).type)&&(o=hc(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(o=(e=s[i]).type)n[o]=Vs(n[o],e.name,t);else if(t==null)for(o in n)n[o]=Vs(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Qt(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),s=0,o,i;s<o;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],s=0,o=i.length;s<o;++s)i[s].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],o=0,i=s.length;o<i;++o)s[o].value.apply(t,n)}};function hc(e,t){for(var n=0,s=e.length,o;n<s;++n)if((o=e[n]).name===t)return o.value}function Vs(e,t,n){for(var s=0,o=e.length;s<o;++s)if(e[s].name===t){e[s]=uc,e=e.slice(0,s).concat(e.slice(s+1));break}return n!=null&&e.push({name:t,value:n}),e}var Zn="http://www.w3.org/1999/xhtml";const Fs={svg:"http://www.w3.org/2000/svg",xhtml:Zn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function gn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Fs.hasOwnProperty(t)?{space:Fs[t],local:e}:e}function mc(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Zn&&t.documentElement.namespaceURI===Zn?t.createElement(e):t.createElementNS(n,e)}}function pc(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ur(e){var t=gn(e);return(t.local?pc:mc)(t)}function gc(){}function ds(e){return e==null?gc:function(){return this.querySelector(e)}}function xc(e){typeof e!="function"&&(e=ds(e));for(var t=this._groups,n=t.length,s=new Array(n),o=0;o<n;++o)for(var i=t[o],a=i.length,l=s[o]=new Array(a),u,c,f=0;f<a;++f)(u=i[f])&&(c=e.call(u,u.__data__,f,i))&&("__data__"in u&&(c.__data__=u.__data__),l[f]=c);return new de(s,this._parents)}function yc(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function bc(){return[]}function fr(e){return e==null?bc:function(){return this.querySelectorAll(e)}}function wc(e){return function(){return yc(e.apply(this,arguments))}}function vc(e){typeof e=="function"?e=wc(e):e=fr(e);for(var t=this._groups,n=t.length,s=[],o=[],i=0;i<n;++i)for(var a=t[i],l=a.length,u,c=0;c<l;++c)(u=a[c])&&(s.push(e.call(u,u.__data__,c,a)),o.push(u));return new de(s,o)}function hr(e){return function(){return this.matches(e)}}function mr(e){return function(t){return t.matches(e)}}var Nc=Array.prototype.find;function kc(e){return function(){return Nc.call(this.children,e)}}function Cc(){return this.firstElementChild}function jc(e){return this.select(e==null?Cc:kc(typeof e=="function"?e:mr(e)))}var _c=Array.prototype.filter;function Sc(){return Array.from(this.children)}function Ec(e){return function(){return _c.call(this.children,e)}}function Mc(e){return this.selectAll(e==null?Sc:Ec(typeof e=="function"?e:mr(e)))}function Ic(e){typeof e!="function"&&(e=hr(e));for(var t=this._groups,n=t.length,s=new Array(n),o=0;o<n;++o)for(var i=t[o],a=i.length,l=s[o]=[],u,c=0;c<a;++c)(u=i[c])&&e.call(u,u.__data__,c,i)&&l.push(u);return new de(s,this._parents)}function pr(e){return new Array(e.length)}function $c(){return new de(this._enter||this._groups.map(pr),this._parents)}function tn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}tn.prototype={constructor:tn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Tc(e){return function(){return e}}function Ac(e,t,n,s,o,i){for(var a=0,l,u=t.length,c=i.length;a<c;++a)(l=t[a])?(l.__data__=i[a],s[a]=l):n[a]=new tn(e,i[a]);for(;a<u;++a)(l=t[a])&&(o[a]=l)}function Pc(e,t,n,s,o,i,a){var l,u,c=new Map,f=t.length,d=i.length,h=new Array(f),p;for(l=0;l<f;++l)(u=t[l])&&(h[l]=p=a.call(u,u.__data__,l,t)+"",c.has(p)?o[l]=u:c.set(p,u));for(l=0;l<d;++l)p=a.call(e,i[l],l,i)+"",(u=c.get(p))?(s[l]=u,u.__data__=i[l],c.delete(p)):n[l]=new tn(e,i[l]);for(l=0;l<f;++l)(u=t[l])&&c.get(h[l])===u&&(o[l]=u)}function Dc(e){return e.__data__}function zc(e,t){if(!arguments.length)return Array.from(this,Dc);var n=t?Pc:Ac,s=this._parents,o=this._groups;typeof e!="function"&&(e=Tc(e));for(var i=o.length,a=new Array(i),l=new Array(i),u=new Array(i),c=0;c<i;++c){var f=s[c],d=o[c],h=d.length,p=Lc(e.call(f,f&&f.__data__,c,s)),g=p.length,b=l[c]=new Array(g),w=a[c]=new Array(g),x=u[c]=new Array(h);n(f,d,b,w,x,p,t);for(var N=0,m=0,y,S;N<g;++N)if(y=b[N]){for(N>=m&&(m=N+1);!(S=w[m])&&++m<g;);y._next=S||null}}return a=new de(a,s),a._enter=l,a._exit=u,a}function Lc(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Rc(){return new de(this._exit||this._groups.map(pr),this._parents)}function Hc(e,t,n){var s=this.enter(),o=this,i=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),s&&o?s.merge(o).order():o}function Oc(e){for(var t=e.selection?e.selection():e,n=this._groups,s=t._groups,o=n.length,i=s.length,a=Math.min(o,i),l=new Array(o),u=0;u<a;++u)for(var c=n[u],f=s[u],d=c.length,h=l[u]=new Array(d),p,g=0;g<d;++g)(p=c[g]||f[g])&&(h[g]=p);for(;u<o;++u)l[u]=n[u];return new de(l,this._parents)}function Bc(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var s=e[t],o=s.length-1,i=s[o],a;--o>=0;)(a=s[o])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function Vc(e){e||(e=Fc);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var n=this._groups,s=n.length,o=new Array(s),i=0;i<s;++i){for(var a=n[i],l=a.length,u=o[i]=new Array(l),c,f=0;f<l;++f)(c=a[f])&&(u[f]=c);u.sort(t)}return new de(o,this._parents).order()}function Fc(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function qc(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Xc(){return Array.from(this)}function Yc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],o=0,i=s.length;o<i;++o){var a=s[o];if(a)return a}return null}function Zc(){let e=0;for(const t of this)++e;return e}function Wc(){return!this.node()}function Qc(e){for(var t=this._groups,n=0,s=t.length;n<s;++n)for(var o=t[n],i=0,a=o.length,l;i<a;++i)(l=o[i])&&e.call(l,l.__data__,i,o);return this}function Gc(e){return function(){this.removeAttribute(e)}}function Kc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Uc(e,t){return function(){this.setAttribute(e,t)}}function Jc(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ed(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function td(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function nd(e,t){var n=gn(e);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((t==null?n.local?Kc:Gc:typeof t=="function"?n.local?td:ed:n.local?Jc:Uc)(n,t))}function gr(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function sd(e){return function(){this.style.removeProperty(e)}}function od(e,t,n){return function(){this.style.setProperty(e,t,n)}}function rd(e,t,n){return function(){var s=t.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,n)}}function id(e,t,n){return arguments.length>1?this.each((t==null?sd:typeof t=="function"?rd:od)(e,t,n??"")):Ke(this.node(),e)}function Ke(e,t){return e.style.getPropertyValue(t)||gr(e).getComputedStyle(e,null).getPropertyValue(t)}function ad(e){return function(){delete this[e]}}function ld(e,t){return function(){this[e]=t}}function cd(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function dd(e,t){return arguments.length>1?this.each((t==null?ad:typeof t=="function"?cd:ld)(e,t)):this.node()[e]}function xr(e){return e.trim().split(/^|\s+/)}function us(e){return e.classList||new yr(e)}function yr(e){this._node=e,this._names=xr(e.getAttribute("class")||"")}yr.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function br(e,t){for(var n=us(e),s=-1,o=t.length;++s<o;)n.add(t[s])}function wr(e,t){for(var n=us(e),s=-1,o=t.length;++s<o;)n.remove(t[s])}function ud(e){return function(){br(this,e)}}function fd(e){return function(){wr(this,e)}}function hd(e,t){return function(){(t.apply(this,arguments)?br:wr)(this,e)}}function md(e,t){var n=xr(e+"");if(arguments.length<2){for(var s=us(this.node()),o=-1,i=n.length;++o<i;)if(!s.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?hd:t?ud:fd)(n,t))}function pd(){this.textContent=""}function gd(e){return function(){this.textContent=e}}function xd(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function yd(e){return arguments.length?this.each(e==null?pd:(typeof e=="function"?xd:gd)(e)):this.node().textContent}function bd(){this.innerHTML=""}function wd(e){return function(){this.innerHTML=e}}function vd(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Nd(e){return arguments.length?this.each(e==null?bd:(typeof e=="function"?vd:wd)(e)):this.node().innerHTML}function kd(){this.nextSibling&&this.parentNode.appendChild(this)}function Cd(){return this.each(kd)}function jd(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _d(){return this.each(jd)}function Sd(e){var t=typeof e=="function"?e:ur(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Ed(){return null}function Md(e,t){var n=typeof e=="function"?e:ur(e),s=t==null?Ed:typeof t=="function"?t:ds(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function Id(){var e=this.parentNode;e&&e.removeChild(this)}function $d(){return this.each(Id)}function Td(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ad(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Pd(e){return this.select(e?Ad:Td)}function Dd(e){return arguments.length?this.property("__data__",e):this.node().__data__}function zd(e){return function(t){e.call(this,t,this.__data__)}}function Ld(e){return e.trim().split(/^|\s+/).map(function(t){var n="",s=t.indexOf(".");return s>=0&&(n=t.slice(s+1),t=t.slice(0,s)),{type:t,name:n}})}function Rd(e){return function(){var t=this.__on;if(t){for(var n=0,s=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++s]=i;++s?t.length=s:delete this.__on}}}function Hd(e,t,n){return function(){var s=this.__on,o,i=zd(t);if(s){for(var a=0,l=s.length;a<l;++a)if((o=s[a]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},s?s.push(o):this.__on=[o]}}function Od(e,t,n){var s=Ld(e+""),o,i=s.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var u=0,c=l.length,f;u<c;++u)for(o=0,f=l[u];o<i;++o)if((a=s[o]).type===f.type&&a.name===f.name)return f.value}return}for(l=t?Hd:Rd,o=0;o<i;++o)this.each(l(s[o],t,n));return this}function vr(e,t,n){var s=gr(e),o=s.CustomEvent;typeof o=="function"?o=new o(t,n):(o=s.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Bd(e,t){return function(){return vr(this,e,t)}}function Vd(e,t){return function(){return vr(this,e,t.apply(this,arguments))}}function Fd(e,t){return this.each((typeof t=="function"?Vd:Bd)(e,t))}function*qd(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],o=0,i=s.length,a;o<i;++o)(a=s[o])&&(yield a)}var Nr=[null];function de(e,t){this._groups=e,this._parents=t}function $t(){return new de([[document.documentElement]],Nr)}function Xd(){return this}de.prototype=$t.prototype={constructor:de,select:xc,selectAll:vc,selectChild:jc,selectChildren:Mc,filter:Ic,data:zc,enter:$c,exit:Rc,join:Hc,merge:Oc,selection:Xd,order:Bc,sort:Vc,call:qc,nodes:Xc,node:Yc,size:Zc,empty:Wc,each:Qc,attr:nd,style:id,property:dd,classed:md,text:yd,html:Nd,raise:Cd,lower:_d,append:Sd,insert:Md,remove:$d,clone:Pd,datum:Dd,on:Od,dispatch:Fd,[Symbol.iterator]:qd};function ce(e){return typeof e=="string"?new de([[document.querySelector(e)]],[document.documentElement]):new de([[e]],Nr)}function Yd(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ue(e,t){if(e=Yd(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s=s.matrixTransform(t.getScreenCTM().inverse()),[s.x,s.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Zd={passive:!1},vt={capture:!0,passive:!1};function Pn(e){e.stopImmediatePropagation()}function Qe(e){e.preventDefault(),e.stopImmediatePropagation()}function kr(e){var t=e.document.documentElement,n=ce(e).on("dragstart.drag",Qe,vt);"onselectstart"in t?n.on("selectstart.drag",Qe,vt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Cr(e,t){var n=e.document.documentElement,s=ce(e).on("dragstart.drag",null);t&&(s.on("click.drag",Qe,vt),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ot=e=>()=>e;function Wn(e,{sourceEvent:t,subject:n,target:s,identifier:o,active:i,x:a,y:l,dx:u,dy:c,dispatch:f}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:f}})}Wn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Wd(e){return!e.ctrlKey&&!e.button}function Qd(){return this.parentNode}function Gd(e,t){return t??{x:e.x,y:e.y}}function Kd(){return navigator.maxTouchPoints||"ontouchstart"in this}function jr(){var e=Wd,t=Qd,n=Gd,s=Kd,o={},i=pn("start","drag","end"),a=0,l,u,c,f,d=0;function h(y){y.on("mousedown.drag",p).filter(s).on("touchstart.drag",w).on("touchmove.drag",x,Zd).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(y,S){if(!(f||!e.call(this,y,S))){var k=m(this,t.call(this,y,S),y,S,"mouse");k&&(ce(y.view).on("mousemove.drag",g,vt).on("mouseup.drag",b,vt),kr(y.view),Pn(y),c=!1,l=y.clientX,u=y.clientY,k("start",y))}}function g(y){if(Qe(y),!c){var S=y.clientX-l,k=y.clientY-u;c=S*S+k*k>d}o.mouse("drag",y)}function b(y){ce(y.view).on("mousemove.drag mouseup.drag",null),Cr(y.view,c),Qe(y),o.mouse("end",y)}function w(y,S){if(e.call(this,y,S)){var k=y.changedTouches,j=t.call(this,y,S),E=k.length,A,H;for(A=0;A<E;++A)(H=m(this,j,y,S,k[A].identifier,k[A]))&&(Pn(y),H("start",y,k[A]))}}function x(y){var S=y.changedTouches,k=S.length,j,E;for(j=0;j<k;++j)(E=o[S[j].identifier])&&(Qe(y),E("drag",y,S[j]))}function N(y){var S=y.changedTouches,k=S.length,j,E;for(f&&clearTimeout(f),f=setTimeout(function(){f=null},500),j=0;j<k;++j)(E=o[S[j].identifier])&&(Pn(y),E("end",y,S[j]))}function m(y,S,k,j,E,A){var H=i.copy(),T=ue(A||k,S),D,L,C;if((C=n.call(y,new Wn("beforestart",{sourceEvent:k,target:h,identifier:E,active:a,x:T[0],y:T[1],dx:0,dy:0,dispatch:H}),j))!=null)return D=C.x-T[0]||0,L=C.y-T[1]||0,function M(_,I,$){var P=T,z;switch(_){case"start":o[E]=M,z=a++;break;case"end":delete o[E],--a;case"drag":T=ue($||I,S),z=a;break}H.call(_,y,new Wn(_,{sourceEvent:I,subject:C,target:h,identifier:E,active:z,x:T[0]+D,y:T[1]+L,dx:T[0]-P[0],dy:T[1]-P[1],dispatch:H}),j)}}return h.filter=function(y){return arguments.length?(e=typeof y=="function"?y:Ot(!!y),h):e},h.container=function(y){return arguments.length?(t=typeof y=="function"?y:Ot(y),h):t},h.subject=function(y){return arguments.length?(n=typeof y=="function"?y:Ot(y),h):n},h.touchable=function(y){return arguments.length?(s=typeof y=="function"?y:Ot(!!y),h):s},h.on=function(){var y=i.on.apply(i,arguments);return y===i?h:y},h.clickDistance=function(y){return arguments.length?(d=(y=+y)*y,h):Math.sqrt(d)},h}function fs(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function _r(e,t){var n=Object.create(e.prototype);for(var s in t)n[s]=t[s];return n}function Tt(){}var Nt=.7,nn=1/Nt,Ge="\\s*([+-]?\\d+)\\s*",kt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ud=/^#([0-9a-f]{3,8})$/,Jd=new RegExp(`^rgb\\(${Ge},${Ge},${Ge}\\)$`),eu=new RegExp(`^rgb\\(${xe},${xe},${xe}\\)$`),tu=new RegExp(`^rgba\\(${Ge},${Ge},${Ge},${kt}\\)$`),nu=new RegExp(`^rgba\\(${xe},${xe},${xe},${kt}\\)$`),su=new RegExp(`^hsl\\(${kt},${xe},${xe}\\)$`),ou=new RegExp(`^hsla\\(${kt},${xe},${xe},${kt}\\)$`),qs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};fs(Tt,He,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Xs,formatHex:Xs,formatHex8:ru,formatHsl:iu,formatRgb:Ys,toString:Ys});function Xs(){return this.rgb().formatHex()}function ru(){return this.rgb().formatHex8()}function iu(){return Sr(this).formatHsl()}function Ys(){return this.rgb().formatRgb()}function He(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ud.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Zs(t):n===3?new le(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Bt(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Bt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Jd.exec(e))?new le(t[1],t[2],t[3],1):(t=eu.exec(e))?new le(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=tu.exec(e))?Bt(t[1],t[2],t[3],t[4]):(t=nu.exec(e))?Bt(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=su.exec(e))?Gs(t[1],t[2]/100,t[3]/100,1):(t=ou.exec(e))?Gs(t[1],t[2]/100,t[3]/100,t[4]):qs.hasOwnProperty(e)?Zs(qs[e]):e==="transparent"?new le(NaN,NaN,NaN,0):null}function Zs(e){return new le(e>>16&255,e>>8&255,e&255,1)}function Bt(e,t,n,s){return s<=0&&(e=t=n=NaN),new le(e,t,n,s)}function au(e){return e instanceof Tt||(e=He(e)),e?(e=e.rgb(),new le(e.r,e.g,e.b,e.opacity)):new le}function Qn(e,t,n,s){return arguments.length===1?au(e):new le(e,t,n,s??1)}function le(e,t,n,s){this.r=+e,this.g=+t,this.b=+n,this.opacity=+s}fs(le,Qn,_r(Tt,{brighter(e){return e=e==null?nn:Math.pow(nn,e),new le(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Nt:Math.pow(Nt,e),new le(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new le(ze(this.r),ze(this.g),ze(this.b),sn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ws,formatHex:Ws,formatHex8:lu,formatRgb:Qs,toString:Qs}));function Ws(){return`#${Pe(this.r)}${Pe(this.g)}${Pe(this.b)}`}function lu(){return`#${Pe(this.r)}${Pe(this.g)}${Pe(this.b)}${Pe((isNaN(this.opacity)?1:this.opacity)*255)}`}function Qs(){const e=sn(this.opacity);return`${e===1?"rgb(":"rgba("}${ze(this.r)}, ${ze(this.g)}, ${ze(this.b)}${e===1?")":`, ${e})`}`}function sn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ze(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Pe(e){return e=ze(e),(e<16?"0":"")+e.toString(16)}function Gs(e,t,n,s){return s<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new fe(e,t,n,s)}function Sr(e){if(e instanceof fe)return new fe(e.h,e.s,e.l,e.opacity);if(e instanceof Tt||(e=He(e)),!e)return new fe;if(e instanceof fe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,s=e.b/255,o=Math.min(t,n,s),i=Math.max(t,n,s),a=NaN,l=i-o,u=(i+o)/2;return l?(t===i?a=(n-s)/l+(n<s)*6:n===i?a=(s-t)/l+2:a=(t-n)/l+4,l/=u<.5?i+o:2-i-o,a*=60):l=u>0&&u<1?0:a,new fe(a,l,u,e.opacity)}function cu(e,t,n,s){return arguments.length===1?Sr(e):new fe(e,t,n,s??1)}function fe(e,t,n,s){this.h=+e,this.s=+t,this.l=+n,this.opacity=+s}fs(fe,cu,_r(Tt,{brighter(e){return e=e==null?nn:Math.pow(nn,e),new fe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Nt:Math.pow(Nt,e),new fe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*t,o=2*n-s;return new le(Dn(e>=240?e-240:e+120,o,s),Dn(e,o,s),Dn(e<120?e+240:e-120,o,s),this.opacity)},clamp(){return new fe(Ks(this.h),Vt(this.s),Vt(this.l),sn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=sn(this.opacity);return`${e===1?"hsl(":"hsla("}${Ks(this.h)}, ${Vt(this.s)*100}%, ${Vt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Ks(e){return e=(e||0)%360,e<0?e+360:e}function Vt(e){return Math.max(0,Math.min(1,e||0))}function Dn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const hs=e=>()=>e;function du(e,t){return function(n){return e+n*t}}function uu(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(s){return Math.pow(e+s*t,n)}}function fu(e){return(e=+e)==1?Er:function(t,n){return n-t?uu(t,n,e):hs(isNaN(t)?n:t)}}function Er(e,t){var n=t-e;return n?du(e,n):hs(isNaN(e)?t:e)}const on=(function e(t){var n=fu(t);function s(o,i){var a=n((o=Qn(o)).r,(i=Qn(i)).r),l=n(o.g,i.g),u=n(o.b,i.b),c=Er(o.opacity,i.opacity);return function(f){return o.r=a(f),o.g=l(f),o.b=u(f),o.opacity=c(f),o+""}}return s.gamma=e,s})(1);function hu(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,s=t.slice(),o;return function(i){for(o=0;o<n;++o)s[o]=e[o]*(1-i)+t[o]*i;return s}}function mu(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function pu(e,t){var n=t?t.length:0,s=e?Math.min(n,e.length):0,o=new Array(s),i=new Array(n),a;for(a=0;a<s;++a)o[a]=xt(e[a],t[a]);for(;a<n;++a)i[a]=t[a];return function(l){for(a=0;a<s;++a)i[a]=o[a](l);return i}}function gu(e,t){var n=new Date;return e=+e,t=+t,function(s){return n.setTime(e*(1-s)+t*s),n}}function ge(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function xu(e,t){var n={},s={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?n[o]=xt(e[o],t[o]):s[o]=t[o];return function(i){for(o in n)s[o]=n[o](i);return s}}var Gn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zn=new RegExp(Gn.source,"g");function yu(e){return function(){return e}}function bu(e){return function(t){return e(t)+""}}function Mr(e,t){var n=Gn.lastIndex=zn.lastIndex=0,s,o,i,a=-1,l=[],u=[];for(e=e+"",t=t+"";(s=Gn.exec(e))&&(o=zn.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),l[a]?l[a]+=i:l[++a]=i),(s=s[0])===(o=o[0])?l[a]?l[a]+=o:l[++a]=o:(l[++a]=null,u.push({i:a,x:ge(s,o)})),n=zn.lastIndex;return n<t.length&&(i=t.slice(n),l[a]?l[a]+=i:l[++a]=i),l.length<2?u[0]?bu(u[0].x):yu(t):(t=u.length,function(c){for(var f=0,d;f<t;++f)l[(d=u[f]).i]=d.x(c);return l.join("")})}function xt(e,t){var n=typeof t,s;return t==null||n==="boolean"?hs(t):(n==="number"?ge:n==="string"?(s=He(t))?(t=s,on):Mr:t instanceof He?on:t instanceof Date?gu:mu(t)?hu:Array.isArray(t)?pu:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?xu:ge)(e,t)}var Us=180/Math.PI,Kn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ir(e,t,n,s,o,i){var a,l,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*s)&&(n-=e*u,s-=t*u),(l=Math.sqrt(n*n+s*s))&&(n/=l,s/=l,u/=l),e*s<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*Us,skewX:Math.atan(u)*Us,scaleX:a,scaleY:l}}var Ft;function wu(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Kn:Ir(t.a,t.b,t.c,t.d,t.e,t.f)}function vu(e){return e==null||(Ft||(Ft=document.createElementNS("http://www.w3.org/2000/svg","g")),Ft.setAttribute("transform",e),!(e=Ft.transform.baseVal.consolidate()))?Kn:(e=e.matrix,Ir(e.a,e.b,e.c,e.d,e.e,e.f))}function $r(e,t,n,s){function o(c){return c.length?c.pop()+" ":""}function i(c,f,d,h,p,g){if(c!==d||f!==h){var b=p.push("translate(",null,t,null,n);g.push({i:b-4,x:ge(c,d)},{i:b-2,x:ge(f,h)})}else(d||h)&&p.push("translate("+d+t+h+n)}function a(c,f,d,h){c!==f?(c-f>180?f+=360:f-c>180&&(c+=360),h.push({i:d.push(o(d)+"rotate(",null,s)-2,x:ge(c,f)})):f&&d.push(o(d)+"rotate("+f+s)}function l(c,f,d,h){c!==f?h.push({i:d.push(o(d)+"skewX(",null,s)-2,x:ge(c,f)}):f&&d.push(o(d)+"skewX("+f+s)}function u(c,f,d,h,p,g){if(c!==d||f!==h){var b=p.push(o(p)+"scale(",null,",",null,")");g.push({i:b-4,x:ge(c,d)},{i:b-2,x:ge(f,h)})}else(d!==1||h!==1)&&p.push(o(p)+"scale("+d+","+h+")")}return function(c,f){var d=[],h=[];return c=e(c),f=e(f),i(c.translateX,c.translateY,f.translateX,f.translateY,d,h),a(c.rotate,f.rotate,d,h),l(c.skewX,f.skewX,d,h),u(c.scaleX,c.scaleY,f.scaleX,f.scaleY,d,h),c=f=null,function(p){for(var g=-1,b=h.length,w;++g<b;)d[(w=h[g]).i]=w.x(p);return d.join("")}}}var Nu=$r(wu,"px, ","px)","deg)"),ku=$r(vu,", ",")",")"),Cu=1e-12;function Js(e){return((e=Math.exp(e))+1/e)/2}function ju(e){return((e=Math.exp(e))-1/e)/2}function _u(e){return((e=Math.exp(2*e))-1)/(e+1)}const Gt=(function e(t,n,s){function o(i,a){var l=i[0],u=i[1],c=i[2],f=a[0],d=a[1],h=a[2],p=f-l,g=d-u,b=p*p+g*g,w,x;if(b<Cu)x=Math.log(h/c)/t,w=function(j){return[l+j*p,u+j*g,c*Math.exp(t*j*x)]};else{var N=Math.sqrt(b),m=(h*h-c*c+s*b)/(2*c*n*N),y=(h*h-c*c-s*b)/(2*h*n*N),S=Math.log(Math.sqrt(m*m+1)-m),k=Math.log(Math.sqrt(y*y+1)-y);x=(k-S)/t,w=function(j){var E=j*x,A=Js(S),H=c/(n*N)*(A*_u(t*E+S)-ju(S));return[l+H*p,u+H*g,c*A/Js(t*E+S)]}}return w.duration=x*1e3*t/Math.SQRT2,w}return o.rho=function(i){var a=Math.max(.001,+i),l=a*a,u=l*l;return e(a,l,u)},o})(Math.SQRT2,2,4);var Ue=0,ht=0,dt=0,Tr=1e3,rn,mt,an=0,Oe=0,xn=0,Ct=typeof performance=="object"&&performance.now?performance:Date,Ar=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ms(){return Oe||(Ar(Su),Oe=Ct.now()+xn)}function Su(){Oe=0}function ln(){this._call=this._time=this._next=null}ln.prototype=Pr.prototype={constructor:ln,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?ms():+n)+(t==null?0:+t),!this._next&&mt!==this&&(mt?mt._next=this:rn=this,mt=this),this._call=e,this._time=n,Un()},stop:function(){this._call&&(this._call=null,this._time=1/0,Un())}};function Pr(e,t,n){var s=new ln;return s.restart(e,t,n),s}function Eu(){ms(),++Ue;for(var e=rn,t;e;)(t=Oe-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ue}function eo(){Oe=(an=Ct.now())+xn,Ue=ht=0;try{Eu()}finally{Ue=0,Iu(),Oe=0}}function Mu(){var e=Ct.now(),t=e-an;t>Tr&&(xn-=t,an=e)}function Iu(){for(var e,t=rn,n,s=1/0;t;)t._call?(s>t._time&&(s=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:rn=n);mt=e,Un(s)}function Un(e){if(!Ue){ht&&(ht=clearTimeout(ht));var t=e-Oe;t>24?(e<1/0&&(ht=setTimeout(eo,e-Ct.now()-xn)),dt&&(dt=clearInterval(dt))):(dt||(an=Ct.now(),dt=setInterval(Mu,Tr)),Ue=1,Ar(eo))}}function to(e,t,n){var s=new ln;return t=t==null?0:+t,s.restart(o=>{s.stop(),e(o+t)},t,n),s}var $u=pn("start","end","cancel","interrupt"),Tu=[],Dr=0,no=1,Jn=2,Kt=3,so=4,es=5,Ut=6;function yn(e,t,n,s,o,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;Au(e,n,{name:t,index:s,group:o,on:$u,tween:Tu,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Dr})}function ps(e,t){var n=pe(e,t);if(n.state>Dr)throw new Error("too late; already scheduled");return n}function be(e,t){var n=pe(e,t);if(n.state>Kt)throw new Error("too late; already running");return n}function pe(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Au(e,t,n){var s=e.__transition,o;s[t]=n,n.timer=Pr(i,0,n.time);function i(c){n.state=no,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var f,d,h,p;if(n.state!==no)return u();for(f in s)if(p=s[f],p.name===n.name){if(p.state===Kt)return to(a);p.state===so?(p.state=Ut,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete s[f]):+f<t&&(p.state=Ut,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete s[f])}if(to(function(){n.state===Kt&&(n.state=so,n.timer.restart(l,n.delay,n.time),l(c))}),n.state=Jn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Jn){for(n.state=Kt,o=new Array(h=n.tween.length),f=0,d=-1;f<h;++f)(p=n.tween[f].value.call(e,e.__data__,n.index,n.group))&&(o[++d]=p);o.length=d+1}}function l(c){for(var f=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(u),n.state=es,1),d=-1,h=o.length;++d<h;)o[d].call(e,f);n.state===es&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){n.state=Ut,n.timer.stop(),delete s[t];for(var c in s)return;delete e.__transition}}function Jt(e,t){var n=e.__transition,s,o,i=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((s=n[a]).name!==t){i=!1;continue}o=s.state>Jn&&s.state<es,s.state=Ut,s.timer.stop(),s.on.call(o?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete n[a]}i&&delete e.__transition}}function Pu(e){return this.each(function(){Jt(this,e)})}function Du(e,t){var n,s;return function(){var o=be(this,e),i=o.tween;if(i!==n){s=n=i;for(var a=0,l=s.length;a<l;++a)if(s[a].name===t){s=s.slice(),s.splice(a,1);break}}o.tween=s}}function zu(e,t,n){var s,o;if(typeof n!="function")throw new Error;return function(){var i=be(this,e),a=i.tween;if(a!==s){o=(s=a).slice();for(var l={name:t,value:n},u=0,c=o.length;u<c;++u)if(o[u].name===t){o[u]=l;break}u===c&&o.push(l)}i.tween=o}}function Lu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var s=pe(this.node(),n).tween,o=0,i=s.length,a;o<i;++o)if((a=s[o]).name===e)return a.value;return null}return this.each((t==null?Du:zu)(n,e,t))}function gs(e,t,n){var s=e._id;return e.each(function(){var o=be(this,s);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return pe(o,s).value[t]}}function zr(e,t){var n;return(typeof t=="number"?ge:t instanceof He?on:(n=He(t))?(t=n,on):Mr)(e,t)}function Ru(e){return function(){this.removeAttribute(e)}}function Hu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ou(e,t,n){var s,o=n+"",i;return function(){var a=this.getAttribute(e);return a===o?null:a===s?i:i=t(s=a,n)}}function Bu(e,t,n){var s,o=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===o?null:a===s?i:i=t(s=a,n)}}function Vu(e,t,n){var s,o,i;return function(){var a,l=n(this),u;return l==null?void this.removeAttribute(e):(a=this.getAttribute(e),u=l+"",a===u?null:a===s&&u===o?i:(o=u,i=t(s=a,l)))}}function Fu(e,t,n){var s,o,i;return function(){var a,l=n(this),u;return l==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),u=l+"",a===u?null:a===s&&u===o?i:(o=u,i=t(s=a,l)))}}function qu(e,t){var n=gn(e),s=n==="transform"?ku:zr;return this.attrTween(e,typeof t=="function"?(n.local?Fu:Vu)(n,s,gs(this,"attr."+e,t)):t==null?(n.local?Hu:Ru)(n):(n.local?Bu:Ou)(n,s,t))}function Xu(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Yu(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Zu(e,t){var n,s;function o(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&Yu(e,i)),n}return o._value=t,o}function Wu(e,t){var n,s;function o(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&Xu(e,i)),n}return o._value=t,o}function Qu(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var s=gn(e);return this.tween(n,(s.local?Zu:Wu)(s,t))}function Gu(e,t){return function(){ps(this,e).delay=+t.apply(this,arguments)}}function Ku(e,t){return t=+t,function(){ps(this,e).delay=t}}function Uu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Gu:Ku)(t,e)):pe(this.node(),t).delay}function Ju(e,t){return function(){be(this,e).duration=+t.apply(this,arguments)}}function ef(e,t){return t=+t,function(){be(this,e).duration=t}}function tf(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ju:ef)(t,e)):pe(this.node(),t).duration}function nf(e,t){if(typeof t!="function")throw new Error;return function(){be(this,e).ease=t}}function sf(e){var t=this._id;return arguments.length?this.each(nf(t,e)):pe(this.node(),t).ease}function of(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;be(this,e).ease=n}}function rf(e){if(typeof e!="function")throw new Error;return this.each(of(this._id,e))}function af(e){typeof e!="function"&&(e=hr(e));for(var t=this._groups,n=t.length,s=new Array(n),o=0;o<n;++o)for(var i=t[o],a=i.length,l=s[o]=[],u,c=0;c<a;++c)(u=i[c])&&e.call(u,u.__data__,c,i)&&l.push(u);return new je(s,this._parents,this._name,this._id)}function lf(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,s=t.length,o=n.length,i=Math.min(s,o),a=new Array(s),l=0;l<i;++l)for(var u=t[l],c=n[l],f=u.length,d=a[l]=new Array(f),h,p=0;p<f;++p)(h=u[p]||c[p])&&(d[p]=h);for(;l<s;++l)a[l]=t[l];return new je(a,this._parents,this._name,this._id)}function cf(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function df(e,t,n){var s,o,i=cf(t)?ps:be;return function(){var a=i(this,e),l=a.on;l!==s&&(o=(s=l).copy()).on(t,n),a.on=o}}function uf(e,t){var n=this._id;return arguments.length<2?pe(this.node(),n).on.on(e):this.each(df(n,e,t))}function ff(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function hf(){return this.on("end.remove",ff(this._id))}function mf(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ds(e));for(var s=this._groups,o=s.length,i=new Array(o),a=0;a<o;++a)for(var l=s[a],u=l.length,c=i[a]=new Array(u),f,d,h=0;h<u;++h)(f=l[h])&&(d=e.call(f,f.__data__,h,l))&&("__data__"in f&&(d.__data__=f.__data__),c[h]=d,yn(c[h],t,n,h,c,pe(f,n)));return new je(i,this._parents,t,n)}function pf(e){var t=this._name,n=this._id;typeof e!="function"&&(e=fr(e));for(var s=this._groups,o=s.length,i=[],a=[],l=0;l<o;++l)for(var u=s[l],c=u.length,f,d=0;d<c;++d)if(f=u[d]){for(var h=e.call(f,f.__data__,d,u),p,g=pe(f,n),b=0,w=h.length;b<w;++b)(p=h[b])&&yn(p,t,n,b,h,g);i.push(h),a.push(f)}return new je(i,a,t,n)}var gf=$t.prototype.constructor;function xf(){return new gf(this._groups,this._parents)}function yf(e,t){var n,s,o;return function(){var i=Ke(this,e),a=(this.style.removeProperty(e),Ke(this,e));return i===a?null:i===n&&a===s?o:o=t(n=i,s=a)}}function Lr(e){return function(){this.style.removeProperty(e)}}function bf(e,t,n){var s,o=n+"",i;return function(){var a=Ke(this,e);return a===o?null:a===s?i:i=t(s=a,n)}}function wf(e,t,n){var s,o,i;return function(){var a=Ke(this,e),l=n(this),u=l+"";return l==null&&(u=l=(this.style.removeProperty(e),Ke(this,e))),a===u?null:a===s&&u===o?i:(o=u,i=t(s=a,l))}}function vf(e,t){var n,s,o,i="style."+t,a="end."+i,l;return function(){var u=be(this,e),c=u.on,f=u.value[i]==null?l||(l=Lr(t)):void 0;(c!==n||o!==f)&&(s=(n=c).copy()).on(a,o=f),u.on=s}}function Nf(e,t,n){var s=(e+="")=="transform"?Nu:zr;return t==null?this.styleTween(e,yf(e,s)).on("end.style."+e,Lr(e)):typeof t=="function"?this.styleTween(e,wf(e,s,gs(this,"style."+e,t))).each(vf(this._id,e)):this.styleTween(e,bf(e,s,t),n).on("end.style."+e,null)}function kf(e,t,n){return function(s){this.style.setProperty(e,t.call(this,s),n)}}function Cf(e,t,n){var s,o;function i(){var a=t.apply(this,arguments);return a!==o&&(s=(o=a)&&kf(e,a,n)),s}return i._value=t,i}function jf(e,t,n){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;return this.tween(s,Cf(e,t,n??""))}function _f(e){return function(){this.textContent=e}}function Sf(e){return function(){var t=e(this);this.textContent=t??""}}function Ef(e){return this.tween("text",typeof e=="function"?Sf(gs(this,"text",e)):_f(e==null?"":e+""))}function Mf(e){return function(t){this.textContent=e.call(this,t)}}function If(e){var t,n;function s(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&Mf(o)),t}return s._value=e,s}function $f(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,If(e))}function Tf(){for(var e=this._name,t=this._id,n=Rr(),s=this._groups,o=s.length,i=0;i<o;++i)for(var a=s[i],l=a.length,u,c=0;c<l;++c)if(u=a[c]){var f=pe(u,t);yn(u,e,n,c,a,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new je(s,this._parents,e,n)}function Af(){var e,t,n=this,s=n._id,o=n.size();return new Promise(function(i,a){var l={value:a},u={value:function(){--o===0&&i()}};n.each(function(){var c=be(this,s),f=c.on;f!==e&&(t=(e=f).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(u)),c.on=t}),o===0&&i()})}var Pf=0;function je(e,t,n,s){this._groups=e,this._parents=t,this._name=n,this._id=s}function Rr(){return++Pf}var ve=$t.prototype;je.prototype={constructor:je,select:mf,selectAll:pf,selectChild:ve.selectChild,selectChildren:ve.selectChildren,filter:af,merge:lf,selection:xf,transition:Tf,call:ve.call,nodes:ve.nodes,node:ve.node,size:ve.size,empty:ve.empty,each:ve.each,on:uf,attr:qu,attrTween:Qu,style:Nf,styleTween:jf,text:Ef,textTween:$f,remove:hf,tween:Lu,delay:Uu,duration:tf,ease:sf,easeVarying:rf,end:Af,[Symbol.iterator]:ve[Symbol.iterator]};function Df(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var zf={time:null,delay:0,duration:250,ease:Df};function Lf(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Rf(e){var t,n;e instanceof je?(t=e._id,e=e._name):(t=Rr(),(n=zf).time=ms(),e=e==null?null:e+"");for(var s=this._groups,o=s.length,i=0;i<o;++i)for(var a=s[i],l=a.length,u,c=0;c<l;++c)(u=a[c])&&yn(u,e,t,c,a,n||Lf(u,t));return new je(s,this._parents,e,t)}$t.prototype.interrupt=Pu;$t.prototype.transition=Rf;const qt=e=>()=>e;function Hf(e,{sourceEvent:t,target:n,transform:s,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:o}})}function Ne(e,t,n){this.k=e,this.x=t,this.y=n}Ne.prototype={constructor:Ne,scale:function(e){return e===1?this:new Ne(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ne(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var bn=new Ne(1,0,0);Hr.prototype=Ne.prototype;function Hr(e){for(;!e.__zoom;)if(!(e=e.parentNode))return bn;return e.__zoom}function Ln(e){e.stopImmediatePropagation()}function ut(e){e.preventDefault(),e.stopImmediatePropagation()}function Of(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Bf(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function oo(){return this.__zoom||bn}function Vf(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Ff(){return navigator.maxTouchPoints||"ontouchstart"in this}function qf(e,t,n){var s=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function Or(){var e=Of,t=Bf,n=qf,s=Vf,o=Ff,i=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],l=250,u=Gt,c=pn("start","zoom","end"),f,d,h,p=500,g=150,b=0,w=10;function x(C){C.property("__zoom",oo).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",H).filter(o).on("touchstart.zoom",T).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(C,M,_,I){var $=C.selection?C.selection():C;$.property("__zoom",oo),C!==$?S(C,M,_,I):$.interrupt().each(function(){k(this,arguments).event(I).start().zoom(null,typeof M=="function"?M.apply(this,arguments):M).end()})},x.scaleBy=function(C,M,_,I){x.scaleTo(C,function(){var $=this.__zoom.k,P=typeof M=="function"?M.apply(this,arguments):M;return $*P},_,I)},x.scaleTo=function(C,M,_,I){x.transform(C,function(){var $=t.apply(this,arguments),P=this.__zoom,z=_==null?y($):typeof _=="function"?_.apply(this,arguments):_,O=P.invert(z),R=typeof M=="function"?M.apply(this,arguments):M;return n(m(N(P,R),z,O),$,a)},_,I)},x.translateBy=function(C,M,_,I){x.transform(C,function(){return n(this.__zoom.translate(typeof M=="function"?M.apply(this,arguments):M,typeof _=="function"?_.apply(this,arguments):_),t.apply(this,arguments),a)},null,I)},x.translateTo=function(C,M,_,I,$){x.transform(C,function(){var P=t.apply(this,arguments),z=this.__zoom,O=I==null?y(P):typeof I=="function"?I.apply(this,arguments):I;return n(bn.translate(O[0],O[1]).scale(z.k).translate(typeof M=="function"?-M.apply(this,arguments):-M,typeof _=="function"?-_.apply(this,arguments):-_),P,a)},I,$)};function N(C,M){return M=Math.max(i[0],Math.min(i[1],M)),M===C.k?C:new Ne(M,C.x,C.y)}function m(C,M,_){var I=M[0]-_[0]*C.k,$=M[1]-_[1]*C.k;return I===C.x&&$===C.y?C:new Ne(C.k,I,$)}function y(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function S(C,M,_,I){C.on("start.zoom",function(){k(this,arguments).event(I).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(I).end()}).tween("zoom",function(){var $=this,P=arguments,z=k($,P).event(I),O=t.apply($,P),R=_==null?y(O):typeof _=="function"?_.apply($,P):_,F=Math.max(O[1][0]-O[0][0],O[1][1]-O[0][1]),q=$.__zoom,Z=typeof M=="function"?M.apply($,P):M,U=u(q.invert(R).concat(F/q.k),Z.invert(R).concat(F/Z.k));return function(Q){if(Q===1)Q=Z;else{var V=U(Q),B=F/V[2];Q=new Ne(B,R[0]-V[0]*B,R[1]-V[1]*B)}z.zoom(null,Q)}})}function k(C,M,_){return!_&&C.__zooming||new j(C,M)}function j(C,M){this.that=C,this.args=M,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,M),this.taps=0}j.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,M){return this.mouse&&C!=="mouse"&&(this.mouse[1]=M.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=M.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=M.invert(this.touch1[0])),this.that.__zoom=M,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var M=ce(this.that).datum();c.call(C,this.that,new Hf(C,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:c}),M)}};function E(C,...M){if(!e.apply(this,arguments))return;var _=k(this,M).event(C),I=this.__zoom,$=Math.max(i[0],Math.min(i[1],I.k*Math.pow(2,s.apply(this,arguments)))),P=ue(C);if(_.wheel)(_.mouse[0][0]!==P[0]||_.mouse[0][1]!==P[1])&&(_.mouse[1]=I.invert(_.mouse[0]=P)),clearTimeout(_.wheel);else{if(I.k===$)return;_.mouse=[P,I.invert(P)],Jt(this),_.start()}ut(C),_.wheel=setTimeout(z,g),_.zoom("mouse",n(m(N(I,$),_.mouse[0],_.mouse[1]),_.extent,a));function z(){_.wheel=null,_.end()}}function A(C,...M){if(h||!e.apply(this,arguments))return;var _=C.currentTarget,I=k(this,M,!0).event(C),$=ce(C.view).on("mousemove.zoom",R,!0).on("mouseup.zoom",F,!0),P=ue(C,_),z=C.clientX,O=C.clientY;kr(C.view),Ln(C),I.mouse=[P,this.__zoom.invert(P)],Jt(this),I.start();function R(q){if(ut(q),!I.moved){var Z=q.clientX-z,U=q.clientY-O;I.moved=Z*Z+U*U>b}I.event(q).zoom("mouse",n(m(I.that.__zoom,I.mouse[0]=ue(q,_),I.mouse[1]),I.extent,a))}function F(q){$.on("mousemove.zoom mouseup.zoom",null),Cr(q.view,I.moved),ut(q),I.event(q).end()}}function H(C,...M){if(e.apply(this,arguments)){var _=this.__zoom,I=ue(C.changedTouches?C.changedTouches[0]:C,this),$=_.invert(I),P=_.k*(C.shiftKey?.5:2),z=n(m(N(_,P),I,$),t.apply(this,M),a);ut(C),l>0?ce(this).transition().duration(l).call(S,z,I,C):ce(this).call(x.transform,z,I,C)}}function T(C,...M){if(e.apply(this,arguments)){var _=C.touches,I=_.length,$=k(this,M,C.changedTouches.length===I).event(C),P,z,O,R;for(Ln(C),z=0;z<I;++z)O=_[z],R=ue(O,this),R=[R,this.__zoom.invert(R),O.identifier],$.touch0?!$.touch1&&$.touch0[2]!==R[2]&&($.touch1=R,$.taps=0):($.touch0=R,P=!0,$.taps=1+!!f);f&&(f=clearTimeout(f)),P&&($.taps<2&&(d=R[0],f=setTimeout(function(){f=null},p)),Jt(this),$.start())}}function D(C,...M){if(this.__zooming){var _=k(this,M).event(C),I=C.changedTouches,$=I.length,P,z,O,R;for(ut(C),P=0;P<$;++P)z=I[P],O=ue(z,this),_.touch0&&_.touch0[2]===z.identifier?_.touch0[0]=O:_.touch1&&_.touch1[2]===z.identifier&&(_.touch1[0]=O);if(z=_.that.__zoom,_.touch1){var F=_.touch0[0],q=_.touch0[1],Z=_.touch1[0],U=_.touch1[1],Q=(Q=Z[0]-F[0])*Q+(Q=Z[1]-F[1])*Q,V=(V=U[0]-q[0])*V+(V=U[1]-q[1])*V;z=N(z,Math.sqrt(Q/V)),O=[(F[0]+Z[0])/2,(F[1]+Z[1])/2],R=[(q[0]+U[0])/2,(q[1]+U[1])/2]}else if(_.touch0)O=_.touch0[0],R=_.touch0[1];else return;_.zoom("touch",n(m(z,O,R),_.extent,a))}}function L(C,...M){if(this.__zooming){var _=k(this,M).event(C),I=C.changedTouches,$=I.length,P,z;for(Ln(C),h&&clearTimeout(h),h=setTimeout(function(){h=null},p),P=0;P<$;++P)z=I[P],_.touch0&&_.touch0[2]===z.identifier?delete _.touch0:_.touch1&&_.touch1[2]===z.identifier&&delete _.touch1;if(_.touch1&&!_.touch0&&(_.touch0=_.touch1,delete _.touch1),_.touch0)_.touch0[1]=this.__zoom.invert(_.touch0[0]);else if(_.end(),_.taps===2&&(z=ue(z,this),Math.hypot(d[0]-z[0],d[1]-z[1])<w)){var O=ce(this).on("dblclick.zoom");O&&O.apply(this,arguments)}}}return x.wheelDelta=function(C){return arguments.length?(s=typeof C=="function"?C:qt(+C),x):s},x.filter=function(C){return arguments.length?(e=typeof C=="function"?C:qt(!!C),x):e},x.touchable=function(C){return arguments.length?(o=typeof C=="function"?C:qt(!!C),x):o},x.extent=function(C){return arguments.length?(t=typeof C=="function"?C:qt([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),x):t},x.scaleExtent=function(C){return arguments.length?(i[0]=+C[0],i[1]=+C[1],x):[i[0],i[1]]},x.translateExtent=function(C){return arguments.length?(a[0][0]=+C[0][0],a[1][0]=+C[1][0],a[0][1]=+C[0][1],a[1][1]=+C[1][1],x):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},x.constrain=function(C){return arguments.length?(n=C,x):n},x.duration=function(C){return arguments.length?(l=+C,x):l},x.interpolate=function(C){return arguments.length?(u=C,x):u},x.on=function(){var C=c.on.apply(c,arguments);return C===c?x:C},x.clickDistance=function(C){return arguments.length?(b=(C=+C)*C,x):Math.sqrt(b)},x.tapDistance=function(C){return arguments.length?(w=+C,x):w},x}const ye={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:s})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:s}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},jt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Br=["Enter"," ","Escape"],Vr={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Je;(function(e){e.Strict="strict",e.Loose="loose"})(Je||(Je={}));var Le;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Le||(Le={}));var _t;(function(e){e.Partial="partial",e.Full="full"})(_t||(_t={}));const Fr={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Ie;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ie||(Ie={}));var St;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(St||(St={}));var W;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(W||(W={}));const ro={[W.Left]:W.Right,[W.Right]:W.Left,[W.Top]:W.Bottom,[W.Bottom]:W.Top};function qr(e){return e===null?null:e?"valid":"invalid"}const Xr=e=>"id"in e&&"source"in e&&"target"in e,Xf=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),xs=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),At=(e,t=[0,0])=>{const{width:n,height:s}=_e(e),o=e.origin??t,i=n*o[0],a=s*o[1];return{x:e.position.x-i,y:e.position.y-a}},Yf=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((s,o)=>{const i=typeof o=="string";let a=!t.nodeLookup&&!i?o:void 0;t.nodeLookup&&(a=i?t.nodeLookup.get(o):xs(o)?o:t.nodeLookup.get(o.id));const l=a?cn(a,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return wn(s,l)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return vn(n)},Pt=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},s=!1;return e.forEach(o=>{(t.filter===void 0||t.filter(o))&&(n=wn(n,cn(o)),s=!0)}),s?vn(n):{x:0,y:0,width:0,height:0}},ys=(e,t,[n,s,o]=[0,0,1],i=!1,a=!1)=>{const l={...zt(t,[n,s,o]),width:t.width/o,height:t.height/o},u=[];for(const c of e.values()){const{measured:f,selectable:d=!0,hidden:h=!1}=c;if(a&&!d||h)continue;const p=f.width??c.width??c.initialWidth??null,g=f.height??c.height??c.initialHeight??null,b=Et(l,tt(c)),w=(p??0)*(g??0),x=i&&b>0;(!c.internals.handleBounds||x||b>=w||c.dragging)&&u.push(c)}return u},Zf=(e,t)=>{const n=new Set;return e.forEach(s=>{n.add(s.id)}),t.filter(s=>n.has(s.source)||n.has(s.target))};function Wf(e,t){const n=new Map,s=t?.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&(t?.includeHiddenNodes||!o.hidden)&&(!s||s.has(o.id))&&n.set(o.id,o)}),n}async function Qf({nodes:e,width:t,height:n,panZoom:s,minZoom:o,maxZoom:i},a){if(e.size===0)return Promise.resolve(!0);const l=Wf(e,a),u=Pt(l),c=bs(u,t,n,a?.minZoom??o,a?.maxZoom??i,a?.padding??.1);return await s.setViewport(c,{duration:a?.duration,ease:a?.ease,interpolate:a?.interpolate}),Promise.resolve(!0)}function Yr({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:s=[0,0],nodeExtent:o,onError:i}){const a=n.get(e),l=a.parentId?n.get(a.parentId):void 0,{x:u,y:c}=l?l.internals.positionAbsolute:{x:0,y:0},f=a.origin??s;let d=a.extent||o;if(a.extent==="parent"&&!a.expandParent)if(!l)i?.("005",ye.error005());else{const p=l.measured.width,g=l.measured.height;p&&g&&(d=[[u,c],[u+p,c+g]])}else l&&nt(a.extent)&&(d=[[a.extent[0][0]+u,a.extent[0][1]+c],[a.extent[1][0]+u,a.extent[1][1]+c]]);const h=nt(d)?Be(t,d,a.measured):t;return(a.measured.width===void 0||a.measured.height===void 0)&&i?.("015",ye.error015()),{position:{x:h.x-u+(a.measured.width??0)*f[0],y:h.y-c+(a.measured.height??0)*f[1]},positionAbsolute:h}}async function Gf({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:s,onBeforeDelete:o}){const i=new Set(e.map(h=>h.id)),a=[];for(const h of n){if(h.deletable===!1)continue;const p=i.has(h.id),g=!p&&h.parentId&&a.find(b=>b.id===h.parentId);(p||g)&&a.push(h)}const l=new Set(t.map(h=>h.id)),u=s.filter(h=>h.deletable!==!1),f=Zf(a,u);for(const h of u)l.has(h.id)&&!f.find(g=>g.id===h.id)&&f.push(h);if(!o)return{edges:f,nodes:a};const d=await o({nodes:a,edges:f});return typeof d=="boolean"?d?{edges:f,nodes:a}:{edges:[],nodes:[]}:d}const et=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Be=(e={x:0,y:0},t,n)=>({x:et(e.x,t[0][0],t[1][0]-(n?.width??0)),y:et(e.y,t[0][1],t[1][1]-(n?.height??0))});function Zr(e,t,n){const{width:s,height:o}=_e(n),{x:i,y:a}=n.internals.positionAbsolute;return Be(e,[[i,a],[i+s,a+o]],t)}const io=(e,t,n)=>e<t?et(Math.abs(e-t),1,t)/t:e>n?-et(Math.abs(e-n),1,t)/t:0,Wr=(e,t,n=15,s=40)=>{const o=io(e.x,s,t.width-s)*n,i=io(e.y,s,t.height-s)*n;return[o,i]},wn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),ts=({x:e,y:t,width:n,height:s})=>({x:e,y:t,x2:e+n,y2:t+s}),vn=({x:e,y:t,x2:n,y2:s})=>({x:e,y:t,width:n-e,height:s-t}),tt=(e,t=[0,0])=>{const{x:n,y:s}=xs(e)?e.internals.positionAbsolute:At(e,t);return{x:n,y:s,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},cn=(e,t=[0,0])=>{const{x:n,y:s}=xs(e)?e.internals.positionAbsolute:At(e,t);return{x:n,y:s,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:s+(e.measured?.height??e.height??e.initialHeight??0)}},Qr=(e,t)=>vn(wn(ts(e),ts(t))),Et=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),s=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*s)},ao=e=>he(e.width)&&he(e.height)&&he(e.x)&&he(e.y),he=e=>!isNaN(e)&&isFinite(e),Kf=(e,t)=>{},Dt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),zt=({x:e,y:t},[n,s,o],i=!1,a=[1,1])=>{const l={x:(e-n)/o,y:(t-s)/o};return i?Dt(l,a):l},dn=({x:e,y:t},[n,s,o])=>({x:e*o+n,y:t*o+s});function Xe(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Uf(e,t,n){if(typeof e=="string"||typeof e=="number"){const s=Xe(e,n),o=Xe(e,t);return{top:s,right:o,bottom:s,left:o,x:o*2,y:s*2}}if(typeof e=="object"){const s=Xe(e.top??e.y??0,n),o=Xe(e.bottom??e.y??0,n),i=Xe(e.left??e.x??0,t),a=Xe(e.right??e.x??0,t);return{top:s,right:a,bottom:o,left:i,x:i+a,y:s+o}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Jf(e,t,n,s,o,i){const{x:a,y:l}=dn(e,[t,n,s]),{x:u,y:c}=dn({x:e.x+e.width,y:e.y+e.height},[t,n,s]),f=o-u,d=i-c;return{left:Math.floor(a),top:Math.floor(l),right:Math.floor(f),bottom:Math.floor(d)}}const bs=(e,t,n,s,o,i)=>{const a=Uf(i,t,n),l=(t-a.x)/e.width,u=(n-a.y)/e.height,c=Math.min(l,u),f=et(c,s,o),d=e.x+e.width/2,h=e.y+e.height/2,p=t/2-d*f,g=n/2-h*f,b=Jf(e,p,g,f,t,n),w={left:Math.min(b.left-a.left,0),top:Math.min(b.top-a.top,0),right:Math.min(b.right-a.right,0),bottom:Math.min(b.bottom-a.bottom,0)};return{x:p-w.left+w.right,y:g-w.top+w.bottom,zoom:f}},Mt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function nt(e){return e!=null&&e!=="parent"}function _e(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function Gr(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function Kr(e,t={width:0,height:0},n,s,o){const i={...e},a=s.get(n);if(a){const l=a.origin||o;i.x+=a.internals.positionAbsolute.x-(t.width??0)*l[0],i.y+=a.internals.positionAbsolute.y-(t.height??0)*l[1]}return i}function lo(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function eh(){let e,t;return{promise:new Promise((s,o)=>{e=s,t=o}),resolve:e,reject:t}}function th(e){return{...Vr,...e||{}}}function yt(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:s,containerBounds:o}){const{x:i,y:a}=me(e),l=zt({x:i-(o?.left??0),y:a-(o?.top??0)},s),{x:u,y:c}=n?Dt(l,t):l;return{xSnapped:u,ySnapped:c,...l}}const ws=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ur=e=>e?.getRootNode?.()||window?.document,nh=["INPUT","SELECT","TEXTAREA"];function Jr(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:nh.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const ei=e=>"clientX"in e,me=(e,t)=>{const n=ei(e),s=n?e.clientX:e.touches?.[0].clientX,o=n?e.clientY:e.touches?.[0].clientY;return{x:s-(t?.left??0),y:o-(t?.top??0)}},co=(e,t,n,s,o)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(a=>{const l=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:e,nodeId:o,position:a.getAttribute("data-handlepos"),x:(l.left-n.left)/s,y:(l.top-n.top)/s,...ws(a)}})};function ti({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:o,sourceControlY:i,targetControlX:a,targetControlY:l}){const u=e*.125+o*.375+a*.375+n*.125,c=t*.125+i*.375+l*.375+s*.125,f=Math.abs(u-e),d=Math.abs(c-t);return[u,c,f,d]}function Xt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function uo({pos:e,x1:t,y1:n,x2:s,y2:o,c:i}){switch(e){case W.Left:return[t-Xt(t-s,i),n];case W.Right:return[t+Xt(s-t,i),n];case W.Top:return[t,n-Xt(n-o,i)];case W.Bottom:return[t,n+Xt(o-n,i)]}}function ni({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:s,targetY:o,targetPosition:i=W.Top,curvature:a=.25}){const[l,u]=uo({pos:n,x1:e,y1:t,x2:s,y2:o,c:a}),[c,f]=uo({pos:i,x1:s,y1:o,x2:e,y2:t,c:a}),[d,h,p,g]=ti({sourceX:e,sourceY:t,targetX:s,targetY:o,sourceControlX:l,sourceControlY:u,targetControlX:c,targetControlY:f});return[`M${e},${t} C${l},${u} ${c},${f} ${s},${o}`,d,h,p,g]}function si({sourceX:e,sourceY:t,targetX:n,targetY:s}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,a=Math.abs(s-t)/2,l=s<t?s+a:s-a;return[i,l,o,a]}function sh({sourceNode:e,targetNode:t,selected:n=!1,zIndex:s=0,elevateOnSelect:o=!1,zIndexMode:i="basic"}){if(i==="manual")return s;const a=o&&n?s+1e3:s,l=Math.max(e.parentId||o&&e.selected?e.internals.z:0,t.parentId||o&&t.selected?t.internals.z:0);return a+l}function oh({sourceNode:e,targetNode:t,width:n,height:s,transform:o}){const i=wn(cn(e),cn(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const a={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:s/o[2]};return Et(a,vn(i))>0}const rh=({source:e,sourceHandle:t,target:n,targetHandle:s})=>`xy-edge__${e}${t||""}-${n}${s||""}`,ih=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),ah=(e,t,n={})=>{if(!e.source||!e.target)return t;const s=n.getEdgeId||rh;let o;return Xr(e)?o={...e}:o={...e,id:s(e)},ih(o,t)?t:(o.sourceHandle===null&&delete o.sourceHandle,o.targetHandle===null&&delete o.targetHandle,t.concat(o))};function oi({sourceX:e,sourceY:t,targetX:n,targetY:s}){const[o,i,a,l]=si({sourceX:e,sourceY:t,targetX:n,targetY:s});return[`M ${e},${t}L ${n},${s}`,o,i,a,l]}const fo={[W.Left]:{x:-1,y:0},[W.Right]:{x:1,y:0},[W.Top]:{x:0,y:-1},[W.Bottom]:{x:0,y:1}},lh=({source:e,sourcePosition:t=W.Bottom,target:n})=>t===W.Left||t===W.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},ho=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function ch({source:e,sourcePosition:t=W.Bottom,target:n,targetPosition:s=W.Top,center:o,offset:i,stepPosition:a}){const l=fo[t],u=fo[s],c={x:e.x+l.x*i,y:e.y+l.y*i},f={x:n.x+u.x*i,y:n.y+u.y*i},d=lh({source:c,sourcePosition:t,target:f}),h=d.x!==0?"x":"y",p=d[h];let g=[],b,w;const x={x:0,y:0},N={x:0,y:0},[,,m,y]=si({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(l[h]*u[h]===-1){h==="x"?(b=o.x??c.x+(f.x-c.x)*a,w=o.y??(c.y+f.y)/2):(b=o.x??(c.x+f.x)/2,w=o.y??c.y+(f.y-c.y)*a);const k=[{x:b,y:c.y},{x:b,y:f.y}],j=[{x:c.x,y:w},{x:f.x,y:w}];l[h]===p?g=h==="x"?k:j:g=h==="x"?j:k}else{const k=[{x:c.x,y:f.y}],j=[{x:f.x,y:c.y}];if(h==="x"?g=l.x===p?j:k:g=l.y===p?k:j,t===s){const D=Math.abs(e[h]-n[h]);if(D<=i){const L=Math.min(i-1,i-D);l[h]===p?x[h]=(c[h]>e[h]?-1:1)*L:N[h]=(f[h]>n[h]?-1:1)*L}}if(t!==s){const D=h==="x"?"y":"x",L=l[h]===u[D],C=c[D]>f[D],M=c[D]<f[D];(l[h]===1&&(!L&&C||L&&M)||l[h]!==1&&(!L&&M||L&&C))&&(g=h==="x"?k:j)}const E={x:c.x+x.x,y:c.y+x.y},A={x:f.x+N.x,y:f.y+N.y},H=Math.max(Math.abs(E.x-g[0].x),Math.abs(A.x-g[0].x)),T=Math.max(Math.abs(E.y-g[0].y),Math.abs(A.y-g[0].y));H>=T?(b=(E.x+A.x)/2,w=g[0].y):(b=g[0].x,w=(E.y+A.y)/2)}return[[e,{x:c.x+x.x,y:c.y+x.y},...g,{x:f.x+N.x,y:f.y+N.y},n],b,w,m,y]}function dh(e,t,n,s){const o=Math.min(ho(e,t)/2,ho(t,n)/2,s),{x:i,y:a}=t;if(e.x===i&&i===n.x||e.y===a&&a===n.y)return`L${i} ${a}`;if(e.y===a){const c=e.x<n.x?-1:1,f=e.y<n.y?1:-1;return`L ${i+o*c},${a}Q ${i},${a} ${i},${a+o*f}`}const l=e.x<n.x?1:-1,u=e.y<n.y?-1:1;return`L ${i},${a+o*u}Q ${i},${a} ${i+o*l},${a}`}function ns({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:s,targetY:o,targetPosition:i=W.Top,borderRadius:a=5,centerX:l,centerY:u,offset:c=20,stepPosition:f=.5}){const[d,h,p,g,b]=ch({source:{x:e,y:t},sourcePosition:n,target:{x:s,y:o},targetPosition:i,center:{x:l,y:u},offset:c,stepPosition:f});return[d.reduce((x,N,m)=>{let y="";return m>0&&m<d.length-1?y=dh(d[m-1],N,d[m+1],a):y=`${m===0?"M":"L"}${N.x} ${N.y}`,x+=y,x},""),h,p,g,b]}function mo(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function uh(e){const{sourceNode:t,targetNode:n}=e;if(!mo(t)||!mo(n))return null;const s=t.internals.handleBounds||po(t.handles),o=n.internals.handleBounds||po(n.handles),i=go(s?.source??[],e.sourceHandle),a=go(e.connectionMode===Je.Strict?o?.target??[]:(o?.target??[]).concat(o?.source??[]),e.targetHandle);if(!i||!a)return e.onError?.("008",ye.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const l=i?.position||W.Bottom,u=a?.position||W.Top,c=Ve(t,i,l),f=Ve(n,a,u);return{sourceX:c.x,sourceY:c.y,targetX:f.x,targetY:f.y,sourcePosition:l,targetPosition:u}}function po(e){if(!e)return null;const t=[],n=[];for(const s of e)s.width=s.width??1,s.height=s.height??1,s.type==="source"?t.push(s):s.type==="target"&&n.push(s);return{source:t,target:n}}function Ve(e,t,n=W.Left,s=!1){const o=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:a,height:l}=t??_e(e);if(s)return{x:o+a/2,y:i+l/2};switch(t?.position??n){case W.Top:return{x:o+a/2,y:i};case W.Right:return{x:o+a,y:i+l/2};case W.Bottom:return{x:o+a/2,y:i+l};case W.Left:return{x:o,y:i+l/2}}}function go(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function ss(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(s=>`${s}=${e[s]}`).join("&")}`:""}function fh(e,{id:t,defaultColor:n,defaultMarkerStart:s,defaultMarkerEnd:o}){const i=new Set;return e.reduce((a,l)=>([l.markerStart||s,l.markerEnd||o].forEach(u=>{if(u&&typeof u=="object"){const c=ss(u,t);i.has(c)||(a.push({id:c,color:u.color||n,...u}),i.add(c))}}),a),[]).sort((a,l)=>a.id.localeCompare(l.id))}const ri=1e3,hh=10,vs={nodeOrigin:[0,0],nodeExtent:jt,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},mh={...vs,checkEquality:!0};function Ns(e,t){const n={...e};for(const s in t)t[s]!==void 0&&(n[s]=t[s]);return n}function ph(e,t,n){const s=Ns(vs,n);for(const o of e.values())if(o.parentId)Cs(o,e,t,s);else{const i=At(o,s.nodeOrigin),a=nt(o.extent)?o.extent:s.nodeExtent,l=Be(i,a,_e(o));o.internals.positionAbsolute=l}}function gh(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const n=[],s=[];for(const o of e.handles){const i={id:o.id,width:o.width??1,height:o.height??1,nodeId:e.id,x:o.x,y:o.y,position:o.position,type:o.type};o.type==="source"?n.push(i):o.type==="target"&&s.push(i)}return{source:n,target:s}}function ks(e){return e==="manual"}function os(e,t,n,s={}){const o=Ns(mh,s),i={i:0},a=new Map(t),l=o?.elevateNodesOnSelect&&!ks(o.zIndexMode)?ri:0;let u=e.length>0;t.clear(),n.clear();for(const c of e){let f=a.get(c.id);if(o.checkEquality&&c===f?.internals.userNode)t.set(c.id,f);else{const d=At(c,o.nodeOrigin),h=nt(c.extent)?c.extent:o.nodeExtent,p=Be(d,h,_e(c));f={...o.defaults,...c,measured:{width:c.measured?.width,height:c.measured?.height},internals:{positionAbsolute:p,handleBounds:gh(c,f),z:ii(c,l,o.zIndexMode),userNode:c}},t.set(c.id,f)}(f.measured===void 0||f.measured.width===void 0||f.measured.height===void 0)&&!f.hidden&&(u=!1),c.parentId&&Cs(f,t,n,s,i)}return u}function xh(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Cs(e,t,n,s,o){const{elevateNodesOnSelect:i,nodeOrigin:a,nodeExtent:l,zIndexMode:u}=Ns(vs,s),c=e.parentId,f=t.get(c);if(!f){console.warn(`Parent node ${c} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}xh(e,n),o&&!f.parentId&&f.internals.rootParentIndex===void 0&&u==="auto"&&(f.internals.rootParentIndex=++o.i,f.internals.z=f.internals.z+o.i*hh),o&&f.internals.rootParentIndex!==void 0&&(o.i=f.internals.rootParentIndex);const d=i&&!ks(u)?ri:0,{x:h,y:p,z:g}=yh(e,f,a,l,d,u),{positionAbsolute:b}=e.internals,w=h!==b.x||p!==b.y;(w||g!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:w?{x:h,y:p}:b,z:g}})}function ii(e,t,n){const s=he(e.zIndex)?e.zIndex:0;return ks(n)?s:s+(e.selected?t:0)}function yh(e,t,n,s,o,i){const{x:a,y:l}=t.internals.positionAbsolute,u=_e(e),c=At(e,n),f=nt(e.extent)?Be(c,e.extent,u):c;let d=Be({x:a+f.x,y:l+f.y},s,u);e.extent==="parent"&&(d=Zr(d,u,t));const h=ii(e,o,i),p=t.internals.z??0;return{x:d.x,y:d.y,z:p>=h?p+1:h}}function js(e,t,n,s=[0,0]){const o=[],i=new Map;for(const a of e){const l=t.get(a.parentId);if(!l)continue;const u=i.get(a.parentId)?.expandedRect??tt(l),c=Qr(u,a.rect);i.set(a.parentId,{expandedRect:c,parent:l})}return i.size>0&&i.forEach(({expandedRect:a,parent:l},u)=>{const c=l.internals.positionAbsolute,f=_e(l),d=l.origin??s,h=a.x<c.x?Math.round(Math.abs(c.x-a.x)):0,p=a.y<c.y?Math.round(Math.abs(c.y-a.y)):0,g=Math.max(f.width,Math.round(a.width)),b=Math.max(f.height,Math.round(a.height)),w=(g-f.width)*d[0],x=(b-f.height)*d[1];(h>0||p>0||w||x)&&(o.push({id:u,type:"position",position:{x:l.position.x-h+w,y:l.position.y-p+x}}),n.get(u)?.forEach(N=>{e.some(m=>m.id===N.id)||o.push({id:N.id,type:"position",position:{x:N.position.x+h,y:N.position.y+p}})})),(f.width<a.width||f.height<a.height||h||p)&&o.push({id:u,type:"dimensions",setAttributes:!0,dimensions:{width:g+(h?d[0]*h-w:0),height:b+(p?d[1]*p-x:0)}})}),o}function bh(e,t,n,s,o,i,a){const l=s?.querySelector(".xyflow__viewport");let u=!1;if(!l)return{changes:[],updatedInternals:u};const c=[],f=window.getComputedStyle(l),{m22:d}=new window.DOMMatrixReadOnly(f.transform),h=[];for(const p of e.values()){const g=t.get(p.id);if(!g)continue;if(g.hidden){t.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),u=!0;continue}const b=ws(p.nodeElement),w=g.measured.width!==b.width||g.measured.height!==b.height;if(!!(b.width&&b.height&&(w||!g.internals.handleBounds||p.force))){const N=p.nodeElement.getBoundingClientRect(),m=nt(g.extent)?g.extent:i;let{positionAbsolute:y}=g.internals;g.parentId&&g.extent==="parent"?y=Zr(y,b,t.get(g.parentId)):m&&(y=Be(y,m,b));const S={...g,measured:b,internals:{...g.internals,positionAbsolute:y,handleBounds:{source:co("source",p.nodeElement,N,d,g.id),target:co("target",p.nodeElement,N,d,g.id)}}};t.set(g.id,S),g.parentId&&Cs(S,t,n,{nodeOrigin:o,zIndexMode:a}),u=!0,w&&(c.push({id:g.id,type:"dimensions",dimensions:b}),g.expandParent&&g.parentId&&h.push({id:g.id,parentId:g.parentId,rect:tt(S,o)}))}}if(h.length>0){const p=js(h,t,n,o);c.push(...p)}return{changes:c,updatedInternals:u}}async function wh({delta:e,panZoom:t,transform:n,translateExtent:s,width:o,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const a=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,i]],s),l=!!a&&(a.x!==n[0]||a.y!==n[1]||a.k!==n[2]);return Promise.resolve(l)}function xo(e,t,n,s,o,i){let a=o;const l=s.get(a)||new Map;s.set(a,l.set(n,t)),a=`${o}-${e}`;const u=s.get(a)||new Map;if(s.set(a,u.set(n,t)),i){a=`${o}-${e}-${i}`;const c=s.get(a)||new Map;s.set(a,c.set(n,t))}}function ai(e,t,n){e.clear(),t.clear();for(const s of n){const{source:o,target:i,sourceHandle:a=null,targetHandle:l=null}=s,u={edgeId:s.id,source:o,target:i,sourceHandle:a,targetHandle:l},c=`${o}-${a}--${i}-${l}`,f=`${i}-${l}--${o}-${a}`;xo("source",u,f,e,o,a),xo("target",u,c,e,i,l),t.set(s.id,s)}}function li(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:li(n,t):!1}function yo(e,t,n){let s=e;do{if(s?.matches?.(t))return!0;if(s===n)return!1;s=s?.parentElement}while(s);return!1}function vh(e,t,n,s){const o=new Map;for(const[i,a]of e)if((a.selected||a.id===s)&&(!a.parentId||!li(a,e))&&(a.draggable||t&&typeof a.draggable>"u")){const l=e.get(i);l&&o.set(i,{id:i,position:l.position||{x:0,y:0},distance:{x:n.x-l.internals.positionAbsolute.x,y:n.y-l.internals.positionAbsolute.y},extent:l.extent,parentId:l.parentId,origin:l.origin,expandParent:l.expandParent,internals:{positionAbsolute:l.internals.positionAbsolute||{x:0,y:0}},measured:{width:l.measured.width??0,height:l.measured.height??0}})}return o}function Rn({nodeId:e,dragItems:t,nodeLookup:n,dragging:s=!0}){const o=[];for(const[a,l]of t){const u=n.get(a)?.internals.userNode;u&&o.push({...u,position:l.position,dragging:s})}if(!e)return[o[0],o];const i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:s}:o[0],o]}function Nh({dragItems:e,snapGrid:t,x:n,y:s}){const o=e.values().next().value;if(!o)return null;const i={x:n-o.distance.x,y:s-o.distance.y},a=Dt(i,t);return{x:a.x-i.x,y:a.y-i.y}}function kh({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:s,onDragStop:o}){let i={x:null,y:null},a=0,l=new Map,u=!1,c={x:0,y:0},f=null,d=!1,h=null,p=!1,g=!1,b=null;function w({noDragClassName:N,handleSelector:m,domNode:y,isSelectable:S,nodeId:k,nodeClickDistance:j=0}){h=ce(y);function E({x:D,y:L}){const{nodeLookup:C,nodeExtent:M,snapGrid:_,snapToGrid:I,nodeOrigin:$,onNodeDrag:P,onSelectionDrag:z,onError:O,updateNodePositions:R}=t();i={x:D,y:L};let F=!1;const q=l.size>1,Z=q&&M?ts(Pt(l)):null,U=q&&I?Nh({dragItems:l,snapGrid:_,x:D,y:L}):null;for(const[Q,V]of l){if(!C.has(Q))continue;let B={x:D-V.distance.x,y:L-V.distance.y};I&&(B=U?{x:Math.round(B.x+U.x),y:Math.round(B.y+U.y)}:Dt(B,_));let X=null;if(q&&M&&!V.extent&&Z){const{positionAbsolute:K}=V.internals,te=K.x-Z.x+M[0][0],se=K.x+V.measured.width-Z.x2+M[1][0],ne=K.y-Z.y+M[0][1],ae=K.y+V.measured.height-Z.y2+M[1][1];X=[[te,ne],[se,ae]]}const{position:J,positionAbsolute:G}=Yr({nodeId:Q,nextPosition:B,nodeLookup:C,nodeExtent:X||M,nodeOrigin:$,onError:O});F=F||V.position.x!==J.x||V.position.y!==J.y,V.position=J,V.internals.positionAbsolute=G}if(g=g||F,!!F&&(R(l,!0),b&&(s||P||!k&&z))){const[Q,V]=Rn({nodeId:k,dragItems:l,nodeLookup:C});s?.(b,l,Q,V),P?.(b,Q,V),k||z?.(b,V)}}async function A(){if(!f)return;const{transform:D,panBy:L,autoPanSpeed:C,autoPanOnNodeDrag:M}=t();if(!M){u=!1,cancelAnimationFrame(a);return}const[_,I]=Wr(c,f,C);(_!==0||I!==0)&&(i.x=(i.x??0)-_/D[2],i.y=(i.y??0)-I/D[2],await L({x:_,y:I})&&E(i)),a=requestAnimationFrame(A)}function H(D){const{nodeLookup:L,multiSelectionActive:C,nodesDraggable:M,transform:_,snapGrid:I,snapToGrid:$,selectNodesOnDrag:P,onNodeDragStart:z,onSelectionDragStart:O,unselectNodesAndEdges:R}=t();d=!0,(!P||!S)&&!C&&k&&(L.get(k)?.selected||R()),S&&P&&k&&e?.(k);const F=yt(D.sourceEvent,{transform:_,snapGrid:I,snapToGrid:$,containerBounds:f});if(i=F,l=vh(L,M,F,k),l.size>0&&(n||z||!k&&O)){const[q,Z]=Rn({nodeId:k,dragItems:l,nodeLookup:L});n?.(D.sourceEvent,l,q,Z),z?.(D.sourceEvent,q,Z),k||O?.(D.sourceEvent,Z)}}const T=jr().clickDistance(j).on("start",D=>{const{domNode:L,nodeDragThreshold:C,transform:M,snapGrid:_,snapToGrid:I}=t();f=L?.getBoundingClientRect()||null,p=!1,g=!1,b=D.sourceEvent,C===0&&H(D),i=yt(D.sourceEvent,{transform:M,snapGrid:_,snapToGrid:I,containerBounds:f}),c=me(D.sourceEvent,f)}).on("drag",D=>{const{autoPanOnNodeDrag:L,transform:C,snapGrid:M,snapToGrid:_,nodeDragThreshold:I,nodeLookup:$}=t(),P=yt(D.sourceEvent,{transform:C,snapGrid:M,snapToGrid:_,containerBounds:f});if(b=D.sourceEvent,(D.sourceEvent.type==="touchmove"&&D.sourceEvent.touches.length>1||k&&!$.has(k))&&(p=!0),!p){if(!u&&L&&d&&(u=!0,A()),!d){const z=me(D.sourceEvent,f),O=z.x-c.x,R=z.y-c.y;Math.sqrt(O*O+R*R)>I&&H(D)}(i.x!==P.xSnapped||i.y!==P.ySnapped)&&l&&d&&(c=me(D.sourceEvent,f),E(P))}}).on("end",D=>{if(!(!d||p)&&(u=!1,d=!1,cancelAnimationFrame(a),l.size>0)){const{nodeLookup:L,updateNodePositions:C,onNodeDragStop:M,onSelectionDragStop:_}=t();if(g&&(C(l,!1),g=!1),o||M||!k&&_){const[I,$]=Rn({nodeId:k,dragItems:l,nodeLookup:L,dragging:!1});o?.(D.sourceEvent,l,I,$),M?.(D.sourceEvent,I,$),k||_?.(D.sourceEvent,$)}}}).filter(D=>{const L=D.target;return!D.button&&(!N||!yo(L,`.${N}`,y))&&(!m||yo(L,m,y))});h.call(T)}function x(){h?.on(".drag",null)}return{update:w,destroy:x}}function Ch(e,t,n){const s=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())Et(o,tt(i))>0&&s.push(i);return s}const jh=250;function _h(e,t,n,s){let o=[],i=1/0;const a=Ch(e,n,t+jh);for(const l of a){const u=[...l.internals.handleBounds?.source??[],...l.internals.handleBounds?.target??[]];for(const c of u){if(s.nodeId===c.nodeId&&s.type===c.type&&s.id===c.id)continue;const{x:f,y:d}=Ve(l,c,c.position,!0),h=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(d-e.y,2));h>t||(h<i?(o=[{...c,x:f,y:d}],i=h):h===i&&o.push({...c,x:f,y:d}))}}if(!o.length)return null;if(o.length>1){const l=s.type==="source"?"target":"source";return o.find(u=>u.type===l)??o[0]}return o[0]}function ci(e,t,n,s,o,i=!1){const a=s.get(e);if(!a)return null;const l=o==="strict"?a.internals.handleBounds?.[t]:[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]],u=(n?l?.find(c=>c.id===n):l?.[0])??null;return u&&i?{...u,...Ve(a,u,u.position,!0)}:u}function di(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Sh(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const ui=()=>!0;function Eh(e,{connectionMode:t,connectionRadius:n,handleId:s,nodeId:o,edgeUpdaterType:i,isTarget:a,domNode:l,nodeLookup:u,lib:c,autoPanOnConnect:f,flowId:d,panBy:h,cancelConnection:p,onConnectStart:g,onConnect:b,onConnectEnd:w,isValidConnection:x=ui,onReconnectEnd:N,updateConnection:m,getTransform:y,getFromHandle:S,autoPanSpeed:k,dragThreshold:j=1,handleDomNode:E}){const A=Ur(e.target);let H=0,T;const{x:D,y:L}=me(e),C=di(i,E),M=l?.getBoundingClientRect();let _=!1;if(!M||!C)return;const I=ci(o,C,s,u,t);if(!I)return;let $=me(e,M),P=!1,z=null,O=!1,R=null;function F(){if(!f||!M)return;const[J,G]=Wr($,M,k);h({x:J,y:G}),H=requestAnimationFrame(F)}const q={...I,nodeId:o,type:C,position:I.position},Z=u.get(o);let Q={inProgress:!0,isValid:null,from:Ve(Z,q,W.Left,!0),fromHandle:q,fromPosition:q.position,fromNode:Z,to:$,toHandle:null,toPosition:ro[q.position],toNode:null,pointer:$};function V(){_=!0,m(Q),g?.(e,{nodeId:o,handleId:s,handleType:C})}j===0&&V();function B(J){if(!_){const{x:ae,y:Se}=me(J),we=ae-D,Te=Se-L;if(!(we*we+Te*Te>j*j))return;V()}if(!S()||!q){X(J);return}const G=y();$=me(J,M),T=_h(zt($,G,!1,[1,1]),n,u,q),P||(F(),P=!0);const K=fi(J,{handle:T,connectionMode:t,fromNodeId:o,fromHandleId:s,fromType:a?"target":"source",isValidConnection:x,doc:A,lib:c,flowId:d,nodeLookup:u});R=K.handleDomNode,z=K.connection,O=Sh(!!T,K.isValid);const te=u.get(o),se=te?Ve(te,q,W.Left,!0):Q.from,ne={...Q,from:se,isValid:O,to:K.toHandle&&O?dn({x:K.toHandle.x,y:K.toHandle.y},G):$,toHandle:K.toHandle,toPosition:O&&K.toHandle?K.toHandle.position:ro[q.position],toNode:K.toHandle?u.get(K.toHandle.nodeId):null,pointer:$};m(ne),Q=ne}function X(J){if(!("touches"in J&&J.touches.length>0)){if(_){(T||R)&&z&&O&&b?.(z);const{inProgress:G,...K}=Q,te={...K,toPosition:Q.toHandle?Q.toPosition:null};w?.(J,te),i&&N?.(J,te)}p(),cancelAnimationFrame(H),P=!1,O=!1,z=null,R=null,A.removeEventListener("mousemove",B),A.removeEventListener("mouseup",X),A.removeEventListener("touchmove",B),A.removeEventListener("touchend",X)}}A.addEventListener("mousemove",B),A.addEventListener("mouseup",X),A.addEventListener("touchmove",B),A.addEventListener("touchend",X)}function fi(e,{handle:t,connectionMode:n,fromNodeId:s,fromHandleId:o,fromType:i,doc:a,lib:l,flowId:u,isValidConnection:c=ui,nodeLookup:f}){const d=i==="target",h=t?a.querySelector(`.${l}-flow__handle[data-id="${u}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:p,y:g}=me(e),b=a.elementFromPoint(p,g),w=b?.classList.contains(`${l}-flow__handle`)?b:h,x={handleDomNode:w,isValid:!1,connection:null,toHandle:null};if(w){const N=di(void 0,w),m=w.getAttribute("data-nodeid"),y=w.getAttribute("data-handleid"),S=w.classList.contains("connectable"),k=w.classList.contains("connectableend");if(!m||!N)return x;const j={source:d?m:s,sourceHandle:d?y:o,target:d?s:m,targetHandle:d?o:y};x.connection=j;const A=S&&k&&(n===Je.Strict?d&&N==="source"||!d&&N==="target":m!==s||y!==o);x.isValid=A&&c(j),x.toHandle=ci(m,N,y,f,n,!0)}return x}const rs={onPointerDown:Eh,isValid:fi};function Mh({domNode:e,panZoom:t,getTransform:n,getViewScale:s}){const o=ce(e);function i({translateExtent:l,width:u,height:c,zoomStep:f=1,pannable:d=!0,zoomable:h=!0,inversePan:p=!1}){const g=m=>{if(m.sourceEvent.type!=="wheel"||!t)return;const y=n(),S=m.sourceEvent.ctrlKey&&Mt()?10:1,k=-m.sourceEvent.deltaY*(m.sourceEvent.deltaMode===1?.05:m.sourceEvent.deltaMode?1:.002)*f,j=y[2]*Math.pow(2,k*S);t.scaleTo(j)};let b=[0,0];const w=m=>{(m.sourceEvent.type==="mousedown"||m.sourceEvent.type==="touchstart")&&(b=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY])},x=m=>{const y=n();if(m.sourceEvent.type!=="mousemove"&&m.sourceEvent.type!=="touchmove"||!t)return;const S=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY],k=[S[0]-b[0],S[1]-b[1]];b=S;const j=s()*Math.max(y[2],Math.log(y[2]))*(p?-1:1),E={x:y[0]-k[0]*j,y:y[1]-k[1]*j},A=[[0,0],[u,c]];t.setViewportConstrained({x:E.x,y:E.y,zoom:y[2]},A,l)},N=Or().on("start",w).on("zoom",d?x:null).on("zoom.wheel",h?g:null);o.call(N,{})}function a(){o.on("zoom",null)}return{update:i,destroy:a,pointer:ue}}const Nn=e=>({x:e.x,y:e.y,zoom:e.k}),Hn=({x:e,y:t,zoom:n})=>bn.translate(e,t).scale(n),Ze=(e,t)=>e.target.closest(`.${t}`),hi=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Ih=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,On=(e,t=0,n=Ih,s=()=>{})=>{const o=typeof t=="number"&&t>0;return o||s(),o?e.transition().duration(t).ease(n).on("end",s):e},mi=e=>{const t=e.ctrlKey&&Mt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function $h({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:s,panOnScrollMode:o,panOnScrollSpeed:i,zoomOnPinch:a,onPanZoomStart:l,onPanZoom:u,onPanZoomEnd:c}){return f=>{if(Ze(f,t))return f.ctrlKey&&f.preventDefault(),!1;f.preventDefault(),f.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(f.ctrlKey&&a){const w=ue(f),x=mi(f),N=d*Math.pow(2,x);s.scaleTo(n,N,w,f);return}const h=f.deltaMode===1?20:1;let p=o===Le.Vertical?0:f.deltaX*h,g=o===Le.Horizontal?0:f.deltaY*h;!Mt()&&f.shiftKey&&o!==Le.Vertical&&(p=f.deltaY*h,g=0),s.translateBy(n,-(p/d)*i,-(g/d)*i,{internal:!0});const b=Nn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(u?.(f,b),e.panScrollTimeout=setTimeout(()=>{c?.(f,b),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,l?.(f,b))}}function Th({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(s,o){const i=s.type==="wheel",a=!t&&i&&!s.ctrlKey,l=Ze(s,e);if(s.ctrlKey&&i&&l&&s.preventDefault(),a||l)return null;s.preventDefault(),n.call(this,s,o)}}function Ah({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return s=>{if(s.sourceEvent?.internal)return;const o=Nn(s.transform);e.mouseButton=s.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=o,s.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(s.sourceEvent,o)}}function Ph({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:s,onPanZoom:o}){return i=>{e.usedRightMouseButton=!!(n&&hi(t,e.mouseButton??0)),i.sourceEvent?.sync||s([i.transform.x,i.transform.y,i.transform.k]),o&&!i.sourceEvent?.internal&&o?.(i.sourceEvent,Nn(i.transform))}}function Dh({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:s,onPanZoomEnd:o,onPaneContextMenu:i}){return a=>{if(!a.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&hi(t,e.mouseButton??0)&&!e.usedRightMouseButton&&a.sourceEvent&&i(a.sourceEvent),e.usedRightMouseButton=!1,s(!1),o)){const l=Nn(a.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o?.(a.sourceEvent,l)},n?150:0)}}}function zh({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:s,panOnScroll:o,zoomOnDoubleClick:i,userSelectionActive:a,noWheelClassName:l,noPanClassName:u,lib:c,connectionInProgress:f}){return d=>{const h=e||t,p=n&&d.ctrlKey,g=d.type==="wheel";if(d.button===1&&d.type==="mousedown"&&(Ze(d,`${c}-flow__node`)||Ze(d,`${c}-flow__edge`)))return!0;if(!s&&!h&&!o&&!i&&!n||a||f&&!g||Ze(d,l)&&g||Ze(d,u)&&(!g||o&&g&&!e)||!n&&d.ctrlKey&&g)return!1;if(!n&&d.type==="touchstart"&&d.touches?.length>1)return d.preventDefault(),!1;if(!h&&!o&&!p&&g||!s&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(s)&&!s.includes(d.button)&&d.type==="mousedown")return!1;const b=Array.isArray(s)&&s.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||g)&&b}}function Lh({domNode:e,minZoom:t,maxZoom:n,translateExtent:s,viewport:o,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:u}){const c={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},f=e.getBoundingClientRect(),d=Or().scaleExtent([t,n]).translateExtent(s),h=ce(e).call(d);N({x:o.x,y:o.y,zoom:et(o.zoom,t,n)},[[0,0],[f.width,f.height]],s);const p=h.on("wheel.zoom"),g=h.on("dblclick.zoom");d.wheelDelta(mi);function b(T,D){return h?new Promise(L=>{d?.interpolate(D?.interpolate==="linear"?xt:Gt).transform(On(h,D?.duration,D?.ease,()=>L(!0)),T)}):Promise.resolve(!1)}function w({noWheelClassName:T,noPanClassName:D,onPaneContextMenu:L,userSelectionActive:C,panOnScroll:M,panOnDrag:_,panOnScrollMode:I,panOnScrollSpeed:$,preventScrolling:P,zoomOnPinch:z,zoomOnScroll:O,zoomOnDoubleClick:R,zoomActivationKeyPressed:F,lib:q,onTransformChange:Z,connectionInProgress:U,paneClickDistance:Q,selectionOnDrag:V}){C&&!c.isZoomingOrPanning&&x();const B=M&&!F&&!C;d.clickDistance(V?1/0:!he(Q)||Q<0?0:Q);const X=B?$h({zoomPanValues:c,noWheelClassName:T,d3Selection:h,d3Zoom:d,panOnScrollMode:I,panOnScrollSpeed:$,zoomOnPinch:z,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:l}):Th({noWheelClassName:T,preventScrolling:P,d3ZoomHandler:p});if(h.on("wheel.zoom",X,{passive:!1}),!C){const G=Ah({zoomPanValues:c,onDraggingChange:u,onPanZoomStart:a});d.on("start",G);const K=Ph({zoomPanValues:c,panOnDrag:_,onPaneContextMenu:!!L,onPanZoom:i,onTransformChange:Z});d.on("zoom",K);const te=Dh({zoomPanValues:c,panOnDrag:_,panOnScroll:M,onPaneContextMenu:L,onPanZoomEnd:l,onDraggingChange:u});d.on("end",te)}const J=zh({zoomActivationKeyPressed:F,panOnDrag:_,zoomOnScroll:O,panOnScroll:M,zoomOnDoubleClick:R,zoomOnPinch:z,userSelectionActive:C,noPanClassName:D,noWheelClassName:T,lib:q,connectionInProgress:U});d.filter(J),R?h.on("dblclick.zoom",g):h.on("dblclick.zoom",null)}function x(){d.on("zoom",null)}async function N(T,D,L){const C=Hn(T),M=d?.constrain()(C,D,L);return M&&await b(M),new Promise(_=>_(M))}async function m(T,D){const L=Hn(T);return await b(L,D),new Promise(C=>C(L))}function y(T){if(h){const D=Hn(T),L=h.property("__zoom");(L.k!==T.zoom||L.x!==T.x||L.y!==T.y)&&d?.transform(h,D,null,{sync:!0})}}function S(){const T=h?Hr(h.node()):{x:0,y:0,k:1};return{x:T.x,y:T.y,zoom:T.k}}function k(T,D){return h?new Promise(L=>{d?.interpolate(D?.interpolate==="linear"?xt:Gt).scaleTo(On(h,D?.duration,D?.ease,()=>L(!0)),T)}):Promise.resolve(!1)}function j(T,D){return h?new Promise(L=>{d?.interpolate(D?.interpolate==="linear"?xt:Gt).scaleBy(On(h,D?.duration,D?.ease,()=>L(!0)),T)}):Promise.resolve(!1)}function E(T){d?.scaleExtent(T)}function A(T){d?.translateExtent(T)}function H(T){const D=!he(T)||T<0?0:T;d?.clickDistance(D)}return{update:w,destroy:x,setViewport:m,setViewportConstrained:N,getViewport:S,scaleTo:k,scaleBy:j,setScaleExtent:E,setTranslateExtent:A,syncViewport:y,setClickDistance:H}}var st;(function(e){e.Line="line",e.Handle="handle"})(st||(st={}));function Rh({width:e,prevWidth:t,height:n,prevHeight:s,affectsX:o,affectsY:i}){const a=e-t,l=n-s,u=[a>0?1:a<0?-1:0,l>0?1:l<0?-1:0];return a&&o&&(u[0]=u[0]*-1),l&&i&&(u[1]=u[1]*-1),u}function bo(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),s=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:s,affectsY:o}}function Ee(e,t){return Math.max(0,t-e)}function Me(e,t){return Math.max(0,e-t)}function Yt(e,t,n){return Math.max(0,t-e,e-n)}function wo(e,t){return e?!t:t}function Hh(e,t,n,s,o,i,a,l){let{affectsX:u,affectsY:c}=t;const{isHorizontal:f,isVertical:d}=t,h=f&&d,{xSnapped:p,ySnapped:g}=n,{minWidth:b,maxWidth:w,minHeight:x,maxHeight:N}=s,{x:m,y,width:S,height:k,aspectRatio:j}=e;let E=Math.floor(f?p-e.pointerX:0),A=Math.floor(d?g-e.pointerY:0);const H=S+(u?-E:E),T=k+(c?-A:A),D=-i[0]*S,L=-i[1]*k;let C=Yt(H,b,w),M=Yt(T,x,N);if(a){let $=0,P=0;u&&E<0?$=Ee(m+E+D,a[0][0]):!u&&E>0&&($=Me(m+H+D,a[1][0])),c&&A<0?P=Ee(y+A+L,a[0][1]):!c&&A>0&&(P=Me(y+T+L,a[1][1])),C=Math.max(C,$),M=Math.max(M,P)}if(l){let $=0,P=0;u&&E>0?$=Me(m+E,l[0][0]):!u&&E<0&&($=Ee(m+H,l[1][0])),c&&A>0?P=Me(y+A,l[0][1]):!c&&A<0&&(P=Ee(y+T,l[1][1])),C=Math.max(C,$),M=Math.max(M,P)}if(o){if(f){const $=Yt(H/j,x,N)*j;if(C=Math.max(C,$),a){let P=0;!u&&!c||u&&!c&&h?P=Me(y+L+H/j,a[1][1])*j:P=Ee(y+L+(u?E:-E)/j,a[0][1])*j,C=Math.max(C,P)}if(l){let P=0;!u&&!c||u&&!c&&h?P=Ee(y+H/j,l[1][1])*j:P=Me(y+(u?E:-E)/j,l[0][1])*j,C=Math.max(C,P)}}if(d){const $=Yt(T*j,b,w)/j;if(M=Math.max(M,$),a){let P=0;!u&&!c||c&&!u&&h?P=Me(m+T*j+D,a[1][0])/j:P=Ee(m+(c?A:-A)*j+D,a[0][0])/j,M=Math.max(M,P)}if(l){let P=0;!u&&!c||c&&!u&&h?P=Ee(m+T*j,l[1][0])/j:P=Me(m+(c?A:-A)*j,l[0][0])/j,M=Math.max(M,P)}}}A=A+(A<0?M:-M),E=E+(E<0?C:-C),o&&(h?H>T*j?A=(wo(u,c)?-E:E)/j:E=(wo(u,c)?-A:A)*j:f?(A=E/j,c=u):(E=A*j,u=c));const _=u?m+E:m,I=c?y+A:y;return{width:S+(u?-E:E),height:k+(c?-A:A),x:i[0]*E*(u?-1:1)+_,y:i[1]*A*(c?-1:1)+I}}const pi={width:0,height:0,x:0,y:0},Oh={...pi,pointerX:0,pointerY:0,aspectRatio:1};function Bh(e){return[[0,0],[e.measured.width,e.measured.height]]}function Vh(e,t,n){const s=t.position.x+e.position.x,o=t.position.y+e.position.y,i=e.measured.width??0,a=e.measured.height??0,l=n[0]*i,u=n[1]*a;return[[s-l,o-u],[s+i-l,o+a-u]]}function Fh({domNode:e,nodeId:t,getStoreItems:n,onChange:s,onEnd:o}){const i=ce(e);let a={controlDirection:bo("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function l({controlPosition:c,boundaries:f,keepAspectRatio:d,resizeDirection:h,onResizeStart:p,onResize:g,onResizeEnd:b,shouldResize:w}){let x={...pi},N={...Oh};a={boundaries:f,resizeDirection:h,keepAspectRatio:d,controlDirection:bo(c)};let m,y=null,S=[],k,j,E,A=!1;const H=jr().on("start",T=>{const{nodeLookup:D,transform:L,snapGrid:C,snapToGrid:M,nodeOrigin:_,paneDomNode:I}=n();if(m=D.get(t),!m)return;y=I?.getBoundingClientRect()??null;const{xSnapped:$,ySnapped:P}=yt(T.sourceEvent,{transform:L,snapGrid:C,snapToGrid:M,containerBounds:y});x={width:m.measured.width??0,height:m.measured.height??0,x:m.position.x??0,y:m.position.y??0},N={...x,pointerX:$,pointerY:P,aspectRatio:x.width/x.height},k=void 0,m.parentId&&(m.extent==="parent"||m.expandParent)&&(k=D.get(m.parentId),j=k&&m.extent==="parent"?Bh(k):void 0),S=[],E=void 0;for(const[z,O]of D)if(O.parentId===t&&(S.push({id:z,position:{...O.position},extent:O.extent}),O.extent==="parent"||O.expandParent)){const R=Vh(O,m,O.origin??_);E?E=[[Math.min(R[0][0],E[0][0]),Math.min(R[0][1],E[0][1])],[Math.max(R[1][0],E[1][0]),Math.max(R[1][1],E[1][1])]]:E=R}p?.(T,{...x})}).on("drag",T=>{const{transform:D,snapGrid:L,snapToGrid:C,nodeOrigin:M}=n(),_=yt(T.sourceEvent,{transform:D,snapGrid:L,snapToGrid:C,containerBounds:y}),I=[];if(!m)return;const{x:$,y:P,width:z,height:O}=x,R={},F=m.origin??M,{width:q,height:Z,x:U,y:Q}=Hh(N,a.controlDirection,_,a.boundaries,a.keepAspectRatio,F,j,E),V=q!==z,B=Z!==O,X=U!==$&&V,J=Q!==P&&B;if(!X&&!J&&!V&&!B)return;if((X||J||F[0]===1||F[1]===1)&&(R.x=X?U:x.x,R.y=J?Q:x.y,x.x=R.x,x.y=R.y,S.length>0)){const se=U-$,ne=Q-P;for(const ae of S)ae.position={x:ae.position.x-se+F[0]*(q-z),y:ae.position.y-ne+F[1]*(Z-O)},I.push(ae)}if((V||B)&&(R.width=V&&(!a.resizeDirection||a.resizeDirection==="horizontal")?q:x.width,R.height=B&&(!a.resizeDirection||a.resizeDirection==="vertical")?Z:x.height,x.width=R.width,x.height=R.height),k&&m.expandParent){const se=F[0]*(R.width??0);R.x&&R.x<se&&(x.x=se,N.x=N.x-(R.x-se));const ne=F[1]*(R.height??0);R.y&&R.y<ne&&(x.y=ne,N.y=N.y-(R.y-ne))}const G=Rh({width:x.width,prevWidth:z,height:x.height,prevHeight:O,affectsX:a.controlDirection.affectsX,affectsY:a.controlDirection.affectsY}),K={...x,direction:G};w?.(T,K)!==!1&&(A=!0,g?.(T,K),s(R,I))}).on("end",T=>{A&&(b?.(T,{...x}),o?.({...x}),A=!1)});i.call(H)}function u(){i.on(".drag",null)}return{update:l,destroy:u}}var Bn={exports:{}},Vn={};var vo;function qh(){if(vo)return Vn;vo=1;var e=tl(),t=nl();function n(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var s=typeof Object.is=="function"?Object.is:n,o=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,l=e.useMemo,u=e.useDebugValue;return Vn.useSyncExternalStoreWithSelector=function(c,f,d,h,p){var g=i(null);if(g.current===null){var b={hasValue:!1,value:null};g.current=b}else b=g.current;g=l(function(){function x(k){if(!N){if(N=!0,m=k,k=h(k),p!==void 0&&b.hasValue){var j=b.value;if(p(j,k))return y=j}return y=k}if(j=y,s(m,k))return j;var E=h(k);return p!==void 0&&p(j,E)?(m=k,j):(m=k,y=E)}var N=!1,m,y,S=d===void 0?null:d;return[function(){return x(f())},S===null?void 0:function(){return x(S())}]},[f,d,h,p]);var w=o(c,g[0],g[1]);return a(function(){b.hasValue=!0,b.value=w},[w]),u(w),w},Vn}var No;function Xh(){return No||(No=1,Bn.exports=qh()),Bn.exports}var Yh=Xh();const Zh=sl(Yh),Wh={},ko=e=>{let t;const n=new Set,s=(f,d)=>{const h=typeof f=="function"?f(t):f;if(!Object.is(h,t)){const p=t;t=d??(typeof h!="object"||h===null)?h:Object.assign({},t,h),n.forEach(g=>g(t,p))}},o=()=>t,u={setState:s,getState:o,getInitialState:()=>c,subscribe:f=>(n.add(f),()=>n.delete(f)),destroy:()=>{(Wh?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(s,o,u);return u},Qh=e=>e?ko(e):ko,{useDebugValue:Gh}=ol,{useSyncExternalStoreWithSelector:Kh}=Zh,Uh=e=>e;function gi(e,t=Uh,n){const s=Kh(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Gh(s),s}const Co=(e,t)=>{const n=Qh(e),s=(o,i=t)=>gi(n,o,i);return Object.assign(s,n),s},Jh=(e,t)=>e?Co(e,t):Co;function oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,o]of e)if(!Object.is(o,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const s of n)if(!Object.prototype.hasOwnProperty.call(t,s)||!Object.is(e[s],t[s]))return!1;return!0}const kn=v.createContext(null),em=kn.Provider,xi=ye.error001();function ee(e,t){const n=v.useContext(kn);if(n===null)throw new Error(xi);return gi(n,e,t)}function re(){const e=v.useContext(kn);if(e===null)throw new Error(xi);return v.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const jo={display:"none"},tm={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},yi="react-flow__node-desc",bi="react-flow__edge-desc",nm="react-flow__aria-live",sm=e=>e.ariaLiveMessage,om=e=>e.ariaLabelConfig;function rm({rfId:e}){const t=ee(sm);return r.jsx("div",{id:`${nm}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:tm,children:t})}function im({rfId:e,disableKeyboardA11y:t}){const n=ee(om);return r.jsxs(r.Fragment,{children:[r.jsx("div",{id:`${yi}-${e}`,style:jo,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),r.jsx("div",{id:`${bi}-${e}`,style:jo,children:n["edge.a11yDescription.default"]}),!t&&r.jsx(rm,{rfId:e})]})}const Cn=v.forwardRef(({position:e="top-left",children:t,className:n,style:s,...o},i)=>{const a=`${e}`.split("-");return r.jsx("div",{className:ie(["react-flow__panel",n,...a]),style:s,ref:i,...o,children:t})});Cn.displayName="Panel";function am({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:r.jsx(Cn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:r.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const lm=e=>{const t=[],n=[];for(const[,s]of e.nodeLookup)s.selected&&t.push(s.internals.userNode);for(const[,s]of e.edgeLookup)s.selected&&n.push(s);return{selectedNodes:t,selectedEdges:n}},Zt=e=>e.id;function cm(e,t){return oe(e.selectedNodes.map(Zt),t.selectedNodes.map(Zt))&&oe(e.selectedEdges.map(Zt),t.selectedEdges.map(Zt))}function dm({onSelectionChange:e}){const t=re(),{selectedNodes:n,selectedEdges:s}=ee(lm,cm);return v.useEffect(()=>{const o={nodes:n,edges:s};e?.(o),t.getState().onSelectionChangeHandlers.forEach(i=>i(o))},[n,s,e]),null}const um=e=>!!e.onSelectionChangeHandlers;function fm({onSelectionChange:e}){const t=ee(um);return e||t?r.jsx(dm,{onSelectionChange:e}):null}const wi=[0,0],hm={x:0,y:0,zoom:1},mm=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],_o=[...mm,"rfId"],pm=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),So={translateExtent:jt,nodeOrigin:wi,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function gm(e){const{setNodes:t,setEdges:n,setMinZoom:s,setMaxZoom:o,setTranslateExtent:i,setNodeExtent:a,reset:l,setDefaultNodesAndEdges:u}=ee(pm,oe),c=re();v.useEffect(()=>(u(e.defaultNodes,e.defaultEdges),()=>{f.current=So,l()}),[]);const f=v.useRef(So);return v.useEffect(()=>{for(const d of _o){const h=e[d],p=f.current[d];h!==p&&(typeof e[d]>"u"||(d==="nodes"?t(h):d==="edges"?n(h):d==="minZoom"?s(h):d==="maxZoom"?o(h):d==="translateExtent"?i(h):d==="nodeExtent"?a(h):d==="ariaLabelConfig"?c.setState({ariaLabelConfig:th(h)}):d==="fitView"?c.setState({fitViewQueued:h}):d==="fitViewOptions"?c.setState({fitViewOptions:h}):c.setState({[d]:h})))}f.current=e},_o.map(d=>e[d])),null}function Eo(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function xm(e){const[t,n]=v.useState(e==="system"?null:e);return v.useEffect(()=>{if(e!=="system"){n(e);return}const s=Eo(),o=()=>n(s?.matches?"dark":"light");return o(),s?.addEventListener("change",o),()=>{s?.removeEventListener("change",o)}},[e]),t!==null?t:Eo()?.matches?"dark":"light"}const Mo=typeof document<"u"?document:null;function It(e=null,t={target:Mo,actInsideInputWithModifier:!0}){const[n,s]=v.useState(!1),o=v.useRef(!1),i=v.useRef(new Set([])),[a,l]=v.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),f=c.reduce((d,h)=>d.concat(...h),[]);return[c,f]}return[[],[]]},[e]);return v.useEffect(()=>{const u=t?.target??Mo,c=t?.actInsideInputWithModifier??!0;if(e!==null){const f=p=>{if(o.current=p.ctrlKey||p.metaKey||p.shiftKey||p.altKey,(!o.current||o.current&&!c)&&Jr(p))return!1;const b=$o(p.code,l);if(i.current.add(p[b]),Io(a,i.current,!1)){const w=p.composedPath?.()?.[0]||p.target,x=w?.nodeName==="BUTTON"||w?.nodeName==="A";t.preventDefault!==!1&&(o.current||!x)&&p.preventDefault(),s(!0)}},d=p=>{const g=$o(p.code,l);Io(a,i.current,!0)?(s(!1),i.current.clear()):i.current.delete(p[g]),p.key==="Meta"&&i.current.clear(),o.current=!1},h=()=>{i.current.clear(),s(!1)};return u?.addEventListener("keydown",f),u?.addEventListener("keyup",d),window.addEventListener("blur",h),window.addEventListener("contextmenu",h),()=>{u?.removeEventListener("keydown",f),u?.removeEventListener("keyup",d),window.removeEventListener("blur",h),window.removeEventListener("contextmenu",h)}}},[e,s]),n}function Io(e,t,n){return e.filter(s=>n||s.length===t.size).some(s=>s.every(o=>t.has(o)))}function $o(e,t){return t.includes(e)?"code":"key"}const ym=()=>{const e=re();return v.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:s}=e.getState();return s?s.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[s,o,i],panZoom:a}=e.getState();return a?(await a.setViewport({x:t.x??s,y:t.y??o,zoom:t.zoom??i},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,s]=e.getState().transform;return{x:t,y:n,zoom:s}},setCenter:async(t,n,s)=>e.getState().setCenter(t,n,s),fitBounds:async(t,n)=>{const{width:s,height:o,minZoom:i,maxZoom:a,panZoom:l}=e.getState(),u=bs(t,s,o,i,a,n?.padding??.1);return l?(await l.setViewport(u,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:s,snapGrid:o,snapToGrid:i,domNode:a}=e.getState();if(!a)return t;const{x:l,y:u}=a.getBoundingClientRect(),c={x:t.x-l,y:t.y-u},f=n.snapGrid??o,d=n.snapToGrid??i;return zt(c,s,d,f)},flowToScreenPosition:t=>{const{transform:n,domNode:s}=e.getState();if(!s)return t;const{x:o,y:i}=s.getBoundingClientRect(),a=dn(t,n);return{x:a.x+o,y:a.y+i}}}),[])};function vi(e,t){const n=[],s=new Map,o=[];for(const i of e)if(i.type==="add"){o.push(i);continue}else if(i.type==="remove"||i.type==="replace")s.set(i.id,[i]);else{const a=s.get(i.id);a?a.push(i):s.set(i.id,[i])}for(const i of t){const a=s.get(i.id);if(!a){n.push(i);continue}if(a[0].type==="remove")continue;if(a[0].type==="replace"){n.push({...a[0].item});continue}const l={...i};for(const u of a)bm(u,l);n.push(l)}return o.length&&o.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function bm(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Ni(e,t){return vi(e,t)}function ki(e,t){return vi(e,t)}function Ae(e,t){return{id:e,type:"select",selected:t}}function We(e,t=new Set,n=!1){const s=[];for(const[o,i]of e){const a=t.has(o);!(i.selected===void 0&&!a)&&i.selected!==a&&(n&&(i.selected=a),s.push(Ae(i.id,a)))}return s}function To({items:e=[],lookup:t}){const n=[],s=new Map(e.map(o=>[o.id,o]));for(const[o,i]of e.entries()){const a=t.get(i.id),l=a?.internals?.userNode??a;l!==void 0&&l!==i&&n.push({id:i.id,item:i,type:"replace"}),l===void 0&&n.push({item:i,type:"add",index:o})}for(const[o]of t)s.get(o)===void 0&&n.push({id:o,type:"remove"});return n}function Ao(e){return{id:e.id,type:"remove"}}const Po=e=>Xf(e),wm=e=>Xr(e);function Ci(e){return v.forwardRef(e)}const vm=typeof window<"u"?v.useLayoutEffect:v.useEffect;function Do(e){const[t,n]=v.useState(BigInt(0)),[s]=v.useState(()=>Nm(()=>n(o=>o+BigInt(1))));return vm(()=>{const o=s.get();o.length&&(e(o),s.reset())},[t]),s}function Nm(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const ji=v.createContext(null);function km({children:e}){const t=re(),n=v.useCallback(l=>{const{nodes:u=[],setNodes:c,hasDefaultNodes:f,onNodesChange:d,nodeLookup:h,fitViewQueued:p,onNodesChangeMiddlewareMap:g}=t.getState();let b=u;for(const x of l)b=typeof x=="function"?x(b):x;let w=To({items:b,lookup:h});for(const x of g.values())w=x(w);f&&c(b),w.length>0?d?.(w):p&&window.requestAnimationFrame(()=>{const{fitViewQueued:x,nodes:N,setNodes:m}=t.getState();x&&m(N)})},[]),s=Do(n),o=v.useCallback(l=>{const{edges:u=[],setEdges:c,hasDefaultEdges:f,onEdgesChange:d,edgeLookup:h}=t.getState();let p=u;for(const g of l)p=typeof g=="function"?g(p):g;f?c(p):d&&d(To({items:p,lookup:h}))},[]),i=Do(o),a=v.useMemo(()=>({nodeQueue:s,edgeQueue:i}),[]);return r.jsx(ji.Provider,{value:a,children:e})}function Cm(){const e=v.useContext(ji);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const jm=e=>!!e.panZoom;function jn(){const e=ym(),t=re(),n=Cm(),s=ee(jm),o=v.useMemo(()=>{const i=d=>t.getState().nodeLookup.get(d),a=d=>{n.nodeQueue.push(d)},l=d=>{n.edgeQueue.push(d)},u=d=>{const{nodeLookup:h,nodeOrigin:p}=t.getState(),g=Po(d)?d:h.get(d.id),b=g.parentId?Kr(g.position,g.measured,g.parentId,h,p):g.position,w={...g,position:b,width:g.measured?.width??g.width,height:g.measured?.height??g.height};return tt(w)},c=(d,h,p={replace:!1})=>{a(g=>g.map(b=>{if(b.id===d){const w=typeof h=="function"?h(b):h;return p.replace&&Po(w)?w:{...b,...w}}return b}))},f=(d,h,p={replace:!1})=>{l(g=>g.map(b=>{if(b.id===d){const w=typeof h=="function"?h(b):h;return p.replace&&wm(w)?w:{...b,...w}}return b}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>i(d)?.internals.userNode,getInternalNode:i,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(h=>({...h}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:a,setEdges:l,addNodes:d=>{const h=Array.isArray(d)?d:[d];n.nodeQueue.push(p=>[...p,...h])},addEdges:d=>{const h=Array.isArray(d)?d:[d];n.edgeQueue.push(p=>[...p,...h])},toObject:()=>{const{nodes:d=[],edges:h=[],transform:p}=t.getState(),[g,b,w]=p;return{nodes:d.map(x=>({...x})),edges:h.map(x=>({...x})),viewport:{x:g,y:b,zoom:w}}},deleteElements:async({nodes:d=[],edges:h=[]})=>{const{nodes:p,edges:g,onNodesDelete:b,onEdgesDelete:w,triggerNodeChanges:x,triggerEdgeChanges:N,onDelete:m,onBeforeDelete:y}=t.getState(),{nodes:S,edges:k}=await Gf({nodesToRemove:d,edgesToRemove:h,nodes:p,edges:g,onBeforeDelete:y}),j=k.length>0,E=S.length>0;if(j){const A=k.map(Ao);w?.(k),N(A)}if(E){const A=S.map(Ao);b?.(S),x(A)}return(E||j)&&m?.({nodes:S,edges:k}),{deletedNodes:S,deletedEdges:k}},getIntersectingNodes:(d,h=!0,p)=>{const g=ao(d),b=g?d:u(d),w=p!==void 0;return b?(p||t.getState().nodes).filter(x=>{const N=t.getState().nodeLookup.get(x.id);if(N&&!g&&(x.id===d.id||!N.internals.positionAbsolute))return!1;const m=tt(w?x:N),y=Et(m,b);return h&&y>0||y>=m.width*m.height||y>=b.width*b.height}):[]},isNodeIntersecting:(d,h,p=!0)=>{const b=ao(d)?d:u(d);if(!b)return!1;const w=Et(b,h);return p&&w>0||w>=h.width*h.height||w>=b.width*b.height},updateNode:c,updateNodeData:(d,h,p={replace:!1})=>{c(d,g=>{const b=typeof h=="function"?h(g):h;return p.replace?{...g,data:b}:{...g,data:{...g.data,...b}}},p)},updateEdge:f,updateEdgeData:(d,h,p={replace:!1})=>{f(d,g=>{const b=typeof h=="function"?h(g):h;return p.replace?{...g,data:b}:{...g,data:{...g.data,...b}}},p)},getNodesBounds:d=>{const{nodeLookup:h,nodeOrigin:p}=t.getState();return Yf(d,{nodeLookup:h,nodeOrigin:p})},getHandleConnections:({type:d,id:h,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}-${d}${h?`-${h}`:""}`)?.values()??[]),getNodeConnections:({type:d,handleId:h,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}${d?h?`-${d}-${h}`:`-${d}`:""}`)?.values()??[]),fitView:async d=>{const h=t.getState().fitViewResolver??eh();return t.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:h}),n.nodeQueue.push(p=>[...p]),h.promise}}},[]);return v.useMemo(()=>({...o,...e,viewportInitialized:s}),[s])}const zo=e=>e.selected,_m=typeof window<"u"?window:void 0;function Sm({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=re(),{deleteElements:s}=jn(),o=It(e,{actInsideInputWithModifier:!1}),i=It(t,{target:_m});v.useEffect(()=>{if(o){const{edges:a,nodes:l}=n.getState();s({nodes:l.filter(zo),edges:a.filter(zo)}),n.setState({nodesSelectionActive:!1})}},[o]),v.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function Em(e){const t=re();v.useEffect(()=>{const n=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const s=ws(e.current);(s.height===0||s.width===0)&&t.getState().onError?.("004",ye.error004()),t.setState({width:s.width||500,height:s.height||500})};if(e.current){n(),window.addEventListener("resize",n);const s=new ResizeObserver(()=>n());return s.observe(e.current),()=>{window.removeEventListener("resize",n),s&&e.current&&s.unobserve(e.current)}}},[])}const _n={position:"absolute",width:"100%",height:"100%",top:0,left:0},Mm=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function Im({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:s=!1,panOnScrollSpeed:o=.5,panOnScrollMode:i=Le.Free,zoomOnDoubleClick:a=!0,panOnDrag:l=!0,defaultViewport:u,translateExtent:c,minZoom:f,maxZoom:d,zoomActivationKeyCode:h,preventScrolling:p=!0,children:g,noWheelClassName:b,noPanClassName:w,onViewportChange:x,isControlledViewport:N,paneClickDistance:m,selectionOnDrag:y}){const S=re(),k=v.useRef(null),{userSelectionActive:j,lib:E,connectionInProgress:A}=ee(Mm,oe),H=It(h),T=v.useRef();Em(k);const D=v.useCallback(L=>{x?.({x:L[0],y:L[1],zoom:L[2]}),N||S.setState({transform:L})},[x,N]);return v.useEffect(()=>{if(k.current){T.current=Lh({domNode:k.current,minZoom:f,maxZoom:d,translateExtent:c,viewport:u,onDraggingChange:_=>S.setState({paneDragging:_}),onPanZoomStart:(_,I)=>{const{onViewportChangeStart:$,onMoveStart:P}=S.getState();P?.(_,I),$?.(I)},onPanZoom:(_,I)=>{const{onViewportChange:$,onMove:P}=S.getState();P?.(_,I),$?.(I)},onPanZoomEnd:(_,I)=>{const{onViewportChangeEnd:$,onMoveEnd:P}=S.getState();P?.(_,I),$?.(I)}});const{x:L,y:C,zoom:M}=T.current.getViewport();return S.setState({panZoom:T.current,transform:[L,C,M],domNode:k.current.closest(".react-flow")}),()=>{T.current?.destroy()}}},[]),v.useEffect(()=>{T.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:s,panOnScrollSpeed:o,panOnScrollMode:i,zoomOnDoubleClick:a,panOnDrag:l,zoomActivationKeyPressed:H,preventScrolling:p,noPanClassName:w,userSelectionActive:j,noWheelClassName:b,lib:E,onTransformChange:D,connectionInProgress:A,selectionOnDrag:y,paneClickDistance:m})},[e,t,n,s,o,i,a,l,H,p,w,j,b,E,D,A,y,m]),r.jsx("div",{className:"react-flow__renderer",ref:k,style:_n,children:g})}const $m=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Tm(){const{userSelectionActive:e,userSelectionRect:t}=ee($m,oe);return e&&t?r.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Fn=(e,t)=>n=>{n.target===t.current&&e?.(n)},Am=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Pm({isSelecting:e,selectionKeyPressed:t,selectionMode:n=_t.Full,panOnDrag:s,paneClickDistance:o,selectionOnDrag:i,onSelectionStart:a,onSelectionEnd:l,onPaneClick:u,onPaneContextMenu:c,onPaneScroll:f,onPaneMouseEnter:d,onPaneMouseMove:h,onPaneMouseLeave:p,children:g}){const b=re(),{userSelectionActive:w,elementsSelectable:x,dragging:N,connectionInProgress:m}=ee(Am,oe),y=x&&(e||w),S=v.useRef(null),k=v.useRef(),j=v.useRef(new Set),E=v.useRef(new Set),A=v.useRef(!1),H=$=>{if(A.current||m){A.current=!1;return}u?.($),b.getState().resetSelectedElements(),b.setState({nodesSelectionActive:!1})},T=$=>{if(Array.isArray(s)&&s?.includes(2)){$.preventDefault();return}c?.($)},D=f?$=>f($):void 0,L=$=>{A.current&&($.stopPropagation(),A.current=!1)},C=$=>{const{domNode:P}=b.getState();if(k.current=P?.getBoundingClientRect(),!k.current)return;const z=$.target===S.current;if(!z&&!!$.target.closest(".nokey")||!e||!(i&&z||t)||$.button!==0||!$.isPrimary)return;$.target?.setPointerCapture?.($.pointerId),A.current=!1;const{x:F,y:q}=me($.nativeEvent,k.current);b.setState({userSelectionRect:{width:0,height:0,startX:F,startY:q,x:F,y:q}}),z||($.stopPropagation(),$.preventDefault())},M=$=>{const{userSelectionRect:P,transform:z,nodeLookup:O,edgeLookup:R,connectionLookup:F,triggerNodeChanges:q,triggerEdgeChanges:Z,defaultEdgeOptions:U,resetSelectedElements:Q}=b.getState();if(!k.current||!P)return;const{x:V,y:B}=me($.nativeEvent,k.current),{startX:X,startY:J}=P;if(!A.current){const ne=t?0:o;if(Math.hypot(V-X,B-J)<=ne)return;Q(),a?.($)}A.current=!0;const G={startX:X,startY:J,x:V<X?V:X,y:B<J?B:J,width:Math.abs(V-X),height:Math.abs(B-J)},K=j.current,te=E.current;j.current=new Set(ys(O,G,z,n===_t.Partial,!0).map(ne=>ne.id)),E.current=new Set;const se=U?.selectable??!0;for(const ne of j.current){const ae=F.get(ne);if(ae)for(const{edgeId:Se}of ae.values()){const we=R.get(Se);we&&(we.selectable??se)&&E.current.add(Se)}}if(!lo(K,j.current)){const ne=We(O,j.current,!0);q(ne)}if(!lo(te,E.current)){const ne=We(R,E.current);Z(ne)}b.setState({userSelectionRect:G,userSelectionActive:!0,nodesSelectionActive:!1})},_=$=>{$.button===0&&($.target?.releasePointerCapture?.($.pointerId),!w&&$.target===S.current&&b.getState().userSelectionRect&&H?.($),b.setState({userSelectionActive:!1,userSelectionRect:null}),A.current&&(l?.($),b.setState({nodesSelectionActive:j.current.size>0})))},I=s===!0||Array.isArray(s)&&s.includes(0);return r.jsxs("div",{className:ie(["react-flow__pane",{draggable:I,dragging:N,selection:e}]),onClick:y?void 0:Fn(H,S),onContextMenu:Fn(T,S),onWheel:Fn(D,S),onPointerEnter:y?void 0:d,onPointerMove:y?M:h,onPointerUp:y?_:void 0,onPointerDownCapture:y?C:void 0,onClickCapture:y?L:void 0,onPointerLeave:p,ref:S,style:_n,children:[g,r.jsx(Tm,{})]})}function is({id:e,store:t,unselect:n=!1,nodeRef:s}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:a,nodeLookup:l,onError:u}=t.getState(),c=l.get(e);if(!c){u?.("012",ye.error012(e));return}t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&a)&&(i({nodes:[c],edges:[]}),requestAnimationFrame(()=>s?.current?.blur())):o([e])}function _i({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:s,nodeId:o,isSelectable:i,nodeClickDistance:a}){const l=re(),[u,c]=v.useState(!1),f=v.useRef();return v.useEffect(()=>{f.current=kh({getStoreItems:()=>l.getState(),onNodeMouseDown:d=>{is({id:d,store:l,nodeRef:e})},onDragStart:()=>{c(!0)},onDragStop:()=>{c(!1)}})},[]),v.useEffect(()=>{if(t)f.current?.destroy();else if(e.current)return f.current?.update({noDragClassName:n,handleSelector:s,domNode:e.current,isSelectable:i,nodeId:o,nodeClickDistance:a}),()=>{f.current?.destroy()}},[n,s,t,i,e,o]),u}const Dm=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Si(){const e=re();return v.useCallback(n=>{const{nodeExtent:s,snapToGrid:o,snapGrid:i,nodesDraggable:a,onError:l,updateNodePositions:u,nodeLookup:c,nodeOrigin:f}=e.getState(),d=new Map,h=Dm(a),p=o?i[0]:5,g=o?i[1]:5,b=n.direction.x*p*n.factor,w=n.direction.y*g*n.factor;for(const[,x]of c){if(!h(x))continue;let N={x:x.internals.positionAbsolute.x+b,y:x.internals.positionAbsolute.y+w};o&&(N=Dt(N,i));const{position:m,positionAbsolute:y}=Yr({nodeId:x.id,nextPosition:N,nodeLookup:c,nodeExtent:s,nodeOrigin:f,onError:l});x.position=m,x.internals.positionAbsolute=y,d.set(x.id,x)}u(d)},[])}const _s=v.createContext(null),zm=_s.Provider;_s.Consumer;const Ei=()=>v.useContext(_s),Lm=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Rm=(e,t,n)=>s=>{const{connectionClickStartHandle:o,connectionMode:i,connection:a}=s,{fromHandle:l,toHandle:u,isValid:c}=a,f=u?.nodeId===e&&u?.id===t&&u?.type===n;return{connectingFrom:l?.nodeId===e&&l?.id===t&&l?.type===n,connectingTo:f,clickConnecting:o?.nodeId===e&&o?.id===t&&o?.type===n,isPossibleEndHandle:i===Je.Strict?l?.type!==n:e!==l?.nodeId||t!==l?.id,connectionInProcess:!!l,clickConnectionInProcess:!!o,valid:f&&c}};function Hm({type:e="source",position:t=W.Top,isValidConnection:n,isConnectable:s=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:a,onConnect:l,children:u,className:c,onMouseDown:f,onTouchStart:d,...h},p){const g=a||null,b=e==="target",w=re(),x=Ei(),{connectOnClick:N,noPanClassName:m,rfId:y}=ee(Lm,oe),{connectingFrom:S,connectingTo:k,clickConnecting:j,isPossibleEndHandle:E,connectionInProcess:A,clickConnectionInProcess:H,valid:T}=ee(Rm(x,g,e),oe);x||w.getState().onError?.("010",ye.error010());const D=M=>{const{defaultEdgeOptions:_,onConnect:I,hasDefaultEdges:$}=w.getState(),P={..._,...M};if($){const{edges:z,setEdges:O}=w.getState();O(ah(P,z))}I?.(P),l?.(P)},L=M=>{if(!x)return;const _=ei(M.nativeEvent);if(o&&(_&&M.button===0||!_)){const I=w.getState();rs.onPointerDown(M.nativeEvent,{handleDomNode:M.currentTarget,autoPanOnConnect:I.autoPanOnConnect,connectionMode:I.connectionMode,connectionRadius:I.connectionRadius,domNode:I.domNode,nodeLookup:I.nodeLookup,lib:I.lib,isTarget:b,handleId:g,nodeId:x,flowId:I.rfId,panBy:I.panBy,cancelConnection:I.cancelConnection,onConnectStart:I.onConnectStart,onConnectEnd:I.onConnectEnd,updateConnection:I.updateConnection,onConnect:D,isValidConnection:n||I.isValidConnection,getTransform:()=>w.getState().transform,getFromHandle:()=>w.getState().connection.fromHandle,autoPanSpeed:I.autoPanSpeed,dragThreshold:I.connectionDragThreshold})}_?f?.(M):d?.(M)},C=M=>{const{onClickConnectStart:_,onClickConnectEnd:I,connectionClickStartHandle:$,connectionMode:P,isValidConnection:z,lib:O,rfId:R,nodeLookup:F,connection:q}=w.getState();if(!x||!$&&!o)return;if(!$){_?.(M.nativeEvent,{nodeId:x,handleId:g,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:x,type:e,id:g}});return}const Z=Ur(M.target),U=n||z,{connection:Q,isValid:V}=rs.isValid(M.nativeEvent,{handle:{nodeId:x,id:g,type:e},connectionMode:P,fromNodeId:$.nodeId,fromHandleId:$.id||null,fromType:$.type,isValidConnection:U,flowId:R,doc:Z,lib:O,nodeLookup:F});V&&Q&&D(Q);const B=structuredClone(q);delete B.inProgress,B.toPosition=B.toHandle?B.toHandle.position:null,I?.(M,B),w.setState({connectionClickStartHandle:null})};return r.jsx("div",{"data-handleid":g,"data-nodeid":x,"data-handlepos":t,"data-id":`${y}-${x}-${g}-${e}`,className:ie(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",m,c,{source:!b,target:b,connectable:s,connectablestart:o,connectableend:i,clickconnecting:j,connectingfrom:S,connectingto:k,valid:T,connectionindicator:s&&(!A||E)&&(A||H?i:o)}]),onMouseDown:L,onTouchStart:L,onClick:N?C:void 0,ref:p,...h,children:u})}const ot=v.memo(Ci(Hm));function Om({data:e,isConnectable:t,sourcePosition:n=W.Bottom}){return r.jsxs(r.Fragment,{children:[e?.label,r.jsx(ot,{type:"source",position:n,isConnectable:t})]})}function Bm({data:e,isConnectable:t,targetPosition:n=W.Top,sourcePosition:s=W.Bottom}){return r.jsxs(r.Fragment,{children:[r.jsx(ot,{type:"target",position:n,isConnectable:t}),e?.label,r.jsx(ot,{type:"source",position:s,isConnectable:t})]})}function Vm(){return null}function Fm({data:e,isConnectable:t,targetPosition:n=W.Top}){return r.jsxs(r.Fragment,{children:[r.jsx(ot,{type:"target",position:n,isConnectable:t}),e?.label]})}const un={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Lo={input:Om,default:Bm,output:Fm,group:Vm};function qm(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const Xm=e=>{const{width:t,height:n,x:s,y:o}=Pt(e.nodeLookup,{filter:i=>!!i.selected});return{width:he(t)?t:null,height:he(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${s}px,${o}px)`}};function Ym({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const s=re(),{width:o,height:i,transformString:a,userSelectionActive:l}=ee(Xm,oe),u=Si(),c=v.useRef(null);if(v.useEffect(()=>{n||c.current?.focus({preventScroll:!0})},[n]),_i({nodeRef:c}),l||!o||!i)return null;const f=e?h=>{const p=s.getState().nodes.filter(g=>g.selected);e(h,p)}:void 0,d=h=>{Object.prototype.hasOwnProperty.call(un,h.key)&&(h.preventDefault(),u({direction:un[h.key],factor:h.shiftKey?4:1}))};return r.jsx("div",{className:ie(["react-flow__nodesselection","react-flow__container",t]),style:{transform:a},children:r.jsx("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:o,height:i}})})}const Ro=typeof window<"u"?window:void 0,Zm=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Mi({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:a,paneClickDistance:l,deleteKeyCode:u,selectionKeyCode:c,selectionOnDrag:f,selectionMode:d,onSelectionStart:h,onSelectionEnd:p,multiSelectionKeyCode:g,panActivationKeyCode:b,zoomActivationKeyCode:w,elementsSelectable:x,zoomOnScroll:N,zoomOnPinch:m,panOnScroll:y,panOnScrollSpeed:S,panOnScrollMode:k,zoomOnDoubleClick:j,panOnDrag:E,defaultViewport:A,translateExtent:H,minZoom:T,maxZoom:D,preventScrolling:L,onSelectionContextMenu:C,noWheelClassName:M,noPanClassName:_,disableKeyboardA11y:I,onViewportChange:$,isControlledViewport:P}){const{nodesSelectionActive:z,userSelectionActive:O}=ee(Zm,oe),R=It(c,{target:Ro}),F=It(b,{target:Ro}),q=F||E,Z=F||y,U=f&&q!==!0,Q=R||O||U;return Sm({deleteKeyCode:u,multiSelectionKeyCode:g}),r.jsx(Im,{onPaneContextMenu:i,elementsSelectable:x,zoomOnScroll:N,zoomOnPinch:m,panOnScroll:Z,panOnScrollSpeed:S,panOnScrollMode:k,zoomOnDoubleClick:j,panOnDrag:!R&&q,defaultViewport:A,translateExtent:H,minZoom:T,maxZoom:D,zoomActivationKeyCode:w,preventScrolling:L,noWheelClassName:M,noPanClassName:_,onViewportChange:$,isControlledViewport:P,paneClickDistance:l,selectionOnDrag:U,children:r.jsxs(Pm,{onSelectionStart:h,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:a,panOnDrag:q,isSelecting:!!Q,selectionMode:d,selectionKeyPressed:R,paneClickDistance:l,selectionOnDrag:U,children:[e,z&&r.jsx(Ym,{onSelectionContextMenu:C,noPanClassName:_,disableKeyboardA11y:I})]})})}Mi.displayName="FlowRenderer";const Wm=v.memo(Mi),Qm=e=>t=>e?ys(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Gm(e){return ee(v.useCallback(Qm(e),[e]),oe)}const Km=e=>e.updateNodeInternals;function Um(){const e=ee(Km),[t]=v.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const s=new Map;n.forEach(o=>{const i=o.target.getAttribute("data-id");s.set(i,{id:i,nodeElement:o.target,force:!0})}),e(s)}));return v.useEffect(()=>()=>{t?.disconnect()},[t]),t}function Jm({node:e,nodeType:t,hasDimensions:n,resizeObserver:s}){const o=re(),i=v.useRef(null),a=v.useRef(null),l=v.useRef(e.sourcePosition),u=v.useRef(e.targetPosition),c=v.useRef(t),f=n&&!!e.internals.handleBounds;return v.useEffect(()=>{i.current&&!e.hidden&&(!f||a.current!==i.current)&&(a.current&&s?.unobserve(a.current),s?.observe(i.current),a.current=i.current)},[f,e.hidden]),v.useEffect(()=>()=>{a.current&&(s?.unobserve(a.current),a.current=null)},[]),v.useEffect(()=>{if(i.current){const d=c.current!==t,h=l.current!==e.sourcePosition,p=u.current!==e.targetPosition;(d||h||p)&&(c.current=t,l.current=e.sourcePosition,u.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function ep({id:e,onClick:t,onMouseEnter:n,onMouseMove:s,onMouseLeave:o,onContextMenu:i,onDoubleClick:a,nodesDraggable:l,elementsSelectable:u,nodesConnectable:c,nodesFocusable:f,resizeObserver:d,noDragClassName:h,noPanClassName:p,disableKeyboardA11y:g,rfId:b,nodeTypes:w,nodeClickDistance:x,onError:N}){const{node:m,internals:y,isParent:S}=ee(V=>{const B=V.nodeLookup.get(e),X=V.parentLookup.has(e);return{node:B,internals:B.internals,isParent:X}},oe);let k=m.type||"default",j=w?.[k]||Lo[k];j===void 0&&(N?.("003",ye.error003(k)),k="default",j=w?.default||Lo.default);const E=!!(m.draggable||l&&typeof m.draggable>"u"),A=!!(m.selectable||u&&typeof m.selectable>"u"),H=!!(m.connectable||c&&typeof m.connectable>"u"),T=!!(m.focusable||f&&typeof m.focusable>"u"),D=re(),L=Gr(m),C=Jm({node:m,nodeType:k,hasDimensions:L,resizeObserver:d}),M=_i({nodeRef:C,disabled:m.hidden||!E,noDragClassName:h,handleSelector:m.dragHandle,nodeId:e,isSelectable:A,nodeClickDistance:x}),_=Si();if(m.hidden)return null;const I=_e(m),$=qm(m),P=A||E||t||n||s||o,z=n?V=>n(V,{...y.userNode}):void 0,O=s?V=>s(V,{...y.userNode}):void 0,R=o?V=>o(V,{...y.userNode}):void 0,F=i?V=>i(V,{...y.userNode}):void 0,q=a?V=>a(V,{...y.userNode}):void 0,Z=V=>{const{selectNodesOnDrag:B,nodeDragThreshold:X}=D.getState();A&&(!B||!E||X>0)&&is({id:e,store:D,nodeRef:C}),t&&t(V,{...y.userNode})},U=V=>{if(!(Jr(V.nativeEvent)||g)){if(Br.includes(V.key)&&A){const B=V.key==="Escape";is({id:e,store:D,unselect:B,nodeRef:C})}else if(E&&m.selected&&Object.prototype.hasOwnProperty.call(un,V.key)){V.preventDefault();const{ariaLabelConfig:B}=D.getState();D.setState({ariaLiveMessage:B["node.a11yDescription.ariaLiveMessage"]({direction:V.key.replace("Arrow","").toLowerCase(),x:~~y.positionAbsolute.x,y:~~y.positionAbsolute.y})}),_({direction:un[V.key],factor:V.shiftKey?4:1})}}},Q=()=>{if(g||!C.current?.matches(":focus-visible"))return;const{transform:V,width:B,height:X,autoPanOnNodeFocus:J,setCenter:G}=D.getState();if(!J)return;ys(new Map([[e,m]]),{x:0,y:0,width:B,height:X},V,!0).length>0||G(m.position.x+I.width/2,m.position.y+I.height/2,{zoom:V[2]})};return r.jsx("div",{className:ie(["react-flow__node",`react-flow__node-${k}`,{[p]:E},m.className,{selected:m.selected,selectable:A,parent:S,draggable:E,dragging:M}]),ref:C,style:{zIndex:y.z,transform:`translate(${y.positionAbsolute.x}px,${y.positionAbsolute.y}px)`,pointerEvents:P?"all":"none",visibility:L?"visible":"hidden",...m.style,...$},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:z,onMouseMove:O,onMouseLeave:R,onContextMenu:F,onClick:Z,onDoubleClick:q,onKeyDown:T?U:void 0,tabIndex:T?0:void 0,onFocus:T?Q:void 0,role:m.ariaRole??(T?"group":void 0),"aria-roledescription":"node","aria-describedby":g?void 0:`${yi}-${b}`,"aria-label":m.ariaLabel,...m.domAttributes,children:r.jsx(zm,{value:e,children:r.jsx(j,{id:e,data:m.data,type:k,positionAbsoluteX:y.positionAbsolute.x,positionAbsoluteY:y.positionAbsolute.y,selected:m.selected??!1,selectable:A,draggable:E,deletable:m.deletable??!0,isConnectable:H,sourcePosition:m.sourcePosition,targetPosition:m.targetPosition,dragging:M,dragHandle:m.dragHandle,zIndex:y.z,parentId:m.parentId,...I})})})}var tp=v.memo(ep);const np=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Ii(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:s,elementsSelectable:o,onError:i}=ee(np,oe),a=Gm(e.onlyRenderVisibleElements),l=Um();return r.jsx("div",{className:"react-flow__nodes",style:_n,children:a.map(u=>r.jsx(tp,{id:u,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:l,nodesDraggable:t,nodesConnectable:n,nodesFocusable:s,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:i},u))})}Ii.displayName="NodeRenderer";const sp=v.memo(Ii);function op(e){return ee(v.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const s=[];if(n.width&&n.height)for(const o of n.edges){const i=n.nodeLookup.get(o.source),a=n.nodeLookup.get(o.target);i&&a&&oh({sourceNode:i,targetNode:a,width:n.width,height:n.height,transform:n.transform})&&s.push(o.id)}return s},[e]),oe)}const rp=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return r.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},ip=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return r.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Ho={[St.Arrow]:rp,[St.ArrowClosed]:ip};function ap(e){const t=re();return v.useMemo(()=>Object.prototype.hasOwnProperty.call(Ho,e)?Ho[e]:(t.getState().onError?.("009",ye.error009(e)),null),[e])}const lp=({id:e,type:t,color:n,width:s=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:a,orient:l="auto-start-reverse"})=>{const u=ap(t);return u?r.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${s}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:l,refX:"0",refY:"0",children:r.jsx(u,{color:n,strokeWidth:a})}):null},$i=({defaultColor:e,rfId:t})=>{const n=ee(i=>i.edges),s=ee(i=>i.defaultEdgeOptions),o=v.useMemo(()=>fh(n,{id:t,defaultColor:e,defaultMarkerStart:s?.markerStart,defaultMarkerEnd:s?.markerEnd}),[n,s,t,e]);return o.length?r.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:r.jsx("defs",{children:o.map(i=>r.jsx(lp,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};$i.displayName="MarkerDefinitions";var cp=v.memo($i);function Ti({x:e,y:t,label:n,labelStyle:s,labelShowBg:o=!0,labelBgStyle:i,labelBgPadding:a=[2,4],labelBgBorderRadius:l=2,children:u,className:c,...f}){const[d,h]=v.useState({x:1,y:0,width:0,height:0}),p=ie(["react-flow__edge-textwrapper",c]),g=v.useRef(null);return v.useEffect(()=>{if(g.current){const b=g.current.getBBox();h({x:b.x,y:b.y,width:b.width,height:b.height})}},[n]),n?r.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:p,visibility:d.width?"visible":"hidden",...f,children:[o&&r.jsx("rect",{width:d.width+2*a[0],x:-a[0],y:-a[1],height:d.height+2*a[1],className:"react-flow__edge-textbg",style:i,rx:l,ry:l}),r.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:g,style:s,children:n}),u]}):null}Ti.displayName="EdgeText";const dp=v.memo(Ti);function Sn({path:e,labelX:t,labelY:n,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,interactionWidth:c=20,...f}){return r.jsxs(r.Fragment,{children:[r.jsx("path",{...f,d:e,fill:"none",className:ie(["react-flow__edge-path",f.className])}),c?r.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:c,className:"react-flow__edge-interaction"}):null,s&&he(t)&&he(n)?r.jsx(dp,{x:t,y:n,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u}):null]})}function Oo({pos:e,x1:t,y1:n,x2:s,y2:o}){return e===W.Left||e===W.Right?[.5*(t+s),n]:[t,.5*(n+o)]}function Ai({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:s,targetY:o,targetPosition:i=W.Top}){const[a,l]=Oo({pos:n,x1:e,y1:t,x2:s,y2:o}),[u,c]=Oo({pos:i,x1:s,y1:o,x2:e,y2:t}),[f,d,h,p]=ti({sourceX:e,sourceY:t,targetX:s,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:u,targetControlY:c});return[`M${e},${t} C${a},${l} ${u},${c} ${s},${o}`,f,d,h,p]}function Pi(e){return v.memo(({id:t,sourceX:n,sourceY:s,targetX:o,targetY:i,sourcePosition:a,targetPosition:l,label:u,labelStyle:c,labelShowBg:f,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:p,style:g,markerEnd:b,markerStart:w,interactionWidth:x})=>{const[N,m,y]=Ai({sourceX:n,sourceY:s,sourcePosition:a,targetX:o,targetY:i,targetPosition:l}),S=e.isInternal?void 0:t;return r.jsx(Sn,{id:S,path:N,labelX:m,labelY:y,label:u,labelStyle:c,labelShowBg:f,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:p,style:g,markerEnd:b,markerStart:w,interactionWidth:x})})}const up=Pi({isInternal:!1}),Di=Pi({isInternal:!0});up.displayName="SimpleBezierEdge";Di.displayName="SimpleBezierEdgeInternal";function zi(e){return v.memo(({id:t,sourceX:n,sourceY:s,targetX:o,targetY:i,label:a,labelStyle:l,labelShowBg:u,labelBgStyle:c,labelBgPadding:f,labelBgBorderRadius:d,style:h,sourcePosition:p=W.Bottom,targetPosition:g=W.Top,markerEnd:b,markerStart:w,pathOptions:x,interactionWidth:N})=>{const[m,y,S]=ns({sourceX:n,sourceY:s,sourcePosition:p,targetX:o,targetY:i,targetPosition:g,borderRadius:x?.borderRadius,offset:x?.offset,stepPosition:x?.stepPosition}),k=e.isInternal?void 0:t;return r.jsx(Sn,{id:k,path:m,labelX:y,labelY:S,label:a,labelStyle:l,labelShowBg:u,labelBgStyle:c,labelBgPadding:f,labelBgBorderRadius:d,style:h,markerEnd:b,markerStart:w,interactionWidth:N})})}const Li=zi({isInternal:!1}),Ri=zi({isInternal:!0});Li.displayName="SmoothStepEdge";Ri.displayName="SmoothStepEdgeInternal";function Hi(e){return v.memo(({id:t,...n})=>{const s=e.isInternal?void 0:t;return r.jsx(Li,{...n,id:s,pathOptions:v.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const fp=Hi({isInternal:!1}),Oi=Hi({isInternal:!0});fp.displayName="StepEdge";Oi.displayName="StepEdgeInternal";function Bi(e){return v.memo(({id:t,sourceX:n,sourceY:s,targetX:o,targetY:i,label:a,labelStyle:l,labelShowBg:u,labelBgStyle:c,labelBgPadding:f,labelBgBorderRadius:d,style:h,markerEnd:p,markerStart:g,interactionWidth:b})=>{const[w,x,N]=oi({sourceX:n,sourceY:s,targetX:o,targetY:i}),m=e.isInternal?void 0:t;return r.jsx(Sn,{id:m,path:w,labelX:x,labelY:N,label:a,labelStyle:l,labelShowBg:u,labelBgStyle:c,labelBgPadding:f,labelBgBorderRadius:d,style:h,markerEnd:p,markerStart:g,interactionWidth:b})})}const hp=Bi({isInternal:!1}),Vi=Bi({isInternal:!0});hp.displayName="StraightEdge";Vi.displayName="StraightEdgeInternal";function Fi(e){return v.memo(({id:t,sourceX:n,sourceY:s,targetX:o,targetY:i,sourcePosition:a=W.Bottom,targetPosition:l=W.Top,label:u,labelStyle:c,labelShowBg:f,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:p,style:g,markerEnd:b,markerStart:w,pathOptions:x,interactionWidth:N})=>{const[m,y,S]=ni({sourceX:n,sourceY:s,sourcePosition:a,targetX:o,targetY:i,targetPosition:l,curvature:x?.curvature}),k=e.isInternal?void 0:t;return r.jsx(Sn,{id:k,path:m,labelX:y,labelY:S,label:u,labelStyle:c,labelShowBg:f,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:p,style:g,markerEnd:b,markerStart:w,interactionWidth:N})})}const mp=Fi({isInternal:!1}),qi=Fi({isInternal:!0});mp.displayName="BezierEdge";qi.displayName="BezierEdgeInternal";const Bo={default:qi,straight:Vi,step:Oi,smoothstep:Ri,simplebezier:Di},Vo={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},pp=(e,t,n)=>n===W.Left?e-t:n===W.Right?e+t:e,gp=(e,t,n)=>n===W.Top?e-t:n===W.Bottom?e+t:e,Fo="react-flow__edgeupdater";function qo({position:e,centerX:t,centerY:n,radius:s=10,onMouseDown:o,onMouseEnter:i,onMouseOut:a,type:l}){return r.jsx("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:a,className:ie([Fo,`${Fo}-${l}`]),cx:pp(t,s,e),cy:gp(n,s,e),r:s,stroke:"transparent",fill:"transparent"})}function xp({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:s,sourceY:o,targetX:i,targetY:a,sourcePosition:l,targetPosition:u,onReconnect:c,onReconnectStart:f,onReconnectEnd:d,setReconnecting:h,setUpdateHover:p}){const g=re(),b=(y,S)=>{if(y.button!==0)return;const{autoPanOnConnect:k,domNode:j,isValidConnection:E,connectionMode:A,connectionRadius:H,lib:T,onConnectStart:D,onConnectEnd:L,cancelConnection:C,nodeLookup:M,rfId:_,panBy:I,updateConnection:$}=g.getState(),P=S.type==="target",z=(F,q)=>{h(!1),d?.(F,n,S.type,q)},O=F=>c?.(n,F),R=(F,q)=>{h(!0),f?.(y,n,S.type),D?.(F,q)};rs.onPointerDown(y.nativeEvent,{autoPanOnConnect:k,connectionMode:A,connectionRadius:H,domNode:j,handleId:S.id,nodeId:S.nodeId,nodeLookup:M,isTarget:P,edgeUpdaterType:S.type,lib:T,flowId:_,cancelConnection:C,panBy:I,isValidConnection:E,onConnect:O,onConnectStart:R,onConnectEnd:L,onReconnectEnd:z,updateConnection:$,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,dragThreshold:g.getState().connectionDragThreshold,handleDomNode:y.currentTarget})},w=y=>b(y,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),x=y=>b(y,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),N=()=>p(!0),m=()=>p(!1);return r.jsxs(r.Fragment,{children:[(e===!0||e==="source")&&r.jsx(qo,{position:l,centerX:s,centerY:o,radius:t,onMouseDown:w,onMouseEnter:N,onMouseOut:m,type:"source"}),(e===!0||e==="target")&&r.jsx(qo,{position:u,centerX:i,centerY:a,radius:t,onMouseDown:x,onMouseEnter:N,onMouseOut:m,type:"target"})]})}function yp({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:s,onClick:o,onDoubleClick:i,onContextMenu:a,onMouseEnter:l,onMouseMove:u,onMouseLeave:c,reconnectRadius:f,onReconnect:d,onReconnectStart:h,onReconnectEnd:p,rfId:g,edgeTypes:b,noPanClassName:w,onError:x,disableKeyboardA11y:N}){let m=ee(G=>G.edgeLookup.get(e));const y=ee(G=>G.defaultEdgeOptions);m=y?{...y,...m}:m;let S=m.type||"default",k=b?.[S]||Bo[S];k===void 0&&(x?.("011",ye.error011(S)),S="default",k=b?.default||Bo.default);const j=!!(m.focusable||t&&typeof m.focusable>"u"),E=typeof d<"u"&&(m.reconnectable||n&&typeof m.reconnectable>"u"),A=!!(m.selectable||s&&typeof m.selectable>"u"),H=v.useRef(null),[T,D]=v.useState(!1),[L,C]=v.useState(!1),M=re(),{zIndex:_,sourceX:I,sourceY:$,targetX:P,targetY:z,sourcePosition:O,targetPosition:R}=ee(v.useCallback(G=>{const K=G.nodeLookup.get(m.source),te=G.nodeLookup.get(m.target);if(!K||!te)return{zIndex:m.zIndex,...Vo};const se=uh({id:e,sourceNode:K,targetNode:te,sourceHandle:m.sourceHandle||null,targetHandle:m.targetHandle||null,connectionMode:G.connectionMode,onError:x});return{zIndex:sh({selected:m.selected,zIndex:m.zIndex,sourceNode:K,targetNode:te,elevateOnSelect:G.elevateEdgesOnSelect,zIndexMode:G.zIndexMode}),...se||Vo}},[m.source,m.target,m.sourceHandle,m.targetHandle,m.selected,m.zIndex]),oe),F=v.useMemo(()=>m.markerStart?`url('#${ss(m.markerStart,g)}')`:void 0,[m.markerStart,g]),q=v.useMemo(()=>m.markerEnd?`url('#${ss(m.markerEnd,g)}')`:void 0,[m.markerEnd,g]);if(m.hidden||I===null||$===null||P===null||z===null)return null;const Z=G=>{const{addSelectedEdges:K,unselectNodesAndEdges:te,multiSelectionActive:se}=M.getState();A&&(M.setState({nodesSelectionActive:!1}),m.selected&&se?(te({nodes:[],edges:[m]}),H.current?.blur()):K([e])),o&&o(G,m)},U=i?G=>{i(G,{...m})}:void 0,Q=a?G=>{a(G,{...m})}:void 0,V=l?G=>{l(G,{...m})}:void 0,B=u?G=>{u(G,{...m})}:void 0,X=c?G=>{c(G,{...m})}:void 0,J=G=>{if(!N&&Br.includes(G.key)&&A){const{unselectNodesAndEdges:K,addSelectedEdges:te}=M.getState();G.key==="Escape"?(H.current?.blur(),K({edges:[m]})):te([e])}};return r.jsx("svg",{style:{zIndex:_},children:r.jsxs("g",{className:ie(["react-flow__edge",`react-flow__edge-${S}`,m.className,w,{selected:m.selected,animated:m.animated,inactive:!A&&!o,updating:T,selectable:A}]),onClick:Z,onDoubleClick:U,onContextMenu:Q,onMouseEnter:V,onMouseMove:B,onMouseLeave:X,onKeyDown:j?J:void 0,tabIndex:j?0:void 0,role:m.ariaRole??(j?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":m.ariaLabel===null?void 0:m.ariaLabel||`Edge from ${m.source} to ${m.target}`,"aria-describedby":j?`${bi}-${g}`:void 0,ref:H,...m.domAttributes,children:[!L&&r.jsx(k,{id:e,source:m.source,target:m.target,type:m.type,selected:m.selected,animated:m.animated,selectable:A,deletable:m.deletable??!0,label:m.label,labelStyle:m.labelStyle,labelShowBg:m.labelShowBg,labelBgStyle:m.labelBgStyle,labelBgPadding:m.labelBgPadding,labelBgBorderRadius:m.labelBgBorderRadius,sourceX:I,sourceY:$,targetX:P,targetY:z,sourcePosition:O,targetPosition:R,data:m.data,style:m.style,sourceHandleId:m.sourceHandle,targetHandleId:m.targetHandle,markerStart:F,markerEnd:q,pathOptions:"pathOptions"in m?m.pathOptions:void 0,interactionWidth:m.interactionWidth}),E&&r.jsx(xp,{edge:m,isReconnectable:E,reconnectRadius:f,onReconnect:d,onReconnectStart:h,onReconnectEnd:p,sourceX:I,sourceY:$,targetX:P,targetY:z,sourcePosition:O,targetPosition:R,setUpdateHover:D,setReconnecting:C})]})})}var bp=v.memo(yp);const wp=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Xi({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:s,noPanClassName:o,onReconnect:i,onEdgeContextMenu:a,onEdgeMouseEnter:l,onEdgeMouseMove:u,onEdgeMouseLeave:c,onEdgeClick:f,reconnectRadius:d,onEdgeDoubleClick:h,onReconnectStart:p,onReconnectEnd:g,disableKeyboardA11y:b}){const{edgesFocusable:w,edgesReconnectable:x,elementsSelectable:N,onError:m}=ee(wp,oe),y=op(t);return r.jsxs("div",{className:"react-flow__edges",children:[r.jsx(cp,{defaultColor:e,rfId:n}),y.map(S=>r.jsx(bp,{id:S,edgesFocusable:w,edgesReconnectable:x,elementsSelectable:N,noPanClassName:o,onReconnect:i,onContextMenu:a,onMouseEnter:l,onMouseMove:u,onMouseLeave:c,onClick:f,reconnectRadius:d,onDoubleClick:h,onReconnectStart:p,onReconnectEnd:g,rfId:n,onError:m,edgeTypes:s,disableKeyboardA11y:b},S))]})}Xi.displayName="EdgeRenderer";const vp=v.memo(Xi),Np=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function kp({children:e}){const t=ee(Np);return r.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Cp(e){const t=jn(),n=v.useRef(!1);v.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const jp=e=>e.panZoom?.syncViewport;function _p(e){const t=ee(jp),n=re();return v.useEffect(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Sp(e){return e.connection.inProgress?{...e.connection,to:zt(e.connection.to,e.transform)}:{...e.connection}}function Ep(e){return Sp}function Mp(e){const t=Ep();return ee(t,oe)}const Ip=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function $p({containerStyle:e,style:t,type:n,component:s}){const{nodesConnectable:o,width:i,height:a,isValid:l,inProgress:u}=ee(Ip,oe);return!(i&&o&&u)?null:r.jsx("svg",{style:e,width:i,height:a,className:"react-flow__connectionline react-flow__container",children:r.jsx("g",{className:ie(["react-flow__connection",qr(l)]),children:r.jsx(Yi,{style:t,type:n,CustomComponent:s,isValid:l})})})}const Yi=({style:e,type:t=Ie.Bezier,CustomComponent:n,isValid:s})=>{const{inProgress:o,from:i,fromNode:a,fromHandle:l,fromPosition:u,to:c,toNode:f,toHandle:d,toPosition:h,pointer:p}=Mp();if(!o)return;if(n)return r.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:a,fromHandle:l,fromX:i.x,fromY:i.y,toX:c.x,toY:c.y,fromPosition:u,toPosition:h,connectionStatus:qr(s),toNode:f,toHandle:d,pointer:p});let g="";const b={sourceX:i.x,sourceY:i.y,sourcePosition:u,targetX:c.x,targetY:c.y,targetPosition:h};switch(t){case Ie.Bezier:[g]=ni(b);break;case Ie.SimpleBezier:[g]=Ai(b);break;case Ie.Step:[g]=ns({...b,borderRadius:0});break;case Ie.SmoothStep:[g]=ns(b);break;default:[g]=oi(b)}return r.jsx("path",{d:g,fill:"none",className:"react-flow__connection-path",style:e})};Yi.displayName="ConnectionLine";const Tp={};function Xo(e=Tp){v.useRef(e),re(),v.useEffect(()=>{},[e])}function Ap(){re(),v.useRef(!1),v.useEffect(()=>{},[])}function Zi({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:s,onEdgeClick:o,onNodeDoubleClick:i,onEdgeDoubleClick:a,onNodeMouseEnter:l,onNodeMouseMove:u,onNodeMouseLeave:c,onNodeContextMenu:f,onSelectionContextMenu:d,onSelectionStart:h,onSelectionEnd:p,connectionLineType:g,connectionLineStyle:b,connectionLineComponent:w,connectionLineContainerStyle:x,selectionKeyCode:N,selectionOnDrag:m,selectionMode:y,multiSelectionKeyCode:S,panActivationKeyCode:k,zoomActivationKeyCode:j,deleteKeyCode:E,onlyRenderVisibleElements:A,elementsSelectable:H,defaultViewport:T,translateExtent:D,minZoom:L,maxZoom:C,preventScrolling:M,defaultMarkerColor:_,zoomOnScroll:I,zoomOnPinch:$,panOnScroll:P,panOnScrollSpeed:z,panOnScrollMode:O,zoomOnDoubleClick:R,panOnDrag:F,onPaneClick:q,onPaneMouseEnter:Z,onPaneMouseMove:U,onPaneMouseLeave:Q,onPaneScroll:V,onPaneContextMenu:B,paneClickDistance:X,nodeClickDistance:J,onEdgeContextMenu:G,onEdgeMouseEnter:K,onEdgeMouseMove:te,onEdgeMouseLeave:se,reconnectRadius:ne,onReconnect:ae,onReconnectStart:Se,onReconnectEnd:we,noDragClassName:Te,noWheelClassName:rt,noPanClassName:it,disableKeyboardA11y:at,nodeExtent:En,rfId:Lt,viewport:Fe,onViewportChange:lt}){return Xo(e),Xo(t),Ap(),Cp(n),_p(Fe),r.jsx(Wm,{onPaneClick:q,onPaneMouseEnter:Z,onPaneMouseMove:U,onPaneMouseLeave:Q,onPaneContextMenu:B,onPaneScroll:V,paneClickDistance:X,deleteKeyCode:E,selectionKeyCode:N,selectionOnDrag:m,selectionMode:y,onSelectionStart:h,onSelectionEnd:p,multiSelectionKeyCode:S,panActivationKeyCode:k,zoomActivationKeyCode:j,elementsSelectable:H,zoomOnScroll:I,zoomOnPinch:$,zoomOnDoubleClick:R,panOnScroll:P,panOnScrollSpeed:z,panOnScrollMode:O,panOnDrag:F,defaultViewport:T,translateExtent:D,minZoom:L,maxZoom:C,onSelectionContextMenu:d,preventScrolling:M,noDragClassName:Te,noWheelClassName:rt,noPanClassName:it,disableKeyboardA11y:at,onViewportChange:lt,isControlledViewport:!!Fe,children:r.jsxs(kp,{children:[r.jsx(vp,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:a,onReconnect:ae,onReconnectStart:Se,onReconnectEnd:we,onlyRenderVisibleElements:A,onEdgeContextMenu:G,onEdgeMouseEnter:K,onEdgeMouseMove:te,onEdgeMouseLeave:se,reconnectRadius:ne,defaultMarkerColor:_,noPanClassName:it,disableKeyboardA11y:at,rfId:Lt}),r.jsx($p,{style:b,type:g,component:w,containerStyle:x}),r.jsx("div",{className:"react-flow__edgelabel-renderer"}),r.jsx(sp,{nodeTypes:e,onNodeClick:s,onNodeDoubleClick:i,onNodeMouseEnter:l,onNodeMouseMove:u,onNodeMouseLeave:c,onNodeContextMenu:f,nodeClickDistance:J,onlyRenderVisibleElements:A,noPanClassName:it,noDragClassName:Te,disableKeyboardA11y:at,nodeExtent:En,rfId:Lt}),r.jsx("div",{className:"react-flow__viewport-portal"})]})})}Zi.displayName="GraphView";const Pp=v.memo(Zi),Yo=({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,width:o,height:i,fitView:a,fitViewOptions:l,minZoom:u=.5,maxZoom:c=2,nodeOrigin:f,nodeExtent:d,zIndexMode:h="basic"}={})=>{const p=new Map,g=new Map,b=new Map,w=new Map,x=s??t??[],N=n??e??[],m=f??[0,0],y=d??jt;ai(b,w,x);const S=os(N,p,g,{nodeOrigin:m,nodeExtent:y,zIndexMode:h});let k=[0,0,1];if(a&&o&&i){const j=Pt(p,{filter:T=>!!((T.width||T.initialWidth)&&(T.height||T.initialHeight))}),{x:E,y:A,zoom:H}=bs(j,o,i,u,c,l?.padding??.1);k=[E,A,H]}return{rfId:"1",width:o??0,height:i??0,transform:k,nodes:N,nodesInitialized:S,nodeLookup:p,parentLookup:g,edges:x,edgeLookup:w,connectionLookup:b,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:s!==void 0,panZoom:null,minZoom:u,maxZoom:c,translateExtent:jt,nodeExtent:y,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Je.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:m,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:a??!1,fitViewOptions:l,fitViewResolver:null,connection:{...Fr},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Kf,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Vr,zIndexMode:h,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},Dp=({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,width:o,height:i,fitView:a,fitViewOptions:l,minZoom:u,maxZoom:c,nodeOrigin:f,nodeExtent:d,zIndexMode:h})=>Jh((p,g)=>{async function b(){const{nodeLookup:w,panZoom:x,fitViewOptions:N,fitViewResolver:m,width:y,height:S,minZoom:k,maxZoom:j}=g();x&&(await Qf({nodes:w,width:y,height:S,panZoom:x,minZoom:k,maxZoom:j},N),m?.resolve(!0),p({fitViewResolver:null}))}return{...Yo({nodes:e,edges:t,width:o,height:i,fitView:a,fitViewOptions:l,minZoom:u,maxZoom:c,nodeOrigin:f,nodeExtent:d,defaultNodes:n,defaultEdges:s,zIndexMode:h}),setNodes:w=>{const{nodeLookup:x,parentLookup:N,nodeOrigin:m,elevateNodesOnSelect:y,fitViewQueued:S,zIndexMode:k}=g(),j=os(w,x,N,{nodeOrigin:m,nodeExtent:d,elevateNodesOnSelect:y,checkEquality:!0,zIndexMode:k});S&&j?(b(),p({nodes:w,nodesInitialized:j,fitViewQueued:!1,fitViewOptions:void 0})):p({nodes:w,nodesInitialized:j})},setEdges:w=>{const{connectionLookup:x,edgeLookup:N}=g();ai(x,N,w),p({edges:w})},setDefaultNodesAndEdges:(w,x)=>{if(w){const{setNodes:N}=g();N(w),p({hasDefaultNodes:!0})}if(x){const{setEdges:N}=g();N(x),p({hasDefaultEdges:!0})}},updateNodeInternals:w=>{const{triggerNodeChanges:x,nodeLookup:N,parentLookup:m,domNode:y,nodeOrigin:S,nodeExtent:k,debug:j,fitViewQueued:E,zIndexMode:A}=g(),{changes:H,updatedInternals:T}=bh(w,N,m,y,S,k,A);T&&(ph(N,m,{nodeOrigin:S,nodeExtent:k,zIndexMode:A}),E?(b(),p({fitViewQueued:!1,fitViewOptions:void 0})):p({}),H?.length>0&&(j&&console.log("React Flow: trigger node changes",H),x?.(H)))},updateNodePositions:(w,x=!1)=>{const N=[];let m=[];const{nodeLookup:y,triggerNodeChanges:S,connection:k,updateConnection:j,onNodesChangeMiddlewareMap:E}=g();for(const[A,H]of w){const T=y.get(A),D=!!(T?.expandParent&&T?.parentId&&H?.position),L={id:A,type:"position",position:D?{x:Math.max(0,H.position.x),y:Math.max(0,H.position.y)}:H.position,dragging:x};if(T&&k.inProgress&&k.fromNode.id===T.id){const C=Ve(T,k.fromHandle,W.Left,!0);j({...k,from:C})}D&&T.parentId&&N.push({id:A,parentId:T.parentId,rect:{...H.internals.positionAbsolute,width:H.measured.width??0,height:H.measured.height??0}}),m.push(L)}if(N.length>0){const{parentLookup:A,nodeOrigin:H}=g(),T=js(N,y,A,H);m.push(...T)}for(const A of E.values())m=A(m);S(m)},triggerNodeChanges:w=>{const{onNodesChange:x,setNodes:N,nodes:m,hasDefaultNodes:y,debug:S}=g();if(w?.length){if(y){const k=Ni(w,m);N(k)}S&&console.log("React Flow: trigger node changes",w),x?.(w)}},triggerEdgeChanges:w=>{const{onEdgesChange:x,setEdges:N,edges:m,hasDefaultEdges:y,debug:S}=g();if(w?.length){if(y){const k=ki(w,m);N(k)}S&&console.log("React Flow: trigger edge changes",w),x?.(w)}},addSelectedNodes:w=>{const{multiSelectionActive:x,edgeLookup:N,nodeLookup:m,triggerNodeChanges:y,triggerEdgeChanges:S}=g();if(x){const k=w.map(j=>Ae(j,!0));y(k);return}y(We(m,new Set([...w]),!0)),S(We(N))},addSelectedEdges:w=>{const{multiSelectionActive:x,edgeLookup:N,nodeLookup:m,triggerNodeChanges:y,triggerEdgeChanges:S}=g();if(x){const k=w.map(j=>Ae(j,!0));S(k);return}S(We(N,new Set([...w]))),y(We(m,new Set,!0))},unselectNodesAndEdges:({nodes:w,edges:x}={})=>{const{edges:N,nodes:m,nodeLookup:y,triggerNodeChanges:S,triggerEdgeChanges:k}=g(),j=w||m,E=x||N,A=j.map(T=>{const D=y.get(T.id);return D&&(D.selected=!1),Ae(T.id,!1)}),H=E.map(T=>Ae(T.id,!1));S(A),k(H)},setMinZoom:w=>{const{panZoom:x,maxZoom:N}=g();x?.setScaleExtent([w,N]),p({minZoom:w})},setMaxZoom:w=>{const{panZoom:x,minZoom:N}=g();x?.setScaleExtent([N,w]),p({maxZoom:w})},setTranslateExtent:w=>{g().panZoom?.setTranslateExtent(w),p({translateExtent:w})},resetSelectedElements:()=>{const{edges:w,nodes:x,triggerNodeChanges:N,triggerEdgeChanges:m,elementsSelectable:y}=g();if(!y)return;const S=x.reduce((j,E)=>E.selected?[...j,Ae(E.id,!1)]:j,[]),k=w.reduce((j,E)=>E.selected?[...j,Ae(E.id,!1)]:j,[]);N(S),m(k)},setNodeExtent:w=>{const{nodes:x,nodeLookup:N,parentLookup:m,nodeOrigin:y,elevateNodesOnSelect:S,nodeExtent:k,zIndexMode:j}=g();w[0][0]===k[0][0]&&w[0][1]===k[0][1]&&w[1][0]===k[1][0]&&w[1][1]===k[1][1]||(os(x,N,m,{nodeOrigin:y,nodeExtent:w,elevateNodesOnSelect:S,checkEquality:!1,zIndexMode:j}),p({nodeExtent:w}))},panBy:w=>{const{transform:x,width:N,height:m,panZoom:y,translateExtent:S}=g();return wh({delta:w,panZoom:y,transform:x,translateExtent:S,width:N,height:m})},setCenter:async(w,x,N)=>{const{width:m,height:y,maxZoom:S,panZoom:k}=g();if(!k)return Promise.resolve(!1);const j=typeof N?.zoom<"u"?N.zoom:S;return await k.setViewport({x:m/2-w*j,y:y/2-x*j,zoom:j},{duration:N?.duration,ease:N?.ease,interpolate:N?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{p({connection:{...Fr}})},updateConnection:w=>{p({connection:w})},reset:()=>p({...Yo()})}},Object.is);function Wi({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:s,initialWidth:o,initialHeight:i,initialMinZoom:a,initialMaxZoom:l,initialFitViewOptions:u,fitView:c,nodeOrigin:f,nodeExtent:d,zIndexMode:h,children:p}){const[g]=v.useState(()=>Dp({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,width:o,height:i,fitView:c,minZoom:a,maxZoom:l,fitViewOptions:u,nodeOrigin:f,nodeExtent:d,zIndexMode:h}));return r.jsx(em,{value:g,children:r.jsx(km,{children:p})})}function zp({children:e,nodes:t,edges:n,defaultNodes:s,defaultEdges:o,width:i,height:a,fitView:l,fitViewOptions:u,minZoom:c,maxZoom:f,nodeOrigin:d,nodeExtent:h,zIndexMode:p}){return v.useContext(kn)?r.jsx(r.Fragment,{children:e}):r.jsx(Wi,{initialNodes:t,initialEdges:n,defaultNodes:s,defaultEdges:o,initialWidth:i,initialHeight:a,fitView:l,initialFitViewOptions:u,initialMinZoom:c,initialMaxZoom:f,nodeOrigin:d,nodeExtent:h,zIndexMode:p,children:e})}const Lp={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Rp({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,className:o,nodeTypes:i,edgeTypes:a,onNodeClick:l,onEdgeClick:u,onInit:c,onMove:f,onMoveStart:d,onMoveEnd:h,onConnect:p,onConnectStart:g,onConnectEnd:b,onClickConnectStart:w,onClickConnectEnd:x,onNodeMouseEnter:N,onNodeMouseMove:m,onNodeMouseLeave:y,onNodeContextMenu:S,onNodeDoubleClick:k,onNodeDragStart:j,onNodeDrag:E,onNodeDragStop:A,onNodesDelete:H,onEdgesDelete:T,onDelete:D,onSelectionChange:L,onSelectionDragStart:C,onSelectionDrag:M,onSelectionDragStop:_,onSelectionContextMenu:I,onSelectionStart:$,onSelectionEnd:P,onBeforeDelete:z,connectionMode:O,connectionLineType:R=Ie.Bezier,connectionLineStyle:F,connectionLineComponent:q,connectionLineContainerStyle:Z,deleteKeyCode:U="Backspace",selectionKeyCode:Q="Shift",selectionOnDrag:V=!1,selectionMode:B=_t.Full,panActivationKeyCode:X="Space",multiSelectionKeyCode:J=Mt()?"Meta":"Control",zoomActivationKeyCode:G=Mt()?"Meta":"Control",snapToGrid:K,snapGrid:te,onlyRenderVisibleElements:se=!1,selectNodesOnDrag:ne,nodesDraggable:ae,autoPanOnNodeFocus:Se,nodesConnectable:we,nodesFocusable:Te,nodeOrigin:rt=wi,edgesFocusable:it,edgesReconnectable:at,elementsSelectable:En=!0,defaultViewport:Lt=hm,minZoom:Fe=.5,maxZoom:lt=2,translateExtent:Ss=jt,preventScrolling:Ui=!0,nodeExtent:Mn,defaultMarkerColor:Ji="#b1b1b7",zoomOnScroll:ea=!0,zoomOnPinch:ta=!0,panOnScroll:na=!1,panOnScrollSpeed:sa=.5,panOnScrollMode:oa=Le.Free,zoomOnDoubleClick:ra=!0,panOnDrag:ia=!0,onPaneClick:aa,onPaneMouseEnter:la,onPaneMouseMove:ca,onPaneMouseLeave:da,onPaneScroll:ua,onPaneContextMenu:fa,paneClickDistance:ha=1,nodeClickDistance:ma=0,children:pa,onReconnect:ga,onReconnectStart:xa,onReconnectEnd:ya,onEdgeContextMenu:ba,onEdgeDoubleClick:wa,onEdgeMouseEnter:va,onEdgeMouseMove:Na,onEdgeMouseLeave:ka,reconnectRadius:Ca=10,onNodesChange:ja,onEdgesChange:_a,noDragClassName:Sa="nodrag",noWheelClassName:Ea="nowheel",noPanClassName:Es="nopan",fitView:Ms,fitViewOptions:Is,connectOnClick:Ma,attributionPosition:Ia,proOptions:$a,defaultEdgeOptions:Ta,elevateNodesOnSelect:Aa=!0,elevateEdgesOnSelect:Pa=!1,disableKeyboardA11y:$s=!1,autoPanOnConnect:Da,autoPanOnNodeDrag:za,autoPanSpeed:La,connectionRadius:Ra,isValidConnection:Ha,onError:Oa,style:Ba,id:Ts,nodeDragThreshold:Va,connectionDragThreshold:Fa,viewport:qa,onViewportChange:Xa,width:Ya,height:Za,colorMode:Wa="light",debug:Qa,onScroll:As,ariaLabelConfig:Ga,zIndexMode:Ps="basic",...Ka},Ua){const In=Ts||"1",Ja=xm(Wa),el=v.useCallback(Ds=>{Ds.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),As?.(Ds)},[As]);return r.jsx("div",{"data-testid":"rf__wrapper",...Ka,onScroll:el,style:{...Ba,...Lp},ref:Ua,className:ie(["react-flow",o,Ja]),id:Ts,role:"application",children:r.jsxs(zp,{nodes:e,edges:t,width:Ya,height:Za,fitView:Ms,fitViewOptions:Is,minZoom:Fe,maxZoom:lt,nodeOrigin:rt,nodeExtent:Mn,zIndexMode:Ps,children:[r.jsx(Pp,{onInit:c,onNodeClick:l,onEdgeClick:u,onNodeMouseEnter:N,onNodeMouseMove:m,onNodeMouseLeave:y,onNodeContextMenu:S,onNodeDoubleClick:k,nodeTypes:i,edgeTypes:a,connectionLineType:R,connectionLineStyle:F,connectionLineComponent:q,connectionLineContainerStyle:Z,selectionKeyCode:Q,selectionOnDrag:V,selectionMode:B,deleteKeyCode:U,multiSelectionKeyCode:J,panActivationKeyCode:X,zoomActivationKeyCode:G,onlyRenderVisibleElements:se,defaultViewport:Lt,translateExtent:Ss,minZoom:Fe,maxZoom:lt,preventScrolling:Ui,zoomOnScroll:ea,zoomOnPinch:ta,zoomOnDoubleClick:ra,panOnScroll:na,panOnScrollSpeed:sa,panOnScrollMode:oa,panOnDrag:ia,onPaneClick:aa,onPaneMouseEnter:la,onPaneMouseMove:ca,onPaneMouseLeave:da,onPaneScroll:ua,onPaneContextMenu:fa,paneClickDistance:ha,nodeClickDistance:ma,onSelectionContextMenu:I,onSelectionStart:$,onSelectionEnd:P,onReconnect:ga,onReconnectStart:xa,onReconnectEnd:ya,onEdgeContextMenu:ba,onEdgeDoubleClick:wa,onEdgeMouseEnter:va,onEdgeMouseMove:Na,onEdgeMouseLeave:ka,reconnectRadius:Ca,defaultMarkerColor:Ji,noDragClassName:Sa,noWheelClassName:Ea,noPanClassName:Es,rfId:In,disableKeyboardA11y:$s,nodeExtent:Mn,viewport:qa,onViewportChange:Xa}),r.jsx(gm,{nodes:e,edges:t,defaultNodes:n,defaultEdges:s,onConnect:p,onConnectStart:g,onConnectEnd:b,onClickConnectStart:w,onClickConnectEnd:x,nodesDraggable:ae,autoPanOnNodeFocus:Se,nodesConnectable:we,nodesFocusable:Te,edgesFocusable:it,edgesReconnectable:at,elementsSelectable:En,elevateNodesOnSelect:Aa,elevateEdgesOnSelect:Pa,minZoom:Fe,maxZoom:lt,nodeExtent:Mn,onNodesChange:ja,onEdgesChange:_a,snapToGrid:K,snapGrid:te,connectionMode:O,translateExtent:Ss,connectOnClick:Ma,defaultEdgeOptions:Ta,fitView:Ms,fitViewOptions:Is,onNodesDelete:H,onEdgesDelete:T,onDelete:D,onNodeDragStart:j,onNodeDrag:E,onNodeDragStop:A,onSelectionDrag:M,onSelectionDragStart:C,onSelectionDragStop:_,onMove:f,onMoveStart:d,onMoveEnd:h,noPanClassName:Es,nodeOrigin:rt,rfId:In,autoPanOnConnect:Da,autoPanOnNodeDrag:za,autoPanSpeed:La,onError:Oa,connectionRadius:Ra,isValidConnection:Ha,selectNodesOnDrag:ne,nodeDragThreshold:Va,connectionDragThreshold:Fa,onBeforeDelete:z,debug:Qa,ariaLabelConfig:Ga,zIndexMode:Ps}),r.jsx(fm,{onSelectionChange:L}),pa,r.jsx(am,{proOptions:$a,position:Ia}),r.jsx(im,{rfId:In,disableKeyboardA11y:$s})]})})}var Hp=Ci(Rp);function Op(e){const[t,n]=v.useState(e),s=v.useCallback(o=>n(i=>Ni(o,i)),[]);return[t,n,s]}function Bp(e){const[t,n]=v.useState(e),s=v.useCallback(o=>n(i=>ki(o,i)),[]);return[t,n,s]}function Vp({dimensions:e,lineWidth:t,variant:n,className:s}){return r.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ie(["react-flow__background-pattern",n,s])})}function Fp({radius:e,className:t}){return r.jsx("circle",{cx:e,cy:e,r:e,className:ie(["react-flow__background-pattern","dots",t])})}var $e;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})($e||($e={}));const qp={[$e.Dots]:1,[$e.Lines]:1,[$e.Cross]:6},Xp=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Qi({id:e,variant:t=$e.Dots,gap:n=20,size:s,lineWidth:o=1,offset:i=0,color:a,bgColor:l,style:u,className:c,patternClassName:f}){const d=v.useRef(null),{transform:h,patternId:p}=ee(Xp,oe),g=s||qp[t],b=t===$e.Dots,w=t===$e.Cross,x=Array.isArray(n)?n:[n,n],N=[x[0]*h[2]||1,x[1]*h[2]||1],m=g*h[2],y=Array.isArray(i)?i:[i,i],S=w?[m,m]:N,k=[y[0]*h[2]||1+S[0]/2,y[1]*h[2]||1+S[1]/2],j=`${p}${e||""}`;return r.jsxs("svg",{className:ie(["react-flow__background",c]),style:{...u,..._n,"--xy-background-color-props":l,"--xy-background-pattern-color-props":a},ref:d,"data-testid":"rf__background",children:[r.jsx("pattern",{id:j,x:h[0]%N[0],y:h[1]%N[1],width:N[0],height:N[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${k[0]},-${k[1]})`,children:b?r.jsx(Fp,{radius:m/2,className:f}):r.jsx(Vp,{dimensions:S,lineWidth:o,variant:t,className:f})}),r.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${j})`})]})}Qi.displayName="Background";const Yp=v.memo(Qi);function Zp(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:r.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Wp(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:r.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Qp(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:r.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Gp(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:r.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Kp(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:r.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Wt({children:e,className:t,...n}){return r.jsx("button",{type:"button",className:ie(["react-flow__controls-button",t]),...n,children:e})}const Up=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function Gi({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:s=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:a,onFitView:l,onInteractiveChange:u,className:c,children:f,position:d="bottom-left",orientation:h="vertical","aria-label":p}){const g=re(),{isInteractive:b,minZoomReached:w,maxZoomReached:x,ariaLabelConfig:N}=ee(Up,oe),{zoomIn:m,zoomOut:y,fitView:S}=jn(),k=()=>{m(),i?.()},j=()=>{y(),a?.()},E=()=>{S(o),l?.()},A=()=>{g.setState({nodesDraggable:!b,nodesConnectable:!b,elementsSelectable:!b}),u?.(!b)},H=h==="horizontal"?"horizontal":"vertical";return r.jsxs(Cn,{className:ie(["react-flow__controls",H,c]),position:d,style:e,"data-testid":"rf__controls","aria-label":p??N["controls.ariaLabel"],children:[t&&r.jsxs(r.Fragment,{children:[r.jsx(Wt,{onClick:k,className:"react-flow__controls-zoomin",title:N["controls.zoomIn.ariaLabel"],"aria-label":N["controls.zoomIn.ariaLabel"],disabled:x,children:r.jsx(Zp,{})}),r.jsx(Wt,{onClick:j,className:"react-flow__controls-zoomout",title:N["controls.zoomOut.ariaLabel"],"aria-label":N["controls.zoomOut.ariaLabel"],disabled:w,children:r.jsx(Wp,{})})]}),n&&r.jsx(Wt,{className:"react-flow__controls-fitview",onClick:E,title:N["controls.fitView.ariaLabel"],"aria-label":N["controls.fitView.ariaLabel"],children:r.jsx(Qp,{})}),s&&r.jsx(Wt,{className:"react-flow__controls-interactive",onClick:A,title:N["controls.interactive.ariaLabel"],"aria-label":N["controls.interactive.ariaLabel"],children:b?r.jsx(Kp,{}):r.jsx(Gp,{})}),f]})}Gi.displayName="Controls";v.memo(Gi);function Jp({id:e,x:t,y:n,width:s,height:o,style:i,color:a,strokeColor:l,strokeWidth:u,className:c,borderRadius:f,shapeRendering:d,selected:h,onClick:p}){const{background:g,backgroundColor:b}=i||{},w=a||g||b;return r.jsx("rect",{className:ie(["react-flow__minimap-node",{selected:h},c]),x:t,y:n,rx:f,ry:f,width:s,height:o,style:{fill:w,stroke:l,strokeWidth:u},shapeRendering:d,onClick:p?x=>p(x,e):void 0})}const e0=v.memo(Jp),t0=e=>e.nodes.map(t=>t.id),qn=e=>e instanceof Function?e:()=>e;function n0({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:s=5,nodeStrokeWidth:o,nodeComponent:i=e0,onClick:a}){const l=ee(t0,oe),u=qn(t),c=qn(e),f=qn(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return r.jsx(r.Fragment,{children:l.map(h=>r.jsx(o0,{id:h,nodeColorFunc:u,nodeStrokeColorFunc:c,nodeClassNameFunc:f,nodeBorderRadius:s,nodeStrokeWidth:o,NodeComponent:i,onClick:a,shapeRendering:d},h))})}function s0({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:s,nodeBorderRadius:o,nodeStrokeWidth:i,shapeRendering:a,NodeComponent:l,onClick:u}){const{node:c,x:f,y:d,width:h,height:p}=ee(g=>{const{internals:b}=g.nodeLookup.get(e),w=b.userNode,{x,y:N}=b.positionAbsolute,{width:m,height:y}=_e(w);return{node:w,x,y:N,width:m,height:y}},oe);return!c||c.hidden||!Gr(c)?null:r.jsx(l,{x:f,y:d,width:h,height:p,style:c.style,selected:!!c.selected,className:s(c),color:t(c),borderRadius:o,strokeColor:n(c),strokeWidth:i,shapeRendering:a,onClick:u,id:c.id})}const o0=v.memo(s0);var r0=v.memo(n0);const i0=200,a0=150,l0=e=>!e.hidden,c0=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Qr(Pt(e.nodeLookup,{filter:l0}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},d0="react-flow__minimap-desc";function Ki({style:e,className:t,nodeStrokeColor:n,nodeColor:s,nodeClassName:o="",nodeBorderRadius:i=5,nodeStrokeWidth:a,nodeComponent:l,bgColor:u,maskColor:c,maskStrokeColor:f,maskStrokeWidth:d,position:h="bottom-right",onClick:p,onNodeClick:g,pannable:b=!1,zoomable:w=!1,ariaLabel:x,inversePan:N,zoomStep:m=1,offsetScale:y=5}){const S=re(),k=v.useRef(null),{boundingRect:j,viewBB:E,rfId:A,panZoom:H,translateExtent:T,flowWidth:D,flowHeight:L,ariaLabelConfig:C}=ee(c0,oe),M=e?.width??i0,_=e?.height??a0,I=j.width/M,$=j.height/_,P=Math.max(I,$),z=P*M,O=P*_,R=y*P,F=j.x-(z-j.width)/2-R,q=j.y-(O-j.height)/2-R,Z=z+R*2,U=O+R*2,Q=`${d0}-${A}`,V=v.useRef(0),B=v.useRef();V.current=P,v.useEffect(()=>{if(k.current&&H)return B.current=Mh({domNode:k.current,panZoom:H,getTransform:()=>S.getState().transform,getViewScale:()=>V.current}),()=>{B.current?.destroy()}},[H]),v.useEffect(()=>{B.current?.update({translateExtent:T,width:D,height:L,inversePan:N,pannable:b,zoomStep:m,zoomable:w})},[b,w,N,m,T,D,L]);const X=p?K=>{const[te,se]=B.current?.pointer(K)||[0,0];p(K,{x:te,y:se})}:void 0,J=g?v.useCallback((K,te)=>{const se=S.getState().nodeLookup.get(te).internals.userNode;g(K,se)},[]):void 0,G=x??C["minimap.ariaLabel"];return r.jsx(Cn,{position:h,style:{...e,"--xy-minimap-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*P:void 0,"--xy-minimap-node-background-color-props":typeof s=="string"?s:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof a=="number"?a:void 0},className:ie(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:r.jsxs("svg",{width:M,height:_,viewBox:`${F} ${q} ${Z} ${U}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Q,ref:k,onClick:X,children:[G&&r.jsx("title",{id:Q,children:G}),r.jsx(r0,{onClick:J,nodeColor:s,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:o,nodeStrokeWidth:a,nodeComponent:l}),r.jsx("path",{className:"react-flow__minimap-mask",d:`M${F-R},${q-R}h${Z+R*2}v${U+R*2}h${-Z-R*2}z
        M${E.x},${E.y}h${E.width}v${E.height}h${-E.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Ki.displayName="MiniMap";const u0=v.memo(Ki),f0=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,h0={[st.Line]:"right",[st.Handle]:"bottom-right"};function m0({nodeId:e,position:t,variant:n=st.Handle,className:s,style:o=void 0,children:i,color:a,minWidth:l=10,minHeight:u=10,maxWidth:c=Number.MAX_VALUE,maxHeight:f=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:h,autoScale:p=!0,shouldResize:g,onResizeStart:b,onResize:w,onResizeEnd:x}){const N=Ei(),m=typeof e=="string"?e:N,y=re(),S=v.useRef(null),k=n===st.Handle,j=ee(v.useCallback(f0(k&&p),[k,p]),oe),E=v.useRef(null),A=t??h0[n];v.useEffect(()=>{if(!(!S.current||!m))return E.current||(E.current=Fh({domNode:S.current,nodeId:m,getStoreItems:()=>{const{nodeLookup:T,transform:D,snapGrid:L,snapToGrid:C,nodeOrigin:M,domNode:_}=y.getState();return{nodeLookup:T,transform:D,snapGrid:L,snapToGrid:C,nodeOrigin:M,paneDomNode:_}},onChange:(T,D)=>{const{triggerNodeChanges:L,nodeLookup:C,parentLookup:M,nodeOrigin:_}=y.getState(),I=[],$={x:T.x,y:T.y},P=C.get(m);if(P&&P.expandParent&&P.parentId){const z=P.origin??_,O=T.width??P.measured.width??0,R=T.height??P.measured.height??0,F={id:P.id,parentId:P.parentId,rect:{width:O,height:R,...Kr({x:T.x??P.position.x,y:T.y??P.position.y},{width:O,height:R},P.parentId,C,z)}},q=js([F],C,M,_);I.push(...q),$.x=T.x?Math.max(z[0]*O,T.x):void 0,$.y=T.y?Math.max(z[1]*R,T.y):void 0}if($.x!==void 0&&$.y!==void 0){const z={id:m,type:"position",position:{...$}};I.push(z)}if(T.width!==void 0&&T.height!==void 0){const O={id:m,type:"dimensions",resizing:!0,setAttributes:h?h==="horizontal"?"width":"height":!0,dimensions:{width:T.width,height:T.height}};I.push(O)}for(const z of D){const O={...z,type:"position"};I.push(O)}L(I)},onEnd:({width:T,height:D})=>{const L={id:m,type:"dimensions",resizing:!1,dimensions:{width:T,height:D}};y.getState().triggerNodeChanges([L])}})),E.current.update({controlPosition:A,boundaries:{minWidth:l,minHeight:u,maxWidth:c,maxHeight:f},keepAspectRatio:d,resizeDirection:h,onResizeStart:b,onResize:w,onResizeEnd:x,shouldResize:g}),()=>{E.current?.destroy()}},[A,l,u,c,f,d,b,w,x,g]);const H=A.split("-");return r.jsx("div",{className:ie(["react-flow__resize-control","nodrag",...H,n,s]),ref:S,style:{...o,scale:j,...a&&{[k?"backgroundColor":"borderColor"]:a}},children:i})}v.memo(m0);const p0={input:wl,process:bl,output:en,decision:yl,handler:De,tool:xl,agent:gl,memory:pl},g0={input:"#64748b",process:"#f59e0b",output:"#22c55e",decision:"#8b5cf6",handler:"#3b82f6",tool:"#06b6d4",agent:"#f97316",memory:"#ec4899"},x0={input:"Input",process:"Process",output:"Output",decision:"Decision",handler:"Handler",tool:"Tool",agent:"Agent",memory:"Memory"};function y0({data:e,selected:t,id:n}){const s=e,o=Gl(),i=s.role||"process",a=s.color||g0[i],l=p0[i],u=s.codeExampleIndex!==void 0,c=t||o?.selectedNodeId===n,f=o?.hoveredNodeId===n,[d,h]=v.useState(!1),p=v.useRef(null),[g,b]=v.useState(null),w=v.useRef(0),x=v.useCallback(()=>{if(o){const k={id:n,position:{x:0,y:0},data:s};o.selectNode(k)}},[o,n,s]),N=v.useCallback(k=>{const j=k.currentTarget.getBoundingClientRect(),E=k.clientX-j.left,A=k.clientY-j.top;w.current+=1,b({x:E,y:A,key:w.current}),x()},[x]),m=v.useCallback(k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),x())},[x]),y=v.useCallback(()=>{o?.setHoveredNodeId(n),p.current=setTimeout(()=>{h(!0)},400)},[o,n]),S=v.useCallback(()=>{o?.setHoveredNodeId(null),p.current&&clearTimeout(p.current),h(!1)},[o]);return r.jsxs("div",{role:"button",tabIndex:0,"aria-label":`${s.label}${s.description?`: ${s.description}`:""}`,onClick:N,onKeyDown:m,onFocus:y,onBlur:S,onMouseEnter:y,onMouseLeave:S,className:`
        relative px-4 py-3 rounded-xl min-w-[140px] cursor-pointer
        transition-all duration-200 ease-out
        ${c?"ring-2 ring-offset-2 ring-offset-dark-900 scale-105":""}
        ${f&&!c?"scale-102":""}
        ${u?"animate-pulse-subtle":""}
      `,style:{backgroundColor:`${a}15`,borderWidth:2,borderStyle:"solid",borderColor:c?a:f?`${a}80`:`${a}40`,boxShadow:c?`0 0 20px ${a}40, 0 4px 12px rgba(0,0,0,0.3)`:f?`0 0 12px ${a}20, 0 2px 8px rgba(0,0,0,0.2)`:"0 2px 8px rgba(0,0,0,0.2)",...c?{ringColor:a}:{}},children:[r.jsx(ot,{type:"target",position:W.Left,className:"!w-3 !h-3 !border-2 !border-dark-800",style:{backgroundColor:a,opacity:i==="input"?0:1}}),r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center flex-shrink-0 mt-0.5",style:{backgroundColor:`${a}30`},children:r.jsx(l,{className:"w-3.5 h-3.5",style:{color:a}})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-semibold text-white truncate",children:s.label}),s.description&&r.jsx("div",{className:"text-xs text-dark-400 mt-0.5 line-clamp-2",children:s.description})]})]}),u&&r.jsx("div",{className:"absolute -top-2 -right-2 w-5 h-5 rounded-full flex items-center justify-center",style:{backgroundColor:a},title:"Click to see code",children:r.jsx(Re,{className:"w-3 h-3 text-white"})}),r.jsx(ot,{type:"source",position:W.Right,className:"!w-3 !h-3 !border-2 !border-dark-800",style:{backgroundColor:a,opacity:i==="output"?0:1}}),g&&r.jsx("span",{className:"node-ripple",style:{left:g.x,top:g.y,backgroundColor:`${a}40`},onAnimationEnd:()=>b(null)},g.key),c&&r.jsx("div",{className:"absolute inset-0 rounded-xl pointer-events-none animate-glow",style:{background:`radial-gradient(ellipse at center, ${a}20 0%, transparent 70%)`}}),d&&!c&&s.detailedHint&&r.jsxs("div",{className:"node-tooltip",style:{borderColor:`${a}40`},children:[r.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[r.jsx("span",{className:"text-[10px] font-medium px-1.5 py-0.5 rounded",style:{backgroundColor:`${a}20`,color:a},children:x0[i]}),u&&r.jsxs("span",{className:"text-[10px] text-dark-500 flex items-center gap-0.5",children:[r.jsx(Re,{className:"w-2.5 h-2.5"}),"Has code"]})]}),r.jsx("p",{className:"text-[11px] text-dark-300 leading-relaxed line-clamp-3",children:s.detailedHint}),r.jsx("p",{className:"text-[10px] text-dark-500 mt-1",children:"Click for details"})]})]})}const Zo=v.memo(y0),b0={input:"Input",process:"Process",output:"Output",decision:"Decision",handler:"Handler",tool:"Tool",agent:"Agent",memory:"Memory"},w0={input:"Entry point that receives initial data",process:"Transforms or processes data",output:"Produces final results",decision:"Routes flow based on conditions",handler:"Handles specific types of requests",tool:"Performs specific actions or retrieves data",agent:"Autonomous entity that makes decisions",memory:"Stores and retrieves contextual information"},v0=v.memo(function(){const{selectedNode:t,isDetailPanelOpen:n,closeDetailPanel:s,scrollToCodeExample:o}=cs(),i=v.useRef(null),a=v.useCallback(p=>{p.key==="Escape"&&s()},[s]);if(v.useEffect(()=>(n&&(document.addEventListener("keydown",a),setTimeout(()=>{i.current?.querySelector("button")?.focus()},100)),()=>document.removeEventListener("keydown",a)),[n,a]),!t)return null;const{data:l}=t,u=l.role||"process",c=l.color||"#f59e0b",f=l.codeExampleIndex!==void 0,d=l.conceptIds||[],h=()=>{l.codeExampleIndex!==void 0&&o(l.codeExampleIndex)};return r.jsx(Ce,{children:n&&r.jsxs(r.Fragment,{children:[r.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-40 lg:hidden",onClick:s}),r.jsxs(Y.div,{ref:i,role:"dialog","aria-modal":"true","aria-label":`Details for ${l.label}`,initial:{x:"100%",opacity:0},animate:{x:0,opacity:1},exit:{x:"100%",opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed right-0 top-0 h-full w-full max-w-md bg-dark-900 border-l border-dark-700 z-50 overflow-y-auto",children:[r.jsx("div",{className:"sticky top-0 p-4 border-b border-dark-700 backdrop-blur-md bg-dark-900/90",style:{borderTopColor:c},children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:`${c}20`},children:r.jsx(wt,{className:"w-5 h-5",style:{color:c}})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-dark-50",children:l.label}),r.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full",style:{backgroundColor:`${c}20`,color:c},children:b0[u]})]})]}),r.jsx("button",{onClick:s,"aria-label":"Close detail panel",className:"p-2 rounded-lg text-dark-400 hover:text-dark-50 hover:bg-dark-800 transition-colors",children:r.jsx(rr,{className:"w-5 h-5"})})]})}),r.jsxs("div",{className:"p-4 space-y-6",children:[l.description&&r.jsx(Y.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.1,duration:.3},children:r.jsx("p",{className:"text-dark-300",children:l.description})}),r.jsxs(Y.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.15,duration:.3},className:"glass rounded-xl p-4",children:[r.jsxs("h4",{className:"text-sm font-medium text-dark-400 mb-2 flex items-center gap-2",children:[r.jsx(mn,{className:"w-4 h-4"}),"About this step"]}),r.jsx("p",{className:"text-sm text-dark-200",children:w0[u]})]}),l.detailedHint&&r.jsxs(Y.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.2,duration:.3},className:"glass rounded-xl p-4 border-l-4",style:{borderLeftColor:c},children:[r.jsxs("h4",{className:"text-sm font-medium text-dark-50 mb-2 flex items-center gap-2",children:[r.jsx(hn,{className:"w-4 h-4",style:{color:c}}),"How it works"]}),r.jsx("p",{className:"text-sm text-dark-200 whitespace-pre-line",children:l.detailedHint})]}),f&&r.jsxs(Y.button,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.25,duration:.3},onClick:h,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full flex items-center justify-between gap-3 px-4 py-3 rounded-xl text-dark-50 font-medium transition-colors",style:{backgroundColor:`${c}20`,borderColor:c},children:[r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx(Re,{className:"w-5 h-5",style:{color:c}}),"View in Code"]}),r.jsx(De,{className:"w-4 h-4",style:{color:c}})]}),d.length>0&&r.jsxs(Y.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:[r.jsxs("h4",{className:"text-sm font-medium text-dark-400 mb-3 flex items-center gap-2",children:[r.jsx(wt,{className:"w-4 h-4"}),"Related Concepts"]}),r.jsx("div",{className:"space-y-2",children:d.map((p,g)=>{const b=Yl[p];return b?r.jsxs(Y.div,{initial:{opacity:0,x:12},animate:{opacity:1,x:0},transition:{delay:.35+g*.05,duration:.25},className:"glass rounded-lg p-3",children:[r.jsx("div",{className:"text-sm font-medium text-dark-50",children:b.name}),r.jsx("div",{className:"text-xs text-dark-400 mt-0.5",children:b.shortDescription})]},p):null})})]}),l.codeHighlightLines&&r.jsxs(Y.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},className:"text-xs text-dark-500 flex items-center gap-2",children:[r.jsx(Re,{className:"w-3 h-3"}),"Lines ",l.codeHighlightLines[0],"-",l.codeHighlightLines[1]]})]})]})]})})}),N0={enhanced:Zo,custom:Zo},k0=v.memo(function({chapterColor:t}){const{zoomIn:n,zoomOut:s,fitView:o}=jn(),[i,a]=v.useState(100),l=v.useCallback(()=>{n({duration:200}),a(f=>Math.min(f+20,200))},[n]),u=v.useCallback(()=>{s({duration:200}),a(f=>Math.max(f-20,30))},[s]),c=v.useCallback(()=>{o({padding:.2,duration:300}),a(100)},[o]);return r.jsxs("div",{className:"absolute bottom-4 right-4 z-10 flex flex-col gap-1",children:[r.jsx("button",{onClick:l,className:"p-2 rounded-lg glass-elevated text-dark-300 hover:text-dark-50 transition-colors",title:"Zoom in","aria-label":"Zoom in",children:r.jsx(jl,{className:"w-4 h-4"})}),r.jsxs("div",{className:"text-[10px] text-dark-500 text-center py-0.5","aria-live":"polite",children:[i,"%"]}),r.jsx("button",{onClick:u,className:"p-2 rounded-lg glass-elevated text-dark-300 hover:text-dark-50 transition-colors",title:"Zoom out","aria-label":"Zoom out",children:r.jsx(_l,{className:"w-4 h-4"})}),r.jsx("div",{className:"h-px bg-dark-700 my-1"}),r.jsx("button",{onClick:c,className:"p-2 rounded-lg glass-elevated text-dark-300 hover:text-dark-50 transition-colors",title:"Fit to view","aria-label":"Fit diagram to view",style:{color:t},children:r.jsx(Sl,{className:"w-4 h-4"})})]})});function C0({diagramNodes:e,diagramEdges:t,chapterColor:n,title:s="Pattern Flow"}){const{selectedNodeId:o,hoveredNodeId:i,clearSelection:a,isFullScreen:l,toggleFullScreen:u}=cs(),c=v.useMemo(()=>e.map(N=>({id:N.id,type:"enhanced",position:N.position,data:{...N.data,role:N.data.role||"process"}})),[e]),f=v.useMemo(()=>({type:St.ArrowClosed,width:16,height:16,color:"#64748b"}),[]),d=v.useMemo(()=>t.map(N=>({id:N.id,source:N.source,target:N.target,label:N.label,animated:N.animated!==!1,markerEnd:{...f,color:"#64748b"},style:{stroke:"#64748b",strokeWidth:2,...N.style},labelStyle:{fill:"#94a3b8",fontSize:12}})),[t,f]),[h,,p]=Op(c),[g,b,w]=Bp(d);v.useEffect(()=>{const N=i||o;b(m=>m.map(y=>{const S=N&&(y.source===N||y.target===N);return{...y,style:{...y.style,stroke:S?n:"#64748b",strokeWidth:S?3:2,opacity:N&&!S?.3:1},markerEnd:{...f,color:S?n:"#64748b"},animated:S||y.animated}}))},[i,o,n,b,f]),v.useEffect(()=>{const N=m=>{m.key==="Escape"&&(l?u():a())};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[l,u,a]),v.useEffect(()=>(l?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[l]);const x=l?"fixed inset-0 z-50 bg-dark-950":"glass rounded-2xl overflow-hidden";return r.jsxs(r.Fragment,{children:[r.jsxs(Y.div,{layout:!0,className:x,initial:!1,animate:{scale:1},transition:{duration:.3},children:[r.jsxs("div",{className:"p-4 border-b border-dark-700 flex items-center justify-between bg-dark-900/50 backdrop-blur-sm",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("h3",{className:"font-semibold text-dark-50 flex items-center gap-2",children:[r.jsx(vl,{className:"w-4 h-4 text-primary-400"}),s]}),r.jsxs("span",{className:"text-xs text-dark-400 flex items-center gap-1",children:[r.jsx(Nl,{className:"w-3 h-3"}),"Click nodes to explore"]})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("button",{onClick:u,className:"p-2 rounded-lg text-dark-400 hover:text-dark-50 hover:bg-dark-700 transition-colors",title:l?"Exit full screen (Esc)":"Full screen","aria-label":l?"Exit full screen":"Enter full screen","aria-expanded":l,children:l?r.jsx(kl,{className:"w-5 h-5"}):r.jsx(Cl,{className:"w-5 h-5"})})})]}),r.jsxs("div",{className:`relative ${l?"h-[calc(100vh-65px)]":"h-[400px]"}`,style:{background:"rgba(15, 23, 42, 0.5)"},children:[r.jsxs(Hp,{nodes:h,edges:g,onNodesChange:p,onEdgesChange:w,nodeTypes:N0,fitView:!0,fitViewOptions:{padding:.2,minZoom:.5,maxZoom:1.5},attributionPosition:"bottom-left",proOptions:{hideAttribution:!0},minZoom:.3,maxZoom:2,defaultEdgeOptions:{type:"default",animated:!0},children:[r.jsx(Yp,{color:"#334155",gap:20}),l&&r.jsx(u0,{nodeColor:N=>N.data?.color||"#64748b",maskColor:"rgba(15, 23, 42, 0.8)",className:"!bg-dark-800 !rounded-lg"})]}),r.jsx(k0,{chapterColor:n})]}),r.jsx(Ce,{children:l&&r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"absolute bottom-4 left-4 glass rounded-lg p-3 text-xs",children:[r.jsx("div",{className:"text-dark-400 mb-2 font-medium",children:"Legend"}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-slate-500"}),r.jsx("span",{className:"text-dark-300",children:"Input"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:n}}),r.jsx("span",{className:"text-dark-300",children:"Process"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-emerald-500"}),r.jsx("span",{className:"text-dark-300",children:"Output"})]})]})]})})]}),r.jsx(v0,{})]})}function Wo(e){return r.jsx(Wi,{children:r.jsx(C0,{...e})})}ke.registerLanguage("python",Go);ke.registerLanguage("bash",Ko);ke.registerLanguage("json",Uo);const j0={class:{bg:"bg-blue-500/20",text:"text-blue-400"},function:{bg:"bg-green-500/20",text:"text-green-400"},method:{bg:"bg-purple-500/20",text:"text-purple-400"},operator:{bg:"bg-orange-500/20",text:"text-orange-400"},module:{bg:"bg-cyan-500/20",text:"text-cyan-400"},parameter:{bg:"bg-yellow-500/20",text:"text-yellow-400"},concept:{bg:"bg-pink-500/20",text:"text-pink-400"}},_0=v.memo(function({term:t,isOpen:n,onClose:s,chapterColor:o="#f59e0b"}){const i=v.useRef(null),a=v.useRef(null),l=v.useCallback(c=>{if(c.key==="Escape"){s();return}if(c.key==="Tab"&&i.current){const f=i.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(f.length===0)return;const d=f[0],h=f[f.length-1];c.shiftKey&&document.activeElement===d?(c.preventDefault(),h.focus()):!c.shiftKey&&document.activeElement===h&&(c.preventDefault(),d.focus())}},[s]);if(v.useEffect(()=>(n&&(a.current=document.activeElement,document.addEventListener("keydown",l),setTimeout(()=>{i.current?.querySelector("button")?.focus()},100)),()=>{document.removeEventListener("keydown",l),!n&&a.current&&a.current.focus()}),[n,l]),!t)return null;const u=j0[t.type];return r.jsx(Ce,{children:n&&r.jsxs(r.Fragment,{children:[r.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",onClick:s}),r.jsxs(Y.div,{ref:i,role:"dialog","aria-modal":"true","aria-label":`Documentation for ${t.name}`,initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-2xl max-h-[85vh] overflow-hidden bg-dark-900 border border-dark-700 rounded-2xl shadow-2xl z-50",children:[r.jsx("div",{className:"sticky top-0 p-4 border-b border-dark-700 bg-dark-900/95 backdrop-blur-sm",style:{borderTopColor:o,borderTopWidth:3},children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"flex items-center gap-2 mb-2",children:r.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${u.bg} ${u.text}`,children:t.type})}),r.jsx("h2",{className:"text-xl font-bold text-dark-50 font-mono truncate",children:t.name}),r.jsx("p",{className:"text-sm text-dark-400 mt-1",children:t.shortDescription})]}),r.jsx("button",{onClick:s,"aria-label":"Close documentation",className:"p-2 rounded-lg text-dark-400 hover:text-dark-50 hover:bg-dark-800 transition-colors flex-shrink-0",children:r.jsx(rr,{className:"w-5 h-5"})})]})}),r.jsxs("div",{className:"p-4 overflow-y-auto max-h-[calc(85vh-80px)] space-y-5",children:[r.jsx("div",{children:r.jsx("p",{className:"text-dark-200 leading-relaxed",children:t.fullDescription})}),t.syntax&&r.jsxs("div",{className:"glass glass-code rounded-xl overflow-hidden",children:[r.jsxs("div",{className:"px-3 py-2 border-b border-dark-700 flex items-center gap-2",children:[r.jsx(Re,{className:"w-4 h-4 text-dark-400"}),r.jsx("span",{className:"text-xs font-medium text-dark-400 uppercase tracking-wide",children:"Syntax"})]}),r.jsx(ke,{language:"python",style:pt,customStyle:{margin:0,padding:"1rem",background:"transparent",fontSize:"0.875rem"},children:t.syntax})]}),t.parameters&&t.parameters.length>0&&r.jsxs("div",{children:[r.jsxs("h3",{className:"text-sm font-semibold text-dark-50 mb-3 flex items-center gap-2",children:[r.jsx(De,{className:"w-4 h-4",style:{color:o}}),"Parameters"]}),r.jsx("div",{className:"space-y-2",children:t.parameters.map(c=>r.jsxs("div",{className:"glass rounded-lg p-3",children:[r.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[r.jsx("code",{className:"text-sm font-mono font-semibold",style:{color:o},children:c.name}),r.jsx("span",{className:"text-xs text-dark-500 font-mono",children:c.type}),c.default&&r.jsxs("span",{className:"text-xs text-dark-500",children:["= ",c.default]})]}),r.jsx("p",{className:"text-sm text-dark-300",children:c.description})]},c.name))})]}),t.returns&&r.jsxs("div",{children:[r.jsxs("h3",{className:"text-sm font-semibold text-dark-50 mb-2 flex items-center gap-2",children:[r.jsx(De,{className:"w-4 h-4",style:{color:o}}),"Returns"]}),r.jsxs("div",{className:"glass rounded-lg p-3",children:[r.jsx("code",{className:"text-sm font-mono",style:{color:o},children:t.returns.type}),r.jsx("p",{className:"text-sm text-dark-300 mt-1",children:t.returns.description})]})]}),t.example&&r.jsxs("div",{children:[r.jsxs("h3",{className:"text-sm font-semibold text-dark-50 mb-2 flex items-center gap-2",children:[r.jsx(mn,{className:"w-4 h-4",style:{color:o}}),"Example"]}),r.jsx("div",{className:"glass glass-code rounded-xl overflow-hidden",children:r.jsx(ke,{language:"python",style:pt,customStyle:{margin:0,padding:"1rem",background:"transparent",fontSize:"0.875rem"},showLineNumbers:!0,children:t.example})})]}),t.tips&&t.tips.length>0&&r.jsxs("div",{className:"glass rounded-xl p-4 border-l-4",style:{borderLeftColor:o},children:[r.jsxs("h3",{className:"text-sm font-semibold text-dark-50 mb-3 flex items-center gap-2",children:[r.jsx(hn,{className:"w-4 h-4",style:{color:o}}),"Pro Tips"]}),r.jsx("ul",{className:"space-y-2",children:t.tips.map((c,f)=>r.jsxs("li",{className:"flex items-start gap-2 text-sm text-dark-300",children:[r.jsx("span",{style:{color:o},children:"•"}),c]},f))})]}),t.docUrl&&r.jsxs("a",{href:t.docUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-3 rounded-xl text-sm font-medium transition-colors hover:bg-dark-700",style:{backgroundColor:`${o}15`,color:o},children:[r.jsx(El,{className:"w-4 h-4"}),"View Official Documentation",r.jsx(De,{className:"w-4 h-4 ml-auto"})]})]})]})]})})}),S0=[{pattern:/\blangchain_openai\b/g,termId:"langchain_openai"},{pattern:/\blangchain_core\.prompts\b/g,termId:"langchain_core.prompts"},{pattern:/\blangchain_core\.output_parsers\b/g,termId:"langchain_core.output_parsers"},{pattern:/\blangchain_core\.runnables\b/g,termId:"langchain_core.runnables"},{pattern:/\blangchain_google_genai\b/g,termId:"langchain_google_genai"},{pattern:/\bgoogle\.adk\.agents\b/g,termId:"google.adk.agents"},{pattern:/\bgoogle\.adk\.tools\.mcp_tool\b/g,termId:"MCPToolset"},{pattern:/\bgoogle\.adk\.callbacks\b/g,termId:"CallbackContext"},{pattern:/\bgoogle\.adk\.models\.llm\b/g,termId:"LlmRequest"},{pattern:/\bgoogle\.adk\.tools\.base_tool\b/g,termId:"BaseTool"},{pattern:/\bgoogle\.adk\.tools\.tool_context\b/g,termId:"tool-context"},{pattern:/\bgoogle\.adk\.code_executors\b/g,termId:"code-executor"},{pattern:/\bgoogle\.generativeai\b/g,termId:"generative-ai"},{pattern:/\bimport asyncio\b/g,termId:"asyncio"},{pattern:/\bChatOpenAI\b/g,termId:"ChatOpenAI"},{pattern:/\bChatGoogleGenerativeAI\b/g,termId:"ChatGoogleGenerativeAI"},{pattern:/\bChatPromptTemplate\b/g,termId:"ChatPromptTemplate"},{pattern:/\bStrOutputParser\b/g,termId:"StrOutputParser"},{pattern:/\bRunnablePassthrough\b/g,termId:"RunnablePassthrough"},{pattern:/\bRunnableParallel\b/g,termId:"RunnableParallel"},{pattern:/\bRunnableBranch\b/g,termId:"RunnableBranch"},{pattern:/\bPromptTemplate\b/g,termId:"PromptTemplate"},{pattern:/\bLLMChain\b/g,termId:"LLMChain"},{pattern:/\bSequentialChain\b/g,termId:"SequentialChain"},{pattern:/\bAgentExecutor\b/g,termId:"AgentExecutor"},{pattern:/\bConversationBufferMemory\b/g,termId:"ConversationBufferMemory"},{pattern:/\bRecursiveCharacterTextSplitter\b/g,termId:"RecursiveCharacterTextSplitter"},{pattern:/\bSequentialAgent\b/g,termId:"SequentialAgent"},{pattern:/\bParallelAgent\b/g,termId:"ParallelAgent"},{pattern:/\bLlmAgent\b/g,termId:"LlmAgent"},{pattern:/\bCallbackContext\b/g,termId:"CallbackContext"},{pattern:/\bLlmRequest\b/g,termId:"LlmRequest"},{pattern:/\bMCPToolset\b/g,termId:"MCPToolset"},{pattern:/\bToolContext\b/g,termId:"tool-context"},{pattern:/\bBuiltInCodeExecutor\b/g,termId:"code-executor"},{pattern:/\bBaseAgent\b/g,termId:"base-agent"},{pattern:/\bAgentTool\b/g,termId:"agent-tool"},{pattern:/\bBaseModel\b/g,termId:"pydantic-model"},{pattern:/\bField\(/g,termId:"Field"},{pattern:/\bCrew\(/g,termId:"Crew"},{pattern:/\bProcess\./g,termId:"Process"},{pattern:/\bcreate_tool_calling_agent\b/g,termId:"create_tool_calling_agent"},{pattern:/\bFastMCP\b/g,termId:"FastMCP"},{pattern:/\bAgentCard\b/g,termId:"AgentCard"},{pattern:/\bAgentSkill\b/g,termId:"AgentSkill"},{pattern:/\bStateGraph\b/g,termId:"state-graph"},{pattern:/\bInMemoryStore\b/g,termId:"InMemoryStore"},{pattern:/\.from_template\b/g,termId:"from_template"},{pattern:/\.from_messages\b/g,termId:"from_messages"},{pattern:/\.invoke\b/g,termId:"invoke"},{pattern:/\.ainvoke\b/g,termId:"ainvoke"},{pattern:/\.add_conditional_edges\b/g,termId:"conditional-edges"},{pattern:/^@tool\b/gm,termId:"tool_decorator"},{pattern:/\btemperature\s*=/g,termId:"temperature"},{pattern:/\bbefore_tool_callback\s*=/g,termId:"before-tool-callback"},{pattern:/\bsub_agents\s*=/g,termId:"sub_agents"},{pattern:/\binstruction\s*=/g,termId:"instruction"}];function E0(e,t){const n=e.split(`
`),s=[];return n.forEach((o,i)=>{const a=[];let l=o,u=0;for(;l.length>0;){let c=!1;const f=l.match(/^#.*/);if(f){a.push({type:"comment",content:f[0],lineNumber:i+1});break}const d=l.match(/^(["'])((?:\\.|(?!\1)[^\\])*)\1/)||l.match(/^("""|''')([\s\S]*?)\1/);if(d){a.push({type:"string",content:d[0],lineNumber:i+1}),l=l.slice(d[0].length),u+=d[0].length,c=!0;continue}for(const{pattern:p,termId:g}of S0){if(t&&!t.includes(g))continue;p.lastIndex=0;const b=p.exec(l);if(b&&b.index===0){a.push({type:"term",content:b[0],termId:g,lineNumber:i+1}),l=l.slice(b[0].length),u+=b[0].length,c=!0;break}}if(c)continue;if(l.startsWith("|")){a.push({type:"operator",content:"|",termId:"pipe_operator",lineNumber:i+1}),l=l.slice(1),u+=1;continue}const h=l.match(/^(from|import|def|class|return|if|else|for|in|and|or|not|True|False|None|async|await)\b/);if(h){a.push({type:"keyword",content:h[0],lineNumber:i+1}),l=l.slice(h[0].length),u+=h[0].length;continue}a.push({type:"text",content:l[0],lineNumber:i+1}),l=l.slice(1),u+=1}s.push(a)}),s}const M0=v.memo(function({code:t,language:n="python",chapterColor:s="#f59e0b",highlightTerms:o,highlightLines:i}){const[a,l]=v.useState(null),[u,c]=v.useState(!1),[f,d]=v.useState(null),[h,p]=v.useState(!1),g=v.useMemo(()=>E0(t,o),[t,o]),b=v.useMemo(()=>g.some(m=>m.some(y=>y.type==="term"||y.type==="operator")),[g]),w=v.useCallback(m=>{const y=Zl[m];y&&(l(y),c(!0))},[]),x=v.useCallback(async()=>{try{await navigator.clipboard.writeText(t)}catch{const m=document.createElement("textarea");m.value=t,m.style.position="fixed",m.style.opacity="0",document.body.appendChild(m),m.select(),document.execCommand("copy"),document.body.removeChild(m)}p(!0),setTimeout(()=>p(!1),2e3)},[t]),N=(m,y)=>{switch(m.type){case"term":case"operator":const S=f===m.termId;return r.jsxs("span",{role:"button",tabIndex:0,"aria-label":`Learn about ${m.content.replace(/[.()=]/g,"")}`,className:"relative cursor-pointer transition-all duration-150 rounded px-0.5 -mx-0.5",style:{backgroundColor:S?`${s}30`:"transparent",borderBottom:`2px dashed ${s}`},onClick:()=>m.termId&&w(m.termId),onKeyDown:k=>{(k.key==="Enter"||k.key===" ")&&m.termId&&(k.preventDefault(),w(m.termId))},onMouseEnter:()=>d(m.termId||null),onMouseLeave:()=>d(null),onFocus:()=>d(m.termId||null),onBlur:()=>d(null),children:[m.content,S&&r.jsxs(Y.span,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"absolute -top-8 left-1/2 -translate-x-1/2 px-2 py-1 rounded text-xs whitespace-nowrap z-10",style:{backgroundColor:s,color:"#000"},children:[r.jsx(bt,{className:"w-3 h-3 inline mr-1"}),"Click to learn more"]})]},y);case"comment":return r.jsx("span",{className:"text-dark-400 italic",children:m.content},y);case"string":return r.jsx("span",{className:"text-green-400",children:m.content},y);case"keyword":return r.jsx("span",{className:"text-purple-400 font-semibold",children:m.content},y);default:return r.jsx("span",{children:m.content},y)}};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"glass glass-code rounded-xl overflow-hidden",children:[r.jsxs("div",{className:"px-4 py-3 border-b border-dark-700/60 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"px-2.5 py-1 rounded-md text-xs font-semibold uppercase tracking-wider",style:{backgroundColor:`${s}15`,color:s,border:`1px solid ${s}25`},children:n}),b&&r.jsxs("span",{className:"text-xs text-dark-500 flex items-center gap-1",children:[r.jsx(bt,{className:"w-3 h-3"}),"Click highlighted terms for explanations"]})]}),r.jsx("button",{onClick:x,className:"relative flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-all duration-200 hover:bg-dark-700/80",style:{color:h?"#4ade80":"#8c9bb5"},"aria-label":h?"Copied to clipboard":"Copy code",children:r.jsx(Ce,{mode:"wait",children:h?r.jsxs(Y.span,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:500,damping:25},className:"flex items-center gap-1.5",children:[r.jsx(er,{className:"w-3.5 h-3.5"}),"Copied!"]},"check"):r.jsxs(Y.span,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:500,damping:25},className:"flex items-center gap-1.5",children:[r.jsx(tr,{className:"w-3.5 h-3.5"}),"Copy"]},"copy")})})]}),r.jsx("div",{className:"p-4 overflow-x-auto",children:r.jsx("pre",{className:"font-mono text-sm leading-relaxed",children:r.jsx("code",{children:g.map((m,y)=>{const S=y+1,k=i&&S>=i[0]&&S<=i[1];return r.jsxs("div",{className:"flex transition-colors duration-300",style:{backgroundColor:k?`${s}12`:"transparent",borderLeft:k?`3px solid ${s}`:"3px solid transparent",paddingLeft:"0.25rem"},children:[r.jsx("span",{className:"select-none w-10 text-right pr-4 flex-shrink-0 text-dark-400",style:{fontSize:"0.8rem",lineHeight:"inherit"},children:S}),r.jsx("span",{className:"text-dark-200",children:m.length===0?`
`:m.map(N)})]},y)})})})})]}),r.jsx(_0,{term:a,isOpen:u,onClose:()=>c(!1),chapterColor:s})]})}),I0={narrative:{icon:mn,bgClass:"bg-transparent",borderClass:""},code:{icon:or,bgClass:"",borderClass:""},tip:{icon:hn,bgClass:"bg-emerald-500/10",borderClass:"border border-emerald-500/30",iconColor:"#10b981",label:"Pro Tip"},warning:{icon:ir,bgClass:"bg-amber-500/10",borderClass:"border border-amber-500/30",iconColor:"#f59e0b",label:"Watch Out"},exercise:{icon:Il,bgClass:"bg-purple-500/10",borderClass:"border border-purple-500/30",iconColor:"#a855f7",label:"Try It Yourself"},checkpoint:{icon:Ml,bgClass:"bg-blue-500/10",borderClass:"border border-blue-500/30",iconColor:"#3b82f6",label:"Checkpoint"}},$0={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:[0,0,.2,1]}}},T0={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}};function A0({sections:e,chapterColor:t}){return r.jsx("div",{className:"space-y-12",children:e.map((n,s)=>r.jsxs(Y.div,{variants:T0,initial:"hidden",animate:"visible",transition:{delay:s*.1},className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[r.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold",style:{backgroundColor:`${t}20`,color:t},children:s+1}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-dark-50",children:n.title}),n.description&&r.jsx("p",{className:"text-sm text-dark-400",children:n.description})]})]}),r.jsx("div",{className:"space-y-4 pl-4 border-l-2 border-dark-700 ml-4",children:n.steps.map((o,i)=>{const a=I0[o.type],l=a.icon;return r.jsxs(Y.div,{variants:$0,className:`relative ${a.bgClass} ${a.borderClass} ${o.type!=="narrative"&&o.type!=="code"?"rounded-xl p-4":""}`,children:[r.jsx("div",{className:"absolute -left-[calc(1rem+5px)] top-2 w-2.5 h-2.5 rounded-full",style:{backgroundColor:o.type==="code"?t:a.iconColor||t}}),o.type==="code"?r.jsx(M0,{code:o.content,language:o.language||"python",chapterColor:t,highlightTerms:o.highlightTerms}):o.type==="narrative"?r.jsx("div",{className:"text-dark-200 leading-relaxed space-y-3",children:o.content.split(`

`).map((u,c)=>r.jsx("p",{dangerouslySetInnerHTML:{__html:u.replace(/\*\*(.*?)\*\*/g,'<strong class="text-dark-50 font-semibold">$1</strong>').replace(/`([^`]+)`/g,`<code class="px-1.5 py-0.5 rounded bg-dark-700 text-sm font-mono" style="color: ${t}">$1</code>`)}},c))}):r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(l,{className:"w-4 h-4",style:{color:a.iconColor}}),r.jsx("span",{className:"text-xs font-medium uppercase tracking-wide",style:{color:a.iconColor},children:a.label})]}),r.jsx("div",{className:"text-sm leading-relaxed",children:o.content.split(`

`).map((u,c)=>r.jsx("p",{className:c>0?"mt-2":"",style:{color:o.type==="tip"?"#a7f3d0":o.type==="warning"?"#fde68a":"#e9d5ff"},dangerouslySetInnerHTML:{__html:u.replace(/\*\*(.*?)\*\*/g,'<strong class="font-semibold">$1</strong>').replace(/`([^`]+)`/g,'<code class="px-1 py-0.5 rounded bg-black/20 text-xs font-mono">$1</code>')}},c))})]})]},`${n.id}-${i}`)})})]},n.id))})}function P0({chapterColor:e,estimatedMinutes:t}){const[n,s]=v.useState(0),o=v.useRef(null),i=Rl(0,{stiffness:100,damping:30});v.useEffect(()=>{i.set(n)},[n,i]),v.useEffect(()=>{const l=()=>{const c=window.scrollY,f=document.documentElement.scrollHeight-window.innerHeight,d=Math.min(Math.max(c/f,0),1);s(d)},u=()=>{o.current&&cancelAnimationFrame(o.current),o.current=requestAnimationFrame(l)};return l(),window.addEventListener("scroll",u,{passive:!0}),window.addEventListener("resize",l),()=>{window.removeEventListener("scroll",u),window.removeEventListener("resize",l),o.current&&cancelAnimationFrame(o.current)}},[]);const a=t?Math.max(1,Math.ceil(t*(1-n))):null;return r.jsxs("div",{className:"fixed top-16 left-0 right-0 z-40 h-1.5 bg-dark-800/80 backdrop-blur-sm",children:[r.jsx(Y.div,{className:"h-full origin-left",style:{backgroundColor:e,scaleX:i,boxShadow:`0 0 10px ${e}60`}}),t&&n>.05&&n<.95&&r.jsxs(Y.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-4 top-3 flex items-center gap-1.5 px-2 py-1 rounded-md bg-dark-800/90 backdrop-blur-sm text-xs text-dark-300",children:[r.jsx(fn,{className:"w-3 h-3"}),r.jsxs("span",{children:["~",a," min left"]})]}),n>=.95&&r.jsx(Y.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute right-4 top-3 flex items-center gap-1.5 px-2 py-1 rounded-md text-xs font-medium",style:{backgroundColor:`${e}20`,color:e},children:"Complete!"})]})}const Qo=["#f59e0b","#10b981","#3b82f6","#ec4899","#8b5cf6","#f97316","#14b8a6"],D0=v.memo(function({isVisible:t,chapterTitle:n,chapterColor:s,onComplete:o}){const[i,a]=v.useState([]),[l,u]=v.useState(!1);v.useEffect(()=>{if(t){const f=[];for(let p=0;p<50;p++)f.push({id:p,x:Math.random()*100,color:Qo[Math.floor(Math.random()*Qo.length)],delay:Math.random()*.5,rotation:Math.random()*360,size:8+Math.random()*8});a(f);const d=setTimeout(()=>u(!0),300),h=setTimeout(()=>{o?.()},4e3);return()=>{clearTimeout(d),clearTimeout(h)}}else a([]),u(!1)},[t,o]);const c=v.useCallback(()=>{o?.()},[o]);return r.jsx(Ce,{children:t&&r.jsxs(Y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 z-50 flex items-center justify-center",onClick:c,children:[r.jsx("div",{className:"absolute inset-0 bg-dark-950/80 backdrop-blur-sm"}),r.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:i.map(f=>r.jsx(Y.div,{initial:{y:-20,x:`${f.x}vw`,rotate:0,opacity:1},animate:{y:"110vh",rotate:f.rotation+720,opacity:[1,1,0]},transition:{duration:3+Math.random()*2,delay:f.delay,ease:"easeIn"},className:"absolute",style:{width:f.size,height:f.size,backgroundColor:f.color,borderRadius:Math.random()>.5?"50%":"2px"}},f.id))}),r.jsx(Ce,{children:l&&r.jsxs(Y.div,{initial:{scale:.5,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.5,opacity:0,y:-20},transition:{type:"spring",damping:15,stiffness:300},className:"relative glass rounded-3xl p-8 max-w-md mx-4 text-center",onClick:f=>f.stopPropagation(),children:[r.jsx(Y.div,{animate:{scale:[1,1.1,1],rotate:[0,-5,5,0]},transition:{duration:.6,repeat:1/0,repeatDelay:1},className:"w-20 h-20 mx-auto mb-6 rounded-2xl flex items-center justify-center",style:{backgroundColor:`${s}20`},children:r.jsx(as,{className:"w-10 h-10",style:{color:s}})}),r.jsx("div",{className:"absolute top-4 left-4",children:r.jsx(wt,{className:"w-6 h-6 text-amber-400 animate-sparkle"})}),r.jsx("div",{className:"absolute top-4 right-4",children:r.jsx($l,{className:"w-5 h-5 text-amber-400 animate-sparkle",style:{animationDelay:"0.2s"}})}),r.jsx("div",{className:"absolute bottom-4 left-8",children:r.jsx(Tl,{className:"w-5 h-5 text-pink-400 animate-sparkle",style:{animationDelay:"0.4s"}})}),r.jsx("h2",{className:"text-2xl font-bold text-dark-50 mb-2",children:"Chapter Complete!"}),r.jsxs("p",{className:"text-dark-300 mb-4",children:["You've mastered ",r.jsx("span",{className:"font-semibold",style:{color:s},children:n})]}),r.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-dark-400",children:[r.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:s}}),r.jsx("span",{children:"Great progress! Keep learning."})]}),r.jsx(Y.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:c,className:"mt-6 px-6 py-2 rounded-lg font-medium text-dark-50 transition-colors",style:{backgroundColor:s},children:"Continue"})]})})]})})});class Ye extends v.Component{log;constructor(t){super(t),this.state={error:null,resetKey:0},this.log=lr(t.context?`ErrorBoundary:${t.context}`:"ErrorBoundary")}static getDerivedStateFromError(t){return{error:t}}componentDidCatch(t,n){this.log.error("Component crashed:",t.message,n.componentStack)}handleReset=()=>{this.setState(t=>({error:null,resetKey:t.resetKey+1}))};render(){const{error:t}=this.state,{children:n,fallback:s,context:o}=this.props;return t?s?s(t,this.handleReset):r.jsxs("div",{role:"alert",className:"rounded-xl border border-red-500/20 bg-red-500/5 p-6 text-center",children:[r.jsx(ir,{className:"mx-auto mb-3 h-8 w-8 text-red-400"}),r.jsx("h3",{className:"mb-1 text-lg font-semibold text-dark-50",children:o?`${o} failed to load`:"Something went wrong"}),r.jsx("p",{className:"mb-4 text-sm text-dark-400",children:t.message||"An unexpected error occurred."}),r.jsxs("button",{type:"button",onClick:this.handleReset,className:"inline-flex items-center gap-2 rounded-lg bg-red-500/10 px-4 py-2 text-sm font-medium text-red-400 transition-colors hover:bg-red-500/20 focus:outline-none focus:ring-2 focus:ring-red-500/40",children:[r.jsx(Al,{className:"h-4 w-4"}),"Try again"]})]}):n}}function ft({number:e,title:t,isActive:n}){return r.jsxs("div",{className:`flex items-center gap-3 mb-2 ${n?"text-dark-50":"text-dark-400"}`,children:[r.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center text-sm font-bold ${n?"bg-primary-500 text-dark-50":"bg-dark-700"}`,children:e}),r.jsx("span",{className:"text-sm font-medium uppercase tracking-wide",children:t})]})}function z0(){const{t:e}=rl(),{isRTL:t}=Ol(),{id:n}=il(),s=al(),o=parseInt(n||"1",10),{isChapterCompleted:i,markChapterComplete:a,toggleChapterComplete:l,setLastVisited:u}=cr(),{setScrollToCodeCallback:c,highlightedCodeLines:f}=cs(),d=Xl[o],h=i(o),[p,g]=v.useState(!1),{count:b}=Bl(o);Vl(o);const w=d?An(`/chapters/${d.number}`):void 0,x=v.useMemo(()=>d?{"@context":"https://schema.org","@type":"LearningResource",name:`Chapter ${d.number}: ${d.title}`,description:d.description,url:An(`/chapters/${d.number}`),educationalLevel:d.readingMeta?.difficulty||"intermediate",teaches:d.keyConcepts?.slice(0,5).join(", "),isPartOf:{"@type":"Course",name:"Agentic Design Patterns",description:"Master 21 essential patterns for building intelligent AI systems",url:An("/"),provider:{"@type":"Person",name:"Antonio Gulli"}},timeRequired:d.readingMeta?`PT${d.readingMeta.estimatedMinutes}M`:void 0}:void 0,[d]);Fl({title:d?`Chapter ${d.number}: ${d.title}`:"Chapter Not Found",description:d?.description,ogTitle:d?`${d.title} - Agentic Design Patterns`:void 0,ogDescription:d?.description,ogType:"article",ogUrl:w,canonicalUrl:w,keywords:d?`${d.title}, ${d.keyConcepts?.slice(0,3).join(", ")}, AI agents, design patterns`:void 0,structuredData:x});const N=v.useRef([]);v.useEffect(()=>{c(k=>{const j=N.current[k];j&&(j.scrollIntoView({behavior:"smooth",block:"center"}),j.classList.add("animate-highlight"),setTimeout(()=>j.classList.remove("animate-highlight"),1e3))})},[c]),v.useEffect(()=>{d&&u(o)},[o,d,u]),v.useEffect(()=>{if(!s.hash||!d)return;const k=s.hash.slice(1);let j=!1,E=0;const A=30,H=()=>{if(j)return;const D=document.getElementById(k);if(D){D.scrollIntoView({behavior:"smooth",block:"start"});return}E++,E<A&&requestAnimationFrame(H)},T=setTimeout(H,150);return()=>{j=!0,clearTimeout(T)}},[o,s.hash]);const m=v.useCallback(()=>{a(o),g(!0)},[a,o]),y=v.useCallback(()=>{g(!1)},[]);if(!d)return r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-2xl font-bold text-dark-50 mb-4",children:e("chapter.chapterNotFound")}),r.jsx(qe,{to:"/chapters",className:"text-primary-400 hover:text-primary-300",children:e("chapter.backToChapters")})]})});const S=ql(d.icon);return r.jsxs("div",{className:"min-h-screen",children:[r.jsx(P0,{chapterColor:d.color,estimatedMinutes:d.readingMeta?.estimatedMinutes}),r.jsxs("section",{className:"relative py-12 overflow-hidden border-b border-dark-800",children:[r.jsx("div",{className:"absolute inset-0 pattern-dots"}),r.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 rounded-full blur-3xl opacity-20",style:{backgroundColor:d.color}}),r.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsxs(Y.nav,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center gap-2 text-sm mb-6","aria-label":"Breadcrumb",children:[r.jsx(qe,{to:"/",className:"text-dark-500 hover:text-dark-300 transition-colors",children:e("nav.home")}),r.jsx("span",{className:"text-dark-600",children:"/"}),r.jsx(qe,{to:"/chapters",className:"text-dark-400 hover:text-dark-200 transition-colors",children:e("nav.chapters")}),r.jsx("span",{className:"text-dark-600",children:"/"}),r.jsxs("span",{className:"font-medium",style:{color:d.color},children:[e("chaptersPage.ch")," ",d.number]})]}),r.jsxs(Y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},className:"max-w-4xl",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[r.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center",style:{backgroundColor:`${d.color}20`},children:r.jsx(S,{className:"w-7 h-7",style:{color:d.color}})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[r.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-medium",style:{backgroundColor:`${d.color}15`,color:d.color},children:[e("chaptersPage.ch")," ",d.number]}),d.readingMeta&&r.jsxs("span",{className:"flex items-center gap-1 text-xs text-dark-400",children:[r.jsx(fn,{className:"w-3 h-3"}),d.readingMeta.estimatedMinutes," ",e("chapter.min")]}),h&&r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-400 text-xs font-medium",children:[r.jsx(en,{className:"w-3 h-3"}),e("chapter.done")]}),b>0&&r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-primary-500/10 text-primary-400 text-xs font-medium",children:[r.jsx(Pl,{className:"w-3 h-3"}),b," ",e("chapter.learnersHere",{defaultValue:b===1?"learner here":"learners here"})]})]}),r.jsx("p",{className:"text-sm text-dark-400",children:d.partName})]})]}),r.jsx("h1",{className:"text-4xl font-bold text-dark-50 mb-4",children:d.title}),r.jsx("p",{className:"text-lg text-dark-300 mb-6",children:d.description})]}),d.narrativeIntro&&r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"max-w-4xl glass rounded-xl p-6 border-l-4",style:{borderLeftColor:d.color},children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(wt,{className:"w-4 h-4",style:{color:d.color}}),r.jsx("span",{className:"text-sm font-medium text-dark-400",children:e("chapter.theBigPicture")})]}),r.jsx("div",{className:"text-dark-200 space-y-3 leading-relaxed",children:d.narrativeIntro.split(`

`).map((k,j)=>r.jsx("p",{dangerouslySetInnerHTML:{__html:k.replace(/\*\*(.*?)\*\*/g,'<strong class="text-dark-50">$1</strong>')}},j))})]})]})]}),r.jsx("section",{className:"py-12",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsxs("div",{className:"lg:grid lg:grid-cols-12 lg:gap-8",children:[r.jsxs("div",{className:"lg:col-span-7 space-y-12",children:[r.jsxs(Y.div,{id:"concepts",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},children:[r.jsx(ft,{number:1,title:e("chapter.sections.keyConcepts"),isActive:!0}),r.jsxs("div",{className:"glass rounded-xl p-6",children:[r.jsxs("h2",{className:"flex items-center gap-2 text-lg font-semibold text-dark-50 mb-4",children:[r.jsx(mn,{className:"w-5 h-5 text-primary-400"}),e("chapter.whatYoullLearn")]}),r.jsx("p",{className:"text-sm text-dark-400 mb-4",children:d.keyConceptsIntro}),r.jsx("ul",{className:"space-y-3",children:d.keyConcepts.map((k,j)=>r.jsxs(Y.li,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.3+j*.1},className:"flex items-start gap-3",children:[r.jsx(Xn,{className:"w-5 h-5 mt-0.5 flex-shrink-0",style:{color:d.color}}),r.jsx("span",{className:"text-dark-200",children:k})]},j))})]})]}),d.tutorial&&d.tutorial.length>0?r.jsxs(r.Fragment,{children:[r.jsxs("div",{id:"tutorial",children:[r.jsx(ft,{number:2,title:e("chapter.sections.tutorial")}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.4},className:"mb-6",children:[r.jsxs("h2",{className:"text-2xl font-bold text-dark-50 flex items-center gap-3 mb-2",children:[r.jsx(Re,{className:"w-6 h-6",style:{color:d.color}}),e("chapter.handsonTutorial")]}),r.jsx("p",{className:"text-dark-400",children:e("chapter.tutorialHint")})]}),r.jsx(Ye,{context:"Tutorial",children:r.jsx(A0,{sections:d.tutorial,chapterColor:d.color})})]}),d.codeExamples.length>0&&r.jsxs("div",{id:"code",className:"mt-12",children:[r.jsx(ft,{number:3,title:e("chapter.sections.completeCode")}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.5},className:"mb-6",children:[r.jsxs("h2",{className:"text-2xl font-bold text-dark-50 flex items-center gap-3 mb-2",children:[r.jsx(Jo,{className:"w-6 h-6",style:{color:d.color}}),e("chapter.codeExamplesTitle")]}),r.jsx("p",{className:"text-dark-400",children:e("chapter.codeExamplesHint")})]}),r.jsx("div",{className:"space-y-6",children:d.codeExamples.map((k,j)=>r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.6+j*.1},children:r.jsx(Ye,{context:"CodeBlock",children:r.jsx(Ls,{code:k.code,language:k.language,title:k.title,chapterColor:d.color,highlightedLines:f,explanation:k.explanation,refCallback:E=>{N.current[j]=E}})})},j))})]})]}):d.codeExamples.length>0&&r.jsxs("div",{id:"code",children:[r.jsx(ft,{number:2,title:e("chapter.sections.implementation")}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.4},className:"mb-6",children:[r.jsxs("h2",{className:"text-2xl font-bold text-dark-50 flex items-center gap-3 mb-2",children:[r.jsx(Re,{className:"w-6 h-6",style:{color:d.color}}),e("chapter.codeExamplesTitle")]}),r.jsx("p",{className:"text-dark-400",children:e("chapter.codeExamplesDesc")})]}),r.jsx("div",{className:"space-y-6",children:d.codeExamples.map((k,j)=>r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.5+j*.1},children:r.jsx(Ye,{context:"CodeBlock",children:r.jsx(Ls,{code:k.code,language:k.language,title:k.title,chapterColor:d.color,highlightedLines:f,explanation:k.explanation,refCallback:E=>{N.current[j]=E}})})},j))})]})]}),r.jsx("div",{className:"hidden lg:block lg:col-span-5",children:r.jsx("div",{className:"sticky top-24",children:d.diagramNodes&&d.diagramNodes.length>0?r.jsx(Ye,{context:"Diagram",children:r.jsx(Wo,{diagramNodes:d.diagramNodes,diagramEdges:d.diagramEdges||[],chapterColor:d.color,title:e("chapter.patternFlow")})}):r.jsxs("div",{className:"glass rounded-2xl overflow-hidden",children:[r.jsx("div",{className:"p-4 border-b border-dark-700",children:r.jsxs("h3",{className:"font-semibold text-dark-50 flex items-center gap-2",children:[r.jsx(Tn,{className:"w-4 h-4 text-primary-400"}),e("chapter.patternFlow")]})}),r.jsx("div",{className:"h-[400px] flex items-center justify-center text-dark-400",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Tn,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:e("chapter.diagramComingSoon")})]})})]})})})]}),r.jsx("div",{className:"lg:hidden mt-8 no-print",children:d.diagramNodes&&d.diagramNodes.length>0&&r.jsx(Ye,{context:"Diagram",children:r.jsx(Wo,{diagramNodes:d.diagramNodes,diagramEdges:d.diagramEdges||[],chapterColor:d.color,title:e("chapter.patternFlow")})})})]})}),d.quiz&&r.jsx("section",{id:"quiz",className:"py-16 border-t border-dark-800 bg-dark-900/50",children:r.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsx(ft,{number:d.tutorial&&d.codeExamples.length>0?4:3,title:e("chapter.sections.validateLearning")}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.7},className:"mb-8",children:[r.jsxs("h2",{className:"text-2xl font-bold text-dark-50 flex items-center gap-3 mb-4",children:[r.jsx(nr,{className:"w-6 h-6",style:{color:d.color}}),e("chapter.testYourKnowledge")]}),r.jsx("p",{className:"text-dark-400",children:e("chapter.quizDescription")})]}),d.learningObjectives&&d.learningObjectives.length>0&&r.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.8},className:"mb-8",children:r.jsx(Kl,{objectives:d.learningObjectives,chapterColor:d.color})}),r.jsx(Ye,{context:"Quiz",children:r.jsx(lc,{quiz:d.quiz,chapterColor:d.color,chapterId:Number(n),onPass:m})}),r.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.9},className:"mt-8 text-center",children:[r.jsx("button",{onClick:()=>l(o),className:`inline-flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-all ${h?"bg-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30 ring-1 ring-emerald-500/30":"bg-dark-700 text-dark-300 hover:bg-dark-600 hover:text-dark-50"}`,children:h?r.jsxs(r.Fragment,{children:[r.jsx(en,{className:"w-5 h-5"}),e("chapter.chapterCompleted")]}):r.jsxs(r.Fragment,{children:[r.jsx(Dl,{className:"w-5 h-5"}),e("chapter.markAsComplete")]})}),!h&&r.jsx("p",{className:"text-xs text-dark-500 mt-2",children:e("chapter.quizHint")})]})]})}),r.jsx("section",{className:"py-12 border-t border-dark-800 no-print",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[r.jsx("div",{className:`${t?"justify-self-end":"justify-self-start"}`,children:d.prevChapter&&r.jsxs(qe,{to:`/chapter/${d.prevChapter}`,className:"group flex items-center gap-3 px-5 py-3 rounded-xl bg-dark-800 border border-dark-700 hover:bg-dark-700 transition-colors",children:[t?r.jsx(De,{className:"w-5 h-5 text-dark-400 group-hover:text-dark-50 transition-colors"}):r.jsx(zs,{className:"w-5 h-5 text-dark-400 group-hover:text-dark-50 transition-colors"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-dark-300",children:e("chapter.previous")}),r.jsxs("div",{className:"text-dark-50 font-medium",children:[e("chaptersPage.ch")," ",d.prevChapter]})]})]})}),r.jsx("div",{className:"justify-self-center",children:r.jsxs(qe,{to:"/chapters",className:"px-5 py-3 rounded-xl bg-dark-800 border border-dark-700 hover:bg-dark-700 transition-colors text-dark-300 hover:text-dark-50 inline-flex items-center gap-2",children:[r.jsx(Tn,{className:"w-4 h-4"}),e("chapter.allChapters")]})}),r.jsx("div",{className:`${t?"justify-self-start":"justify-self-end"}`,children:d.nextChapter&&r.jsxs(qe,{to:`/chapter/${d.nextChapter}`,className:"group flex items-center gap-3 px-5 py-3 rounded-xl border transition-colors",style:{backgroundColor:`${d.color}15`,borderColor:`${d.color}30`},children:[r.jsxs("div",{className:`${t?"text-left":"text-right"}`,children:[r.jsx("div",{className:"text-xs text-dark-300",children:e("chapter.next")}),r.jsxs("div",{className:"text-dark-50 font-medium",children:[e("chaptersPage.ch")," ",d.nextChapter]})]}),t?r.jsx(zs,{className:"w-5 h-5 transition-colors",style:{color:d.color}}):r.jsx(De,{className:"w-5 h-5 transition-colors",style:{color:d.color}})]})})]})})}),r.jsx(D0,{isVisible:p,chapterTitle:d.title,chapterColor:d.color,onComplete:y})]})}function Z0(){return r.jsx(Ql,{children:r.jsx(z0,{})})}export{Z0 as default};
